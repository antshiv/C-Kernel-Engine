{
  "name": "rmsnorm",
  "dtypes": ["fp32", "bf16", "int8", "int4"],
  "default_dtype": "fp32",
  "impl": {
    "forward": "rmsnorm_forward",
    "backward": "rmsnorm_backward",
    "sources": ["src/kernels/rmsnorm_kernels.c", "src/kernels/rmsnorm_kernels_bf16.c", "src/kernels/rmsnorm_kernels_int8.c", "src/kernels/rmsnorm_kernels_int4.c"],
    "variants": {
      "bf16": {
        "forward": "rmsnorm_forward_bf16",
        "backward": "rmsnorm_backward_bf16"
      },
      "int8": {
        "forward": "rmsnorm_forward_int8",
        "backward": "rmsnorm_backward_int8"
      },
      "int4": {
        "forward": "rmsnorm_forward_int4",
        "backward": "rmsnorm_backward_int4"
      }
    }
  },
  "params": [
    {"id": "eps", "kind": "config", "field": "rms_norm_eps", "type": "float"}
  ],
  "buffers": [
    {"id": "input", "role": "input", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"id": "gamma", "role": "weight", "shape": [{"dim": "aligned_embed"}]},
    {"id": "out", "role": "output", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"id": "rstd", "role": "activation", "shape": [{"dim": "tokens"}], "optional": true}
  ],
  "buffers_backward": [
    {"id": "d_out", "role": "grad", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"id": "input", "role": "input", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"id": "gamma", "role": "weight", "shape": [{"dim": "aligned_embed"}]},
    {"id": "rstd", "role": "activation", "shape": [{"dim": "tokens"}], "optional": true},
    {"id": "d_input", "role": "grad", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"id": "d_gamma", "role": "grad", "shape": [{"dim": "aligned_embed"}]}
  ]
}
