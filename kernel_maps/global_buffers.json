{
  "buffers": [
    {"name": "token_emb", "scope": "global", "role": "weight", "shape": [{"dim": "vocab"}, {"dim": "aligned_embed"}]},
    {"name": "pos_emb", "scope": "global", "role": "weight", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"name": "embedded_input", "scope": "global", "role": "activation", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"name": "rope_cos_cache", "scope": "global", "role": "activation", "shape": [{"dim": "tokens"}, {"dim": "head_dim", "div": 2}], "condition": "rope_theta"},
    {"name": "rope_sin_cache", "scope": "global", "role": "activation", "shape": [{"dim": "tokens"}, {"dim": "head_dim", "div": 2}], "condition": "rope_theta"},
    {"name": "final_ln_weight", "scope": "global", "role": "weight", "shape": [{"dim": "aligned_embed"}]},
    {"name": "final_ln_bias", "scope": "global", "role": "weight", "shape": [{"dim": "aligned_embed"}]},
    {"name": "final_ln_mean", "scope": "global", "role": "activation", "shape": [{"dim": "tokens"}]},
    {"name": "final_ln_rstd", "scope": "global", "role": "activation", "shape": [{"dim": "tokens"}]},
    {"name": "final_output", "scope": "global", "role": "activation", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"name": "lm_head_weight", "scope": "global", "role": "weight", "shape": [{"dim": "vocab"}, {"dim": "aligned_embed"}], "alias_of": "token_emb"},
    {"name": "logits", "scope": "global", "role": "activation", "shape": [{"dim": "tokens"}, {"dim": "vocab"}]},
    {"name": "d_token_emb", "scope": "global", "role": "grad", "shape": [{"dim": "vocab"}, {"dim": "aligned_embed"}]},
    {"name": "d_pos_emb", "scope": "global", "role": "grad", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"name": "d_final_output", "scope": "global", "role": "grad", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"name": "d_final_input", "scope": "global", "role": "grad", "shape": [{"dim": "tokens"}, {"dim": "aligned_embed"}]},
    {"name": "d_final_ln_weight", "scope": "global", "role": "grad", "shape": [{"dim": "aligned_embed"}]},
    {"name": "d_logits", "scope": "global", "role": "grad", "shape": [{"dim": "tokens"}, {"dim": "vocab"}]}
  ]
}
