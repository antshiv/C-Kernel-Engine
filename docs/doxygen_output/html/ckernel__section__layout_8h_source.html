<!-- Doxygen custom header with link back to main docs -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ckernel_section_layout.h Source File</title>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<style>
/* Back to docs banner */
.docs-banner {
    background: linear-gradient(135deg, #2a2a2a 0%, #363636 50%, #2a2a2a 100%);
    border-bottom: 3px solid #ffb400;
    padding: 0.5rem 1rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}
.docs-banner a {
    color: #ffb400;
    text-decoration: none;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}
.docs-banner a:hover {
    color: #ffc933;
}
.docs-banner .logo {
    background: #ffb400;
    color: #1d1d1d;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-weight: 700;
    font-family: monospace;
}
.docs-banner .subtitle {
    color: #707070;
    font-size: 0.85rem;
}
</style>
</head>
<body>
<div class="docs-banner">
    <a href="../index.html">
        <span class="logo">CK</span>
        <span>← Back to C-Kernel-Engine Docs</span>
    </a>
    <span class="subtitle">Doxygen Source Documentation</span>
</div>
<div id="top">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ckernel__section__layout_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ckernel_section_layout.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ckernel__section__layout_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @file ckernel_section_layout.h</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * @brief Section-Based Memory Layout: Header / Body / Footer Pattern</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * =============================================================================</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * PHILOSOPHY: WHY NO MEMORY REUSE?</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * =============================================================================</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * 1. CPU PREFETCH NEEDS PREDICTABLE PATTERNS</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *    - Prefetcher learns: &quot;he&#39;s streaming forward through memory&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *    - Reuse breaks this: same address, different data, different time</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *    - Result: prefetcher gives up, cache misses explode</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * 2. TRAINING NEEDS ALL ACTIVATIONS</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *    - Forward: compute activations</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *    - Backward: need EVERY activation to compute gradients</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *    - Can&#39;t reuse what you still need!</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * 3. MEMORY IS CHEAP, BANDWIDTH IS EXPENSIVE</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *    - DDR5: ~$3/GB (1TB = $3000, trivial for training cluster)</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *    - Bandwidth: 100-400 GB/s per socket (the real bottleneck)</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *    - Optimize for streaming, not for saving bytes</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * 4. SINGLE ALLOCATION = ZERO RUNTIME MALLOC</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *    - No fragmentation, no free(), no double-free bugs</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *    - Hugepage-backed: 1GB pages for NUMA optimization</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> *    - One base pointer + offsets = maximum simplicity</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * =============================================================================</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * SECTION ARCHITECTURE</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * =============================================================================</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> * Multi-modal models have multiple SECTIONS. Each section is a complete</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * encoder/decoder/vision/audio module with its own dimensions.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> *   ┌─────────────────────────────────────────────────────────────────┐</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> *   │                        SINGLE ALLOCATION                        │</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> *   ├─────────────────────────────────────────────────────────────────┤</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> *   │ SECTION 0: Vision Encoder                                       │</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> *   │   ├── HEADER: patch_embed, pos_embed                           │</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> *   │   ├── BODY:   layer[0..N] (weights + activations interleaved)  │</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> *   │   └── FOOTER: final_norm, bridge_to_text                       │</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> *   ├─────────────────────────────────────────────────────────────────┤</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> *   │ SECTION 1: Text Decoder                                         │</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> *   │   ├── HEADER: token_embed, pos_embed                           │</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> *   │   ├── BODY:   layer[0..N] (weights + activations interleaved)  │</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> *   │   └── FOOTER: final_norm, lm_head, logits                      │</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> *   ├─────────────────────────────────────────────────────────────────┤</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> *   │ SECTION 2: Audio Encoder (optional)                             │</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> *   │   ├── HEADER: mel_embed                                         │</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> *   │   ├── BODY:   layer[0..N]                                       │</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> *   │   └── FOOTER: bridge_to_text                                    │</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> *   ├─────────────────────────────────────────────────────────────────┤</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> *   │ GRADIENTS (if training)                                         │</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> *   │   └── Same layout: section[0].grads, section[1].grads, ...     │</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> *   ├─────────────────────────────────────────────────────────────────┤</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> *   │ OPTIMIZER STATE (if training with Adam)                         │</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> *   │   └── m[], v[] for each weight                                  │</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> *   └─────────────────────────────────────────────────────────────────┘</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> * =============================================================================</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> * EXECUTION ORDER LAYOUT</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> * =============================================================================</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> * Within each layer, memory is laid out in the ORDER operations execute:</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> *   weight → activation → weight → activation → ...</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> * This is critical for CPU cache efficiency. The CPU streams forward,</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> * prefetching the next cache line while processing the current one.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#ifndef CKERNEL_SECTION_LAYOUT_H</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#define CKERNEL_SECTION_LAYOUT_H</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"> * ALIGNMENT CONSTANTS</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#ad9ab657b96af3e55f3f6b56c799ef6a1">   88</a></span>&#160;<span class="preprocessor">#define CK_ALIGN_CACHE      64ULL           </span><span class="comment">/* CPU cache line (64 bytes) */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#a1a512f1e5caa9a5d3157053bdce18847">   89</a></span>&#160;<span class="preprocessor">#define CK_ALIGN_SIMD       64ULL           </span><span class="comment">/* AVX-512 register (64 bytes) */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#a99ca15bfe0225d4e7e71a7818eae2fe7">   90</a></span>&#160;<span class="preprocessor">#define CK_ALIGN_HUGE_2MB   (2ULL &lt;&lt; 20)    </span><span class="comment">/* 2MB hugepage */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#ad9dd86845c001eee80d1f249b848c08c">   91</a></span>&#160;<span class="preprocessor">#define CK_ALIGN_HUGE_1GB   (1ULL &lt;&lt; 30)    </span><span class="comment">/* 1GB hugepage (NUMA optimal) */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> * SECTION CONFIG</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> * Each section (encoder/decoder/vision/audio) has its own dimensions.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> * A vision encoder might have embed_dim=1024, while text decoder has 4096.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">/* === DIMENSIONS === */</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">int</span> embed_dim;              <span class="comment">/* hidden_size for this section */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">int</span> num_heads;              <span class="comment">/* attention heads */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">int</span> num_kv_heads;           <span class="comment">/* key-value heads (for GQA) */</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">int</span> head_dim;               <span class="comment">/* embed_dim / num_heads */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">int</span> intermediate_dim;       <span class="comment">/* MLP hidden dimension */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">int</span> num_layers;             <span class="comment">/* transformer layers in this section */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">/* === VOCABULARY (optional, only for sections with embeddings) === */</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">int</span> vocab_size;             <span class="comment">/* 0 if no token embedding in this section */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">/* === SEQUENCE === */</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">int</span> max_seq_len;            <span class="comment">/* maximum sequence length */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">/* === ALIGNED DIMENSIONS (computed, for SIMD) === */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">int</span> aligned_embed;          <span class="comment">/* embed_dim padded to SIMD boundary */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordtype">int</span> aligned_head;           <span class="comment">/* head_dim padded to SIMD boundary */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordtype">int</span> aligned_intermediate;   <span class="comment">/* intermediate_dim padded to SIMD boundary */</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">/* === FEATURES === */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="structCKSectionConfig.html#a42f1619a5ca0b7dbee3506ab18f994e5">  121</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structCKSectionConfig.html#a42f1619a5ca0b7dbee3506ab18f994e5">has_bias</a>;               <span class="comment">/* 1 if layers have bias terms */</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structCKSectionConfig.html#a4022d24bbcdac19db5fa032e6f02480f">  122</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structCKSectionConfig.html#a4022d24bbcdac19db5fa032e6f02480f">has_rope</a>;               <span class="comment">/* 1 if using rotary position embeddings */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structCKSectionConfig.html#a5309473074acf80aeb6e9ac8ec68bbc8">  123</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structCKSectionConfig.html#a5309473074acf80aeb6e9ac8ec68bbc8">has_pos_embed</a>;          <span class="comment">/* 1 if using learned position embeddings */</span></div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="structCKSectionConfig.html#a3348e1ea8c54d4e25647daa3685da89a">  124</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structCKSectionConfig.html#a3348e1ea8c54d4e25647daa3685da89a">gated_mlp</a>;              <span class="comment">/* 1 if MLP is gated (SwiGLU/GeGLU) */</span></div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structCKSectionConfig.html#a96ef28b42bf7654f3eeb5167950f31e9">  125</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structCKSectionConfig.html#a96ef28b42bf7654f3eeb5167950f31e9">norm_type</a>;              <span class="comment">/* 0=LayerNorm, 1=RMSNorm */</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;} <a class="code" href="structCKSectionConfig.html">CKSectionConfig</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> * HEADER OFFSETS</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> * The HEADER contains embeddings that happen BEFORE the transformer layers.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> * For text: token embeddings + position embeddings</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> * For vision: patch embeddings + position embeddings</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> * For audio: mel-spectrogram projection</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="structCKHeaderOffsets.html">  138</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">/* === TOKEN/PATCH EMBEDDING === */</span></div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="structCKHeaderOffsets.html#a09edd285803f7fecfbfe1a80ec241b23">  140</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKHeaderOffsets.html#a09edd285803f7fecfbfe1a80ec241b23">embed_weight</a>;        <span class="comment">/* [vocab_size, embed_dim] or [patch_dim, embed_dim] */</span></div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="structCKHeaderOffsets.html#a1c5c78d482920812a8353fe8b31a9038">  141</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKHeaderOffsets.html#a1c5c78d482920812a8353fe8b31a9038">embed_output</a>;        <span class="comment">/* [seq_len, embed_dim] activation */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">/* === POSITION EMBEDDING (if learned) === */</span></div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="structCKHeaderOffsets.html#a5869de8e522fdd1b310d75bd8eb849bb">  144</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKHeaderOffsets.html#a5869de8e522fdd1b310d75bd8eb849bb">pos_embed_weight</a>;    <span class="comment">/* [max_seq_len, embed_dim] weight */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="structCKHeaderOffsets.html#a2a082e03809f5e60dc469836ec86e553">  145</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKHeaderOffsets.html#a2a082e03809f5e60dc469836ec86e553">pos_embed_output</a>;    <span class="comment">/* [seq_len, embed_dim] activation (added to embed) */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">/* === COMBINED OUTPUT === */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structCKHeaderOffsets.html#af6277b6a25c2312f49d22592e268dab0">  148</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKHeaderOffsets.html#af6277b6a25c2312f49d22592e268dab0">header_output</a>;       <span class="comment">/* [seq_len, embed_dim] = embed + pos (input to body) */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">/* === BYTE BOUNDARIES === */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="structCKHeaderOffsets.html#a8bd89231afd3b0a519c8491e955504df">  151</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKHeaderOffsets.html#a8bd89231afd3b0a519c8491e955504df">header_start</a>;        <span class="comment">/* first byte of header */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="structCKHeaderOffsets.html#acb634ce1abbf44e2ee2791e8a1d1817e">  152</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKHeaderOffsets.html#acb634ce1abbf44e2ee2791e8a1d1817e">header_end</a>;          <span class="comment">/* last byte + 1 of header */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;} <a class="code" href="structCKHeaderOffsets.html">CKHeaderOffsets</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> * LAYER OFFSETS (within BODY)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> * Each layer&#39;s memory is laid out in EXECUTION ORDER:</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> *   pre_norm → qkv_proj → rope → attention → out_proj → residual →</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> *   post_norm → mlp_gate → mlp_up → activation → mlp_down → residual</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> * Weights and activations are INTERLEAVED, not separated.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">/* === LAYER INPUT === */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="structCKLayerOffsets.html#a207b51ce0a5d8afb92fbb3f810ca4574">  168</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerOffsets.html#a207b51ce0a5d8afb92fbb3f810ca4574">input</a>;               <span class="comment">/* [seq, embed] activation (from previous layer or header) */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">/* ========== ATTENTION BLOCK ========== */</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">/* Pre-Attention Normalization */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">size_t</span> ln1_gamma;           <span class="comment">/* [embed] weight */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">size_t</span> ln1_beta;            <span class="comment">/* [embed] weight (NULL if RMSNorm) */</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">size_t</span> ln1_output;          <span class="comment">/* [seq, embed] activation */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">/* Q Projection */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">size_t</span> wq;                  <span class="comment">/* [embed, num_heads * head_dim] weight */</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">size_t</span> bq;                  <span class="comment">/* [num_heads * head_dim] bias (optional) */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">size_t</span> q;                   <span class="comment">/* [seq, num_heads, head_dim] activation */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">/* K Projection */</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">size_t</span> wk;                  <span class="comment">/* [embed, num_kv_heads * head_dim] weight */</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">size_t</span> bk;                  <span class="comment">/* [num_kv_heads * head_dim] bias (optional) */</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">size_t</span> k;                   <span class="comment">/* [seq, num_kv_heads, head_dim] activation */</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">/* V Projection */</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">size_t</span> wv;                  <span class="comment">/* [embed, num_kv_heads * head_dim] weight */</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">size_t</span> bv;                  <span class="comment">/* [num_kv_heads * head_dim] bias (optional) */</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">size_t</span> v;                   <span class="comment">/* [seq, num_kv_heads, head_dim] activation */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">/* RoPE (if enabled) */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">size_t</span> q_rope;              <span class="comment">/* [seq, num_heads, head_dim] activation */</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">size_t</span> k_rope;              <span class="comment">/* [seq, num_kv_heads, head_dim] activation */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">/* Attention Scores */</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">size_t</span> attn_scores;         <span class="comment">/* [num_heads, seq, seq] activation (Q @ K^T) */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">size_t</span> attn_probs;          <span class="comment">/* [num_heads, seq, seq] activation (softmax) */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">/* Attention Output */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="structCKLayerOffsets.html#a6f26daba0ff5fda605b9a751ac2ba2ee">  201</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerOffsets.html#a6f26daba0ff5fda605b9a751ac2ba2ee">attn_out</a>;            <span class="comment">/* [seq, num_heads, head_dim] activation (probs @ V) */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">/* Output Projection */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">size_t</span> wo;                  <span class="comment">/* [num_heads * head_dim, embed] weight */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">size_t</span> bo;                  <span class="comment">/* [embed] bias (optional) */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="structCKLayerOffsets.html#ad4bc2b7cea35add011aa22e48f10f99c">  206</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerOffsets.html#ad4bc2b7cea35add011aa22e48f10f99c">proj_out</a>;            <span class="comment">/* [seq, embed] activation */</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">/* Residual Connection 1 */</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">size_t</span> residual1;           <span class="comment">/* [seq, embed] activation (input + proj_out) */</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">/* ========== MLP BLOCK ========== */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">/* Post-Attention Normalization */</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">size_t</span> ln2_gamma;           <span class="comment">/* [embed] weight */</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">size_t</span> ln2_beta;            <span class="comment">/* [embed] weight (NULL if RMSNorm) */</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">size_t</span> ln2_output;          <span class="comment">/* [seq, embed] activation */</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">/* MLP Gate Projection (for gated MLP like SwiGLU) */</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">size_t</span> mlp_gate_w;          <span class="comment">/* [embed, intermediate] weight */</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">size_t</span> mlp_gate_b;          <span class="comment">/* [intermediate] bias (optional) */</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">size_t</span> mlp_gate_out;        <span class="comment">/* [seq, intermediate] activation */</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">/* MLP Up Projection */</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">size_t</span> mlp_up_w;            <span class="comment">/* [embed, intermediate] weight */</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">size_t</span> mlp_up_b;            <span class="comment">/* [intermediate] bias (optional) */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">size_t</span> mlp_up_out;          <span class="comment">/* [seq, intermediate] activation */</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">/* MLP Activation (SiLU/GELU) */</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">size_t</span> mlp_act_out;         <span class="comment">/* [seq, intermediate] activation (gate * silu(up)) */</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">/* MLP Down Projection */</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">size_t</span> mlp_down_w;          <span class="comment">/* [intermediate, embed] weight */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">size_t</span> mlp_down_b;          <span class="comment">/* [embed] bias (optional) */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">size_t</span> mlp_down_out;        <span class="comment">/* [seq, embed] activation */</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">/* Residual Connection 2 */</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">size_t</span> residual2;           <span class="comment">/* [seq, embed] activation (residual1 + mlp_down_out) */</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">/* ========== LAYER OUTPUT ========== */</span></div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="structCKLayerOffsets.html#a253ebe103830f66006e992c1942359c6">  240</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerOffsets.html#a253ebe103830f66006e992c1942359c6">output</a>;              <span class="comment">/* [seq, embed] = residual2 (input to next layer) */</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">/* ========== KV CACHE (decode mode) ========== */</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">size_t</span> k_cache;             <span class="comment">/* [max_seq, num_kv_heads, head_dim] persistent */</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">size_t</span> v_cache;             <span class="comment">/* [max_seq, num_kv_heads, head_dim] persistent */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">/* ========== BYTE BOUNDARIES ========== */</span></div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="structCKLayerOffsets.html#ace63bf4c6c97434a4fa90d2f765cf96f">  247</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerOffsets.html#ace63bf4c6c97434a4fa90d2f765cf96f">layer_start</a>;         <span class="comment">/* first byte of this layer */</span></div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="structCKLayerOffsets.html#a968c7ab2fdc25c0e8bf2b98d12b79687">  248</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerOffsets.html#a968c7ab2fdc25c0e8bf2b98d12b79687">layer_end</a>;           <span class="comment">/* last byte + 1 of this layer */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;} <a class="code" href="structCKLayerOffsets.html">CKLayerOffsets</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> * LAYER GRADIENT OFFSETS (for training)</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> * Gradients follow the same interleaved pattern.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"> * Laid out AFTER all forward activations (or interleaved per-layer).</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">/* === ATTENTION BLOCK GRADIENTS === */</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">size_t</span> d_ln1_gamma, d_ln1_beta;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">size_t</span> d_ln1_output;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">size_t</span> d_wq, d_bq, d_q;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">size_t</span> d_wk, d_bk, d_k;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">size_t</span> d_wv, d_bv, d_v;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#a2d059e5b3e882d461ee74d459b54aeae">  268</a></span>&#160;    <span class="keywordtype">size_t</span> d_attn_scores, <a class="code" href="structCKLayerGradOffsets.html#a2d059e5b3e882d461ee74d459b54aeae">d_attn_probs</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#a5383122bbd9bca1d26dc23bca84d3ef3">  269</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerGradOffsets.html#a5383122bbd9bca1d26dc23bca84d3ef3">d_attn_out</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordtype">size_t</span> d_wo, d_bo;</div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#ab39bad6aa2d7b4cdd624e1a3d4b18ca9">  272</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerGradOffsets.html#ab39bad6aa2d7b4cdd624e1a3d4b18ca9">d_proj_out</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#a8f5b64f6f0b8ce9fcd1264b8638b7082">  273</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerGradOffsets.html#a8f5b64f6f0b8ce9fcd1264b8638b7082">d_residual1</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">/* === MLP BLOCK GRADIENTS === */</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">size_t</span> d_ln2_gamma, d_ln2_beta;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">size_t</span> d_ln2_output;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#a020b61adaa42a2b67579be3ce01f4d4c">  279</a></span>&#160;    <span class="keywordtype">size_t</span> d_mlp_gate_w, <a class="code" href="structCKLayerGradOffsets.html#a020b61adaa42a2b67579be3ce01f4d4c">d_mlp_gate_b</a>, d_mlp_gate_out;</div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#aa70642f467ced05a1ce8e4795c9ec152">  280</a></span>&#160;    <span class="keywordtype">size_t</span> d_mlp_up_w, <a class="code" href="structCKLayerGradOffsets.html#aa70642f467ced05a1ce8e4795c9ec152">d_mlp_up_b</a>, d_mlp_up_out;</div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#aa093a6afe597f5b90196549170cb4aab">  281</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerGradOffsets.html#aa093a6afe597f5b90196549170cb4aab">d_mlp_act_out</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#ab0fdf34b696663ecd2a6adc66dc35e88">  282</a></span>&#160;    <span class="keywordtype">size_t</span> d_mlp_down_w, <a class="code" href="structCKLayerGradOffsets.html#ab0fdf34b696663ecd2a6adc66dc35e88">d_mlp_down_b</a>, d_mlp_down_out;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#a40ee9ccba2e0a9b235f9350742fa7c96">  284</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerGradOffsets.html#a40ee9ccba2e0a9b235f9350742fa7c96">d_residual2</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#ace7e61f43563a3d22ea91a363aeb5609">  285</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerGradOffsets.html#ace7e61f43563a3d22ea91a363aeb5609">d_output</a>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">/* === BYTE BOUNDARIES === */</span></div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#a6272144a177f1aa0fd8a3ff88a84c88b">  288</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerGradOffsets.html#a6272144a177f1aa0fd8a3ff88a84c88b">grad_start</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="structCKLayerGradOffsets.html#ad3dcd4463deb7947578383f61a5800d9">  289</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerGradOffsets.html#ad3dcd4463deb7947578383f61a5800d9">grad_end</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;} <a class="code" href="structCKLayerGradOffsets.html">CKLayerGradOffsets</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"> * LAYER OPTIMIZER STATE (Adam m and v)</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html">  297</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">/* First moment (m) for each weight */</span></div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a33e61c51c31c2fa53bbf9f4a42a6acb4">  299</a></span>&#160;    <span class="keywordtype">size_t</span> m_ln1_gamma, <a class="code" href="structCKLayerOptimizerOffsets.html#a33e61c51c31c2fa53bbf9f4a42a6acb4">m_ln1_beta</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a3cf63cde129a1b236bdad073b670c502">  300</a></span>&#160;    <span class="keywordtype">size_t</span> m_wq, m_bq, m_wk, <a class="code" href="structCKLayerOptimizerOffsets.html#a3cf63cde129a1b236bdad073b670c502">m_bk</a>, m_wv, m_bv;</div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#aa562f5efd6173858cf43d57551e53a34">  301</a></span>&#160;    <span class="keywordtype">size_t</span> m_wo, <a class="code" href="structCKLayerOptimizerOffsets.html#aa562f5efd6173858cf43d57551e53a34">m_bo</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a821ddf375173a7d11f8694c177a63d93">  302</a></span>&#160;    <span class="keywordtype">size_t</span> m_ln2_gamma, <a class="code" href="structCKLayerOptimizerOffsets.html#a821ddf375173a7d11f8694c177a63d93">m_ln2_beta</a>;</div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a3f6bc539802d8836399a9bc58b64880f">  303</a></span>&#160;    <span class="keywordtype">size_t</span> m_mlp_gate_w, <a class="code" href="structCKLayerOptimizerOffsets.html#a3f6bc539802d8836399a9bc58b64880f">m_mlp_gate_b</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a9dec06808a0e417685225e98d95ff37a">  304</a></span>&#160;    <span class="keywordtype">size_t</span> m_mlp_up_w, <a class="code" href="structCKLayerOptimizerOffsets.html#a9dec06808a0e417685225e98d95ff37a">m_mlp_up_b</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a34a29c9146fdacaa56a6118fa684fa86">  305</a></span>&#160;    <span class="keywordtype">size_t</span> m_mlp_down_w, <a class="code" href="structCKLayerOptimizerOffsets.html#a34a29c9146fdacaa56a6118fa684fa86">m_mlp_down_b</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">/* Second moment (v) for each weight */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#acd7cb9443cff2872dc2fa0c6b6b159a6">  308</a></span>&#160;    <span class="keywordtype">size_t</span> v_ln1_gamma, <a class="code" href="structCKLayerOptimizerOffsets.html#acd7cb9443cff2872dc2fa0c6b6b159a6">v_ln1_beta</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a1bea81a97d9e230388a11aa88fcfaab8">  309</a></span>&#160;    <span class="keywordtype">size_t</span> v_wq, v_bq, v_wk, <a class="code" href="structCKLayerOptimizerOffsets.html#a1bea81a97d9e230388a11aa88fcfaab8">v_bk</a>, v_wv, v_bv;</div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a64ed5b2a6e204efd8d40429fd9700744">  310</a></span>&#160;    <span class="keywordtype">size_t</span> v_wo, <a class="code" href="structCKLayerOptimizerOffsets.html#a64ed5b2a6e204efd8d40429fd9700744">v_bo</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a205ea40a57d44759dce23b92ce8a853f">  311</a></span>&#160;    <span class="keywordtype">size_t</span> v_ln2_gamma, <a class="code" href="structCKLayerOptimizerOffsets.html#a205ea40a57d44759dce23b92ce8a853f">v_ln2_beta</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a2b7d74bd97a70cc3ef67619b1090f5f1">  312</a></span>&#160;    <span class="keywordtype">size_t</span> v_mlp_gate_w, <a class="code" href="structCKLayerOptimizerOffsets.html#a2b7d74bd97a70cc3ef67619b1090f5f1">v_mlp_gate_b</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a7bafeba33b123654fbd253bbdded7bd6">  313</a></span>&#160;    <span class="keywordtype">size_t</span> v_mlp_up_w, <a class="code" href="structCKLayerOptimizerOffsets.html#a7bafeba33b123654fbd253bbdded7bd6">v_mlp_up_b</a>;</div>
<div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a7cd21b2bb571c27da41ab7cd5c452b7f">  314</a></span>&#160;    <span class="keywordtype">size_t</span> v_mlp_down_w, <a class="code" href="structCKLayerOptimizerOffsets.html#a7cd21b2bb571c27da41ab7cd5c452b7f">v_mlp_down_b</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">/* Byte boundaries */</span></div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#a768c2644e129903d370b4010d37c74eb">  317</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerOptimizerOffsets.html#a768c2644e129903d370b4010d37c74eb">opt_start</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="structCKLayerOptimizerOffsets.html#ac4940fcc8708472a83f4622f033ebbb6">  318</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKLayerOptimizerOffsets.html#ac4940fcc8708472a83f4622f033ebbb6">opt_end</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;} <a class="code" href="structCKLayerOptimizerOffsets.html">CKLayerOptimizerOffsets</a>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"> * FOOTER OFFSETS</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"> * The FOOTER contains layers AFTER the transformer body:</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"> * - Final normalization</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"> * - Output projection (lm_head for text, classifier for vision)</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"> * - Bridge projection (to connect to next section)</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html">  331</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">/* === FINAL NORMALIZATION === */</span></div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#ab47cf73ae4b7e7de8cf801fa9ce1dc5c">  333</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#ab47cf73ae4b7e7de8cf801fa9ce1dc5c">final_ln_gamma</a>;      <span class="comment">/* [embed] weight */</span></div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#a8866b0a08fa2195bbb577d5e4a4e12dd">  334</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#a8866b0a08fa2195bbb577d5e4a4e12dd">final_ln_beta</a>;       <span class="comment">/* [embed] weight (NULL if RMSNorm) */</span></div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#ab297d1de6261098375f31e149519d4d4">  335</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#ab297d1de6261098375f31e149519d4d4">final_ln_output</a>;     <span class="comment">/* [seq, embed] activation */</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">/* === OUTPUT HEAD (optional) === */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#ad4256e4d307e8deb6aadc34113d81e90">  338</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#ad4256e4d307e8deb6aadc34113d81e90">lm_head_w</a>;           <span class="comment">/* [embed, vocab] weight (may tie with embed_weight) */</span></div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#a97bbf97af4ac45e5c16437af7842957b">  339</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#a97bbf97af4ac45e5c16437af7842957b">lm_head_b</a>;           <span class="comment">/* [vocab] bias (optional) */</span></div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#a638f017bdaec7d988d89bf2692a48d6b">  340</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#a638f017bdaec7d988d89bf2692a48d6b">logits</a>;              <span class="comment">/* [seq, vocab] activation */</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">/* === BRIDGE TO NEXT SECTION (optional) === */</span></div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#a5a3df48e55198eeebcfba9453881de01">  343</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#a5a3df48e55198eeebcfba9453881de01">bridge_w</a>;            <span class="comment">/* [this_embed, next_embed] weight */</span></div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#a6e968314ca3082225d5fdbeda2c64343">  344</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#a6e968314ca3082225d5fdbeda2c64343">bridge_b</a>;            <span class="comment">/* [next_embed] bias (optional) */</span></div>
<div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#a44484b840457f80b8fa286f5167d1687">  345</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#a44484b840457f80b8fa286f5167d1687">bridge_output</a>;       <span class="comment">/* [seq, next_embed] activation */</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">/* === BYTE BOUNDARIES === */</span></div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#ae734eedf274912ce617fb86c5c14cbf4">  348</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#ae734eedf274912ce617fb86c5c14cbf4">footer_start</a>;</div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="structCKFooterOffsets.html#a17d1b0599249931fab10aa62ce6b8b20">  349</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterOffsets.html#a17d1b0599249931fab10aa62ce6b8b20">footer_end</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;} <a class="code" href="structCKFooterOffsets.html">CKFooterOffsets</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"> * FOOTER GRADIENTS (for training)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="structCKFooterGradOffsets.html">  357</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="structCKFooterGradOffsets.html#ada3b948a5b678ac0f01d74bf7ab3a8c8">  358</a></span>&#160;    <span class="keywordtype">size_t</span> d_final_ln_gamma, <a class="code" href="structCKFooterGradOffsets.html#ada3b948a5b678ac0f01d74bf7ab3a8c8">d_final_ln_beta</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="structCKFooterGradOffsets.html#ae2a60b057eaa172d1132474349ad5d40">  359</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterGradOffsets.html#ae2a60b057eaa172d1132474349ad5d40">d_final_ln_output</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="structCKFooterGradOffsets.html#a6b4894e65e79da4ec83a9b2b535ef519">  361</a></span>&#160;    <span class="keywordtype">size_t</span> d_lm_head_w, <a class="code" href="structCKFooterGradOffsets.html#a6b4894e65e79da4ec83a9b2b535ef519">d_lm_head_b</a>;</div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="structCKFooterGradOffsets.html#ac3f2b08b2785cf1fa039bb3c0e6e2197">  362</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterGradOffsets.html#ac3f2b08b2785cf1fa039bb3c0e6e2197">d_logits</a>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="structCKFooterGradOffsets.html#a39e8fc85fe6bcd5c1a1fbd7ced054879">  364</a></span>&#160;    <span class="keywordtype">size_t</span> d_bridge_w, <a class="code" href="structCKFooterGradOffsets.html#a39e8fc85fe6bcd5c1a1fbd7ced054879">d_bridge_b</a>;</div>
<div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="structCKFooterGradOffsets.html#ae6e42eddc33324875a7458f7d804a694">  365</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterGradOffsets.html#ae6e42eddc33324875a7458f7d804a694">d_bridge_output</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="structCKFooterGradOffsets.html#ae9169fef93e53c932b9f4728d8cb6e30">  367</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterGradOffsets.html#ae9169fef93e53c932b9f4728d8cb6e30">grad_start</a>;</div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="structCKFooterGradOffsets.html#a1033308e389797d86251b87a79781bae">  368</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKFooterGradOffsets.html#a1033308e389797d86251b87a79781bae">grad_end</a>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;} <a class="code" href="structCKFooterGradOffsets.html">CKFooterGradOffsets</a>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"> * SECTION - Complete Header + Body + Footer</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"> * Each section is a self-contained module (encoder, decoder, vision, audio).</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">/* === CONFIGURATION === */</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="structCKSectionConfig.html">CKSectionConfig</a> config;</div>
<div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="structCKSection.html#a0c37521cc2163ed38a4d65ff9ce2f381">  381</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structCKSection.html#a0c37521cc2163ed38a4d65ff9ce2f381">name</a>;           <span class="comment">/* &quot;vision_encoder&quot;, &quot;text_decoder&quot;, etc. */</span></div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="structCKSection.html#aaf13683953b54b12a83a90251eb6a881">  382</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structCKSection.html#aaf13683953b54b12a83a90251eb6a881">section_id</a>;             <span class="comment">/* 0, 1, 2, ... */</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">/* === HEADER === */</span></div>
<div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="structCKSection.html#adafbb43b1edb42a0adb1b97311b601a4">  385</a></span>&#160;    <a class="code" href="structCKHeaderOffsets.html">CKHeaderOffsets</a> <a class="code" href="structCKSection.html#adafbb43b1edb42a0adb1b97311b601a4">header</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">/* === BODY (transformer layers) === */</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordtype">int</span> num_layers;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="structCKLayerOffsets.html">CKLayerOffsets</a> *layers;             <span class="comment">/* Array of per-layer offsets */</span></div>
<div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="structCKSection.html#acd76a9f347cf9d4551e7c7cd33ca8f30">  390</a></span>&#160;    <a class="code" href="structCKLayerGradOffsets.html">CKLayerGradOffsets</a> *<a class="code" href="structCKSection.html#acd76a9f347cf9d4551e7c7cd33ca8f30">layer_grads</a>;    <span class="comment">/* Array of per-layer gradient offsets */</span></div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="structCKSection.html#a77177dc1f5d94b91942e9dd199556661">  391</a></span>&#160;    <a class="code" href="structCKLayerOptimizerOffsets.html">CKLayerOptimizerOffsets</a> *<a class="code" href="structCKSection.html#a77177dc1f5d94b91942e9dd199556661">layer_opt</a>; <span class="comment">/* Array of per-layer optimizer state */</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">/* === FOOTER === */</span></div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="structCKSection.html#aa030a13ebf6b121d19344e0249786fb8">  394</a></span>&#160;    <a class="code" href="structCKFooterOffsets.html">CKFooterOffsets</a> <a class="code" href="structCKSection.html#aa030a13ebf6b121d19344e0249786fb8">footer</a>;</div>
<div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="structCKSection.html#aeb788d634d43d321c22d52573318692f">  395</a></span>&#160;    <a class="code" href="structCKFooterGradOffsets.html">CKFooterGradOffsets</a> <a class="code" href="structCKSection.html#aeb788d634d43d321c22d52573318692f">footer_grads</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">/* === GLOBAL BUFFERS FOR THIS SECTION === */</span></div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="structCKSection.html#a54f5ffde9d9968d1f3b928dc54bbd439">  398</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKSection.html#a54f5ffde9d9968d1f3b928dc54bbd439">rope_cos</a>;            <span class="comment">/* [max_seq, head_dim/2] RoPE cosines */</span></div>
<div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="structCKSection.html#a117cf20f51a6d9d22c18fad061fde15f">  399</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKSection.html#a117cf20f51a6d9d22c18fad061fde15f">rope_sin</a>;            <span class="comment">/* [max_seq, head_dim/2] RoPE sines */</span></div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="structCKSection.html#a74a02e21d1d89af4a3f64c236b5595d7">  400</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKSection.html#a74a02e21d1d89af4a3f64c236b5595d7">causal_mask</a>;         <span class="comment">/* [max_seq, max_seq] causal attention mask */</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">/* === SECTION BYTE BOUNDARIES === */</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">size_t</span> section_start;       <span class="comment">/* First byte of this section */</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">size_t</span> section_end;         <span class="comment">/* Last byte + 1 of this section */</span></div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="structCKSection.html#a50088bc199e240759c6402920180e469">  405</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKSection.html#a50088bc199e240759c6402920180e469">section_weight_bytes</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="structCKSection.html#aa21574168860ae278245951028df3ff0">  406</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKSection.html#aa21574168860ae278245951028df3ff0">section_activation_bytes</a>;</div>
<div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="structCKSection.html#aeea1efa805610505363a8dbe6d734282">  407</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKSection.html#aeea1efa805610505363a8dbe6d734282">section_grad_bytes</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="structCKSection.html#abd9ca87b9ad74cd97d0096872749fbc8">  408</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKSection.html#abd9ca87b9ad74cd97d0096872749fbc8">section_opt_bytes</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;} <a class="code" href="structCKSection.html">CKSection</a>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"> * MODEL - The Complete Multi-Section Model</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"> * ONE allocation. ONE base pointer. ALL offsets relative to base.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">/* === MEMORY === */</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">void</span> *base;                 <span class="comment">/* THE single allocation */</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">size_t</span> total_bytes;         <span class="comment">/* Total size of allocation */</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">/* === BREAKDOWN === */</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">size_t</span> weight_bytes;        <span class="comment">/* Total weights across all sections */</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">size_t</span> activation_bytes;    <span class="comment">/* Total activations */</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">size_t</span> grad_bytes;          <span class="comment">/* Total gradients (0 if inference) */</span></div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="structCKModel.html#a4f3d9a363a8fc7d37556b33e6b20cd69">  427</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKModel.html#a4f3d9a363a8fc7d37556b33e6b20cd69">opt_bytes</a>;           <span class="comment">/* Total optimizer state (0 if inference) */</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">/* === SECTIONS === */</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">int</span> num_sections;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="structCKSection.html">CKSection</a> *sections;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">/* === GLOBAL SHARED BUFFERS === */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="structCKModel.html#a23c5fb291d06cc7cbe7aa8bc2a07b06b">  434</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKModel.html#a23c5fb291d06cc7cbe7aa8bc2a07b06b">shared_scratch</a>;      <span class="comment">/* Scratch buffer for temp computations */</span></div>
<div class="line"><a name="l00435"></a><span class="lineno"><a class="line" href="structCKModel.html#afdaa49dc294acb37ed54a2708b6bc8e0">  435</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKModel.html#afdaa49dc294acb37ed54a2708b6bc8e0">shared_scratch_bytes</a>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">/* === MODE FLAGS === */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="structCKModel.html#a84832de4929055025d6634e18ceae38a">  438</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structCKModel.html#a84832de4929055025d6634e18ceae38a">training_enabled</a>;       <span class="comment">/* 0=inference, 1=training */</span></div>
<div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="structCKModel.html#a30077b979aff326f5c4bd20da8b6d807">  439</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structCKModel.html#a30077b979aff326f5c4bd20da8b6d807">kv_cache_enabled</a>;       <span class="comment">/* 0=prefill, 1=decode with cache */</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    uint32_t fusion_flags;      <span class="comment">/* Bitmask of enabled kernel fusions */</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">/* === RUNTIME STATE (not offsets) === */</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">int</span> current_seq_len;        <span class="comment">/* Tokens processed in current sequence */</span></div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="structCKModel.html#a9b0ad93300ab3b15395daf0d8e720f4d">  444</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structCKModel.html#a9b0ad93300ab3b15395daf0d8e720f4d">current_pos</a>;            <span class="comment">/* Position for decode mode */</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">/* === NUMA INFO === */</span></div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="structCKModel.html#a2a35dbca7a62e3ebe14b6c502c68f2aa">  447</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structCKModel.html#a2a35dbca7a62e3ebe14b6c502c68f2aa">num_numa_nodes</a>;         <span class="comment">/* Number of NUMA nodes detected */</span></div>
<div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="structCKModel.html#a9122ea9b37528516af41eb29c237838f">  448</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structCKModel.html#a9122ea9b37528516af41eb29c237838f">hugepage_size</a>;       <span class="comment">/* Size of hugepages (2MB or 1GB) */</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;} <a class="code" href="structCKModel.html">CKModel</a>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"> * FUSION FLAGS</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"> * When a fusion is enabled, intermediate activations are SKIPPED.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"> * Memory is still allocated, but the fused kernel bypasses it.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efe">  459</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeac701cd87ffd41b651fdb39fd4d9231db">  460</a></span>&#160;    <a class="code" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeac701cd87ffd41b651fdb39fd4d9231db">CK_FUSE_NONE</a>            = 0,</div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea45bba7ecc02555c097f51c9469157a21">  461</a></span>&#160;    <a class="code" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea45bba7ecc02555c097f51c9469157a21">CK_FUSE_EMBED_NORM</a>      = 1 &lt;&lt; 0,   <span class="comment">/* embedding + first layernorm */</span></div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea34b104e34a7aa0d0937ad1d8d064f0a9">  462</a></span>&#160;    <a class="code" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea34b104e34a7aa0d0937ad1d8d064f0a9">CK_FUSE_NORM_QKV</a>        = 1 &lt;&lt; 1,   <span class="comment">/* layernorm + QKV projection */</span></div>
<div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeabdee28d29574a516859ce8a97cdbe959">  463</a></span>&#160;    <a class="code" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeabdee28d29574a516859ce8a97cdbe959">CK_FUSE_QKV_ROPE</a>        = 1 &lt;&lt; 2,   <span class="comment">/* QKV + rotary position encoding */</span></div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea43848ac20412b3e616a81b53bacb02ce">  464</a></span>&#160;    <a class="code" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea43848ac20412b3e616a81b53bacb02ce">CK_FUSE_ATTN_PROJ</a>       = 1 &lt;&lt; 3,   <span class="comment">/* attention output + projection */</span></div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeac49b63f12bae2e1fb3db203ec6a60fca">  465</a></span>&#160;    <a class="code" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeac49b63f12bae2e1fb3db203ec6a60fca">CK_FUSE_NORM_MLP</a>        = 1 &lt;&lt; 4,   <span class="comment">/* layernorm + MLP input */</span></div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeaa4b32bb297017e550a88ca82c0346b02">  466</a></span>&#160;    <a class="code" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeaa4b32bb297017e550a88ca82c0346b02">CK_FUSE_MLP_GATE_UP</a>     = 1 &lt;&lt; 5,   <span class="comment">/* gate and up projections together */</span></div>
<div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea97e883e02f60415d64767579e4b65eb2">  467</a></span>&#160;    <a class="code" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea97e883e02f60415d64767579e4b65eb2">CK_FUSE_MLP_ACT_DOWN</a>    = 1 &lt;&lt; 6,   <span class="comment">/* activation + down projection */</span></div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea6a3bb26ab9dcc8bb90714a3c77250997">  468</a></span>&#160;    <a class="code" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea6a3bb26ab9dcc8bb90714a3c77250997">CK_FUSE_RESIDUAL_NORM</a>   = 1 &lt;&lt; 7,   <span class="comment">/* residual add + layernorm */</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;} <a class="code" href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efe">CKFusionFlags</a>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment"> * MEMORY PLANNER API</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"> * Two-phase allocation:</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment"> * 1. Plan: dry run to compute all offsets and total size</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"> * 2. Allocate: single hugepage-backed mmap</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"> * Initialize section config with computed alignments.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#a45ba8ddf4f1d6280681d37136dbc3a5a">  482</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="ckernel__section__layout_8h.html#a45ba8ddf4f1d6280681d37136dbc3a5a">ck_section_config_init</a>(<a class="code" href="structCKSectionConfig.html">CKSectionConfig</a> *config, <span class="keywordtype">size_t</span> simd_align);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"> * Plan memory layout for a single section.</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"> * Returns bytes needed for this section.</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#a7a3e8075d666d342c725cea328322cd2">  488</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="ckernel__section__layout_8h.html#a7a3e8075d666d342c725cea328322cd2">ck_section_plan</a>(<a class="code" href="structCKSection.html">CKSection</a> *section,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                       <span class="keyword">const</span> <a class="code" href="structCKSectionConfig.html">CKSectionConfig</a> *config,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                       <span class="keywordtype">int</span> training_enabled,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                       <span class="keywordtype">size_t</span> base_offset);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"> * Plan memory layout for complete model.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"> * Returns total bytes needed.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#a82b72b659b7ce81f24b3f79b101ab6d4">  497</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="ckernel__section__layout_8h.html#a82b72b659b7ce81f24b3f79b101ab6d4">ck_model_plan</a>(<a class="code" href="structCKModel.html">CKModel</a> *model,</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                     <span class="keyword">const</span> <a class="code" href="structCKSectionConfig.html">CKSectionConfig</a> *configs,</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                     <span class="keywordtype">int</span> num_sections,</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                     <span class="keywordtype">int</span> training_enabled,</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                     uint32_t fusion_flags);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"> * Allocate the planned memory.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"> * @param hugepage_mode: 0=normal, 1=2MB hugepages, 2=1GB hugepages</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"> * @return 0 on success, -1 on failure</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#a8d52ec7a90940748c493c1e6cbb2675e">  508</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="ckernel__section__layout_8h.html#a8d52ec7a90940748c493c1e6cbb2675e">ck_model_allocate</a>(<a class="code" href="structCKModel.html">CKModel</a> *model, <span class="keywordtype">int</span> hugepage_mode);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"> * Free the model (single free, since single allocation).</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#a1098b7df468a5ac5164b440b6e08209f">  513</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="ckernel__section__layout_8h.html#a1098b7df468a5ac5164b440b6e08209f">ck_model_free</a>(<a class="code" href="structCKModel.html">CKModel</a> *model);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"> * ACCESSOR MACROS</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"> * Clean syntax for accessing tensors from offsets.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"> * ============================================================================ */</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">/* Get pointer from offset */</span></div>
<div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#aed689667a597546f4ca76393d018eb06">  522</a></span>&#160;<span class="preprocessor">#define CK_PTR(model, offset) \</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">    ((float*)((char*)(model)-&gt;base + (offset)))</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#a8c3c24884f3f89455a6578875d6ebe40">  525</a></span>&#160;<span class="preprocessor">#define CK_PTR_BF16(model, offset) \</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor">    ((uint16_t*)((char*)(model)-&gt;base + (offset)))</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">/* Get layer offsets for section s, layer l */</span></div>
<div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#abc25629d856fc301f5dcb0af8a63d03c">  529</a></span>&#160;<span class="preprocessor">#define CK_LAYER(model, s, l) \</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">    (&amp;(model)-&gt;sections[s].layers[l])</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">/* Get layer gradient offsets */</span></div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#ac3349598b4a574599247b50fd72e0be6">  533</a></span>&#160;<span class="preprocessor">#define CK_LAYER_GRAD(model, s, l) \</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor">    (&amp;(model)-&gt;sections[s].layer_grads[l])</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">/* Get header offsets for section s */</span></div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#a6cd4d41f081a79df7ac57cc0d39e086f">  537</a></span>&#160;<span class="preprocessor">#define CK_HEADER(model, s) \</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor">    (&amp;(model)-&gt;sections[s].header)</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">/* Get footer offsets for section s */</span></div>
<div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="ckernel__section__layout_8h.html#adc318f4f8aa045cac46a382d033efea4">  541</a></span>&#160;<span class="preprocessor">#define CK_FOOTER(model, s) \</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor">    (&amp;(model)-&gt;sections[s].footer)</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">/* ============================================================================</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"> * EXAMPLE USAGE</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"> * ============================================================================</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"> * // Define a vision-language model (2 sections)</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment"> * CKSectionConfig configs[2] = {</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"> *     // Section 0: Vision Encoder (ViT-L)</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"> *     { .embed_dim = 1024, .num_heads = 16, .num_kv_heads = 16,</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment"> *       .head_dim = 64, .intermediate_dim = 4096, .num_layers = 24,</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"> *       .vocab_size = 0, .max_seq_len = 576,  // 24x24 patches</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"> *       .has_bias = 1, .has_rope = 0, .has_pos_embed = 1,</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"> *       .gated_mlp = 0, .norm_type = 0 },</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"> *     // Section 1: Text Decoder (LLaMA-7B style)</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment"> *     { .embed_dim = 4096, .num_heads = 32, .num_kv_heads = 32,</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"> *       .head_dim = 128, .intermediate_dim = 11008, .num_layers = 32,</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"> *       .vocab_size = 32000, .max_seq_len = 2048,</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"> *       .has_bias = 0, .has_rope = 1, .has_pos_embed = 0,</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment"> *       .gated_mlp = 1, .norm_type = 1 }</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"> * };</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment"> * CKModel model = {0};</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"> * size_t total = ck_model_plan(&amp;model, configs, 2, 1, CK_FUSE_NORM_QKV);</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"> * printf(&quot;Total memory: %.2f GB\n&quot;, total / 1e9);</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment"> * ck_model_allocate(&amp;model, 2);  // 1GB hugepages</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"> * // Access vision encoder layer 5 Q weights:</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment"> * float *wq = CK_PTR(&amp;model, CK_LAYER(&amp;model, 0, 5)-&gt;wq);</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment"> * // Access text decoder layer 10 attention output:</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"> * float *attn = CK_PTR(&amp;model, CK_LAYER(&amp;model, 1, 10)-&gt;attn_out);</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment"> * // When done:</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"> * ck_model_free(&amp;model);  // Single free!</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"> * ============================================================================</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CKERNEL_SECTION_LAYOUT_H */</span><span class="preprocessor"></span></div>
<div class="ttc" id="ackernel__section__layout_8h_html_a1098b7df468a5ac5164b440b6e08209f"><div class="ttname"><a href="ckernel__section__layout_8h.html#a1098b7df468a5ac5164b440b6e08209f">ck_model_free</a></div><div class="ttdeci">void ck_model_free(CKModel *model)</div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_a45ba8ddf4f1d6280681d37136dbc3a5a"><div class="ttname"><a href="ckernel__section__layout_8h.html#a45ba8ddf4f1d6280681d37136dbc3a5a">ck_section_config_init</a></div><div class="ttdeci">void ck_section_config_init(CKSectionConfig *config, size_t simd_align)</div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_a7a3e8075d666d342c725cea328322cd2"><div class="ttname"><a href="ckernel__section__layout_8h.html#a7a3e8075d666d342c725cea328322cd2">ck_section_plan</a></div><div class="ttdeci">size_t ck_section_plan(CKSection *section, const CKSectionConfig *config, int training_enabled, size_t base_offset)</div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_a82b72b659b7ce81f24b3f79b101ab6d4"><div class="ttname"><a href="ckernel__section__layout_8h.html#a82b72b659b7ce81f24b3f79b101ab6d4">ck_model_plan</a></div><div class="ttdeci">size_t ck_model_plan(CKModel *model, const CKSectionConfig *configs, int num_sections, int training_enabled, uint32_t fusion_flags)</div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_a8d52ec7a90940748c493c1e6cbb2675e"><div class="ttname"><a href="ckernel__section__layout_8h.html#a8d52ec7a90940748c493c1e6cbb2675e">ck_model_allocate</a></div><div class="ttdeci">int ck_model_allocate(CKModel *model, int hugepage_mode)</div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_aff5ee31d19be80e3bc7d00f0506f8efe"><div class="ttname"><a href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efe">CKFusionFlags</a></div><div class="ttdeci">CKFusionFlags</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00459">ckernel_section_layout.h:459</a></div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_aff5ee31d19be80e3bc7d00f0506f8efea34b104e34a7aa0d0937ad1d8d064f0a9"><div class="ttname"><a href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea34b104e34a7aa0d0937ad1d8d064f0a9">CK_FUSE_NORM_QKV</a></div><div class="ttdeci">@ CK_FUSE_NORM_QKV</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00462">ckernel_section_layout.h:462</a></div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_aff5ee31d19be80e3bc7d00f0506f8efea43848ac20412b3e616a81b53bacb02ce"><div class="ttname"><a href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea43848ac20412b3e616a81b53bacb02ce">CK_FUSE_ATTN_PROJ</a></div><div class="ttdeci">@ CK_FUSE_ATTN_PROJ</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00464">ckernel_section_layout.h:464</a></div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_aff5ee31d19be80e3bc7d00f0506f8efea45bba7ecc02555c097f51c9469157a21"><div class="ttname"><a href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea45bba7ecc02555c097f51c9469157a21">CK_FUSE_EMBED_NORM</a></div><div class="ttdeci">@ CK_FUSE_EMBED_NORM</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00461">ckernel_section_layout.h:461</a></div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_aff5ee31d19be80e3bc7d00f0506f8efea6a3bb26ab9dcc8bb90714a3c77250997"><div class="ttname"><a href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea6a3bb26ab9dcc8bb90714a3c77250997">CK_FUSE_RESIDUAL_NORM</a></div><div class="ttdeci">@ CK_FUSE_RESIDUAL_NORM</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00468">ckernel_section_layout.h:468</a></div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_aff5ee31d19be80e3bc7d00f0506f8efea97e883e02f60415d64767579e4b65eb2"><div class="ttname"><a href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efea97e883e02f60415d64767579e4b65eb2">CK_FUSE_MLP_ACT_DOWN</a></div><div class="ttdeci">@ CK_FUSE_MLP_ACT_DOWN</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00467">ckernel_section_layout.h:467</a></div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_aff5ee31d19be80e3bc7d00f0506f8efeaa4b32bb297017e550a88ca82c0346b02"><div class="ttname"><a href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeaa4b32bb297017e550a88ca82c0346b02">CK_FUSE_MLP_GATE_UP</a></div><div class="ttdeci">@ CK_FUSE_MLP_GATE_UP</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00466">ckernel_section_layout.h:466</a></div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_aff5ee31d19be80e3bc7d00f0506f8efeabdee28d29574a516859ce8a97cdbe959"><div class="ttname"><a href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeabdee28d29574a516859ce8a97cdbe959">CK_FUSE_QKV_ROPE</a></div><div class="ttdeci">@ CK_FUSE_QKV_ROPE</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00463">ckernel_section_layout.h:463</a></div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_aff5ee31d19be80e3bc7d00f0506f8efeac49b63f12bae2e1fb3db203ec6a60fca"><div class="ttname"><a href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeac49b63f12bae2e1fb3db203ec6a60fca">CK_FUSE_NORM_MLP</a></div><div class="ttdeci">@ CK_FUSE_NORM_MLP</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00465">ckernel_section_layout.h:465</a></div></div>
<div class="ttc" id="ackernel__section__layout_8h_html_aff5ee31d19be80e3bc7d00f0506f8efeac701cd87ffd41b651fdb39fd4d9231db"><div class="ttname"><a href="ckernel__section__layout_8h.html#aff5ee31d19be80e3bc7d00f0506f8efeac701cd87ffd41b651fdb39fd4d9231db">CK_FUSE_NONE</a></div><div class="ttdeci">@ CK_FUSE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00460">ckernel_section_layout.h:460</a></div></div>
<div class="ttc" id="astructCKFooterGradOffsets_html"><div class="ttname"><a href="structCKFooterGradOffsets.html">CKFooterGradOffsets</a></div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00357">ckernel_section_layout.h:357</a></div></div>
<div class="ttc" id="astructCKFooterGradOffsets_html_a1033308e389797d86251b87a79781bae"><div class="ttname"><a href="structCKFooterGradOffsets.html#a1033308e389797d86251b87a79781bae">CKFooterGradOffsets::grad_end</a></div><div class="ttdeci">size_t grad_end</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00368">ckernel_section_layout.h:368</a></div></div>
<div class="ttc" id="astructCKFooterGradOffsets_html_a39e8fc85fe6bcd5c1a1fbd7ced054879"><div class="ttname"><a href="structCKFooterGradOffsets.html#a39e8fc85fe6bcd5c1a1fbd7ced054879">CKFooterGradOffsets::d_bridge_b</a></div><div class="ttdeci">size_t d_bridge_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00364">ckernel_section_layout.h:364</a></div></div>
<div class="ttc" id="astructCKFooterGradOffsets_html_a6b4894e65e79da4ec83a9b2b535ef519"><div class="ttname"><a href="structCKFooterGradOffsets.html#a6b4894e65e79da4ec83a9b2b535ef519">CKFooterGradOffsets::d_lm_head_b</a></div><div class="ttdeci">size_t d_lm_head_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00361">ckernel_section_layout.h:361</a></div></div>
<div class="ttc" id="astructCKFooterGradOffsets_html_ac3f2b08b2785cf1fa039bb3c0e6e2197"><div class="ttname"><a href="structCKFooterGradOffsets.html#ac3f2b08b2785cf1fa039bb3c0e6e2197">CKFooterGradOffsets::d_logits</a></div><div class="ttdeci">size_t d_logits</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00362">ckernel_section_layout.h:362</a></div></div>
<div class="ttc" id="astructCKFooterGradOffsets_html_ada3b948a5b678ac0f01d74bf7ab3a8c8"><div class="ttname"><a href="structCKFooterGradOffsets.html#ada3b948a5b678ac0f01d74bf7ab3a8c8">CKFooterGradOffsets::d_final_ln_beta</a></div><div class="ttdeci">size_t d_final_ln_beta</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00358">ckernel_section_layout.h:358</a></div></div>
<div class="ttc" id="astructCKFooterGradOffsets_html_ae2a60b057eaa172d1132474349ad5d40"><div class="ttname"><a href="structCKFooterGradOffsets.html#ae2a60b057eaa172d1132474349ad5d40">CKFooterGradOffsets::d_final_ln_output</a></div><div class="ttdeci">size_t d_final_ln_output</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00359">ckernel_section_layout.h:359</a></div></div>
<div class="ttc" id="astructCKFooterGradOffsets_html_ae6e42eddc33324875a7458f7d804a694"><div class="ttname"><a href="structCKFooterGradOffsets.html#ae6e42eddc33324875a7458f7d804a694">CKFooterGradOffsets::d_bridge_output</a></div><div class="ttdeci">size_t d_bridge_output</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00365">ckernel_section_layout.h:365</a></div></div>
<div class="ttc" id="astructCKFooterGradOffsets_html_ae9169fef93e53c932b9f4728d8cb6e30"><div class="ttname"><a href="structCKFooterGradOffsets.html#ae9169fef93e53c932b9f4728d8cb6e30">CKFooterGradOffsets::grad_start</a></div><div class="ttdeci">size_t grad_start</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00367">ckernel_section_layout.h:367</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html"><div class="ttname"><a href="structCKFooterOffsets.html">CKFooterOffsets</a></div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00331">ckernel_section_layout.h:331</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_a17d1b0599249931fab10aa62ce6b8b20"><div class="ttname"><a href="structCKFooterOffsets.html#a17d1b0599249931fab10aa62ce6b8b20">CKFooterOffsets::footer_end</a></div><div class="ttdeci">size_t footer_end</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00349">ckernel_section_layout.h:349</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_a44484b840457f80b8fa286f5167d1687"><div class="ttname"><a href="structCKFooterOffsets.html#a44484b840457f80b8fa286f5167d1687">CKFooterOffsets::bridge_output</a></div><div class="ttdeci">size_t bridge_output</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00345">ckernel_section_layout.h:345</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_a5a3df48e55198eeebcfba9453881de01"><div class="ttname"><a href="structCKFooterOffsets.html#a5a3df48e55198eeebcfba9453881de01">CKFooterOffsets::bridge_w</a></div><div class="ttdeci">size_t bridge_w</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00343">ckernel_section_layout.h:343</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_a638f017bdaec7d988d89bf2692a48d6b"><div class="ttname"><a href="structCKFooterOffsets.html#a638f017bdaec7d988d89bf2692a48d6b">CKFooterOffsets::logits</a></div><div class="ttdeci">size_t logits</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00340">ckernel_section_layout.h:340</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_a6e968314ca3082225d5fdbeda2c64343"><div class="ttname"><a href="structCKFooterOffsets.html#a6e968314ca3082225d5fdbeda2c64343">CKFooterOffsets::bridge_b</a></div><div class="ttdeci">size_t bridge_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00344">ckernel_section_layout.h:344</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_a8866b0a08fa2195bbb577d5e4a4e12dd"><div class="ttname"><a href="structCKFooterOffsets.html#a8866b0a08fa2195bbb577d5e4a4e12dd">CKFooterOffsets::final_ln_beta</a></div><div class="ttdeci">size_t final_ln_beta</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00334">ckernel_section_layout.h:334</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_a97bbf97af4ac45e5c16437af7842957b"><div class="ttname"><a href="structCKFooterOffsets.html#a97bbf97af4ac45e5c16437af7842957b">CKFooterOffsets::lm_head_b</a></div><div class="ttdeci">size_t lm_head_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00339">ckernel_section_layout.h:339</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_ab297d1de6261098375f31e149519d4d4"><div class="ttname"><a href="structCKFooterOffsets.html#ab297d1de6261098375f31e149519d4d4">CKFooterOffsets::final_ln_output</a></div><div class="ttdeci">size_t final_ln_output</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00335">ckernel_section_layout.h:335</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_ab47cf73ae4b7e7de8cf801fa9ce1dc5c"><div class="ttname"><a href="structCKFooterOffsets.html#ab47cf73ae4b7e7de8cf801fa9ce1dc5c">CKFooterOffsets::final_ln_gamma</a></div><div class="ttdeci">size_t final_ln_gamma</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00333">ckernel_section_layout.h:333</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_ad4256e4d307e8deb6aadc34113d81e90"><div class="ttname"><a href="structCKFooterOffsets.html#ad4256e4d307e8deb6aadc34113d81e90">CKFooterOffsets::lm_head_w</a></div><div class="ttdeci">size_t lm_head_w</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00338">ckernel_section_layout.h:338</a></div></div>
<div class="ttc" id="astructCKFooterOffsets_html_ae734eedf274912ce617fb86c5c14cbf4"><div class="ttname"><a href="structCKFooterOffsets.html#ae734eedf274912ce617fb86c5c14cbf4">CKFooterOffsets::footer_start</a></div><div class="ttdeci">size_t footer_start</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00348">ckernel_section_layout.h:348</a></div></div>
<div class="ttc" id="astructCKHeaderOffsets_html"><div class="ttname"><a href="structCKHeaderOffsets.html">CKHeaderOffsets</a></div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00138">ckernel_section_layout.h:138</a></div></div>
<div class="ttc" id="astructCKHeaderOffsets_html_a09edd285803f7fecfbfe1a80ec241b23"><div class="ttname"><a href="structCKHeaderOffsets.html#a09edd285803f7fecfbfe1a80ec241b23">CKHeaderOffsets::embed_weight</a></div><div class="ttdeci">size_t embed_weight</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00140">ckernel_section_layout.h:140</a></div></div>
<div class="ttc" id="astructCKHeaderOffsets_html_a1c5c78d482920812a8353fe8b31a9038"><div class="ttname"><a href="structCKHeaderOffsets.html#a1c5c78d482920812a8353fe8b31a9038">CKHeaderOffsets::embed_output</a></div><div class="ttdeci">size_t embed_output</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00141">ckernel_section_layout.h:141</a></div></div>
<div class="ttc" id="astructCKHeaderOffsets_html_a2a082e03809f5e60dc469836ec86e553"><div class="ttname"><a href="structCKHeaderOffsets.html#a2a082e03809f5e60dc469836ec86e553">CKHeaderOffsets::pos_embed_output</a></div><div class="ttdeci">size_t pos_embed_output</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00145">ckernel_section_layout.h:145</a></div></div>
<div class="ttc" id="astructCKHeaderOffsets_html_a5869de8e522fdd1b310d75bd8eb849bb"><div class="ttname"><a href="structCKHeaderOffsets.html#a5869de8e522fdd1b310d75bd8eb849bb">CKHeaderOffsets::pos_embed_weight</a></div><div class="ttdeci">size_t pos_embed_weight</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00144">ckernel_section_layout.h:144</a></div></div>
<div class="ttc" id="astructCKHeaderOffsets_html_a8bd89231afd3b0a519c8491e955504df"><div class="ttname"><a href="structCKHeaderOffsets.html#a8bd89231afd3b0a519c8491e955504df">CKHeaderOffsets::header_start</a></div><div class="ttdeci">size_t header_start</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00151">ckernel_section_layout.h:151</a></div></div>
<div class="ttc" id="astructCKHeaderOffsets_html_acb634ce1abbf44e2ee2791e8a1d1817e"><div class="ttname"><a href="structCKHeaderOffsets.html#acb634ce1abbf44e2ee2791e8a1d1817e">CKHeaderOffsets::header_end</a></div><div class="ttdeci">size_t header_end</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00152">ckernel_section_layout.h:152</a></div></div>
<div class="ttc" id="astructCKHeaderOffsets_html_af6277b6a25c2312f49d22592e268dab0"><div class="ttname"><a href="structCKHeaderOffsets.html#af6277b6a25c2312f49d22592e268dab0">CKHeaderOffsets::header_output</a></div><div class="ttdeci">size_t header_output</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00148">ckernel_section_layout.h:148</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html"><div class="ttname"><a href="structCKLayerGradOffsets.html">CKLayerGradOffsets</a></div><div class="ttdef"><b>Definition:</b> <a href="ckernel__memory__layout_8h_source.html#l00152">ckernel_memory_layout.h:152</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_a020b61adaa42a2b67579be3ce01f4d4c"><div class="ttname"><a href="structCKLayerGradOffsets.html#a020b61adaa42a2b67579be3ce01f4d4c">CKLayerGradOffsets::d_mlp_gate_b</a></div><div class="ttdeci">size_t d_mlp_gate_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00279">ckernel_section_layout.h:279</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_a2d059e5b3e882d461ee74d459b54aeae"><div class="ttname"><a href="structCKLayerGradOffsets.html#a2d059e5b3e882d461ee74d459b54aeae">CKLayerGradOffsets::d_attn_probs</a></div><div class="ttdeci">size_t d_attn_probs</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00268">ckernel_section_layout.h:268</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_a40ee9ccba2e0a9b235f9350742fa7c96"><div class="ttname"><a href="structCKLayerGradOffsets.html#a40ee9ccba2e0a9b235f9350742fa7c96">CKLayerGradOffsets::d_residual2</a></div><div class="ttdeci">size_t d_residual2</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00284">ckernel_section_layout.h:284</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_a5383122bbd9bca1d26dc23bca84d3ef3"><div class="ttname"><a href="structCKLayerGradOffsets.html#a5383122bbd9bca1d26dc23bca84d3ef3">CKLayerGradOffsets::d_attn_out</a></div><div class="ttdeci">size_t d_attn_out</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00269">ckernel_section_layout.h:269</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_a6272144a177f1aa0fd8a3ff88a84c88b"><div class="ttname"><a href="structCKLayerGradOffsets.html#a6272144a177f1aa0fd8a3ff88a84c88b">CKLayerGradOffsets::grad_start</a></div><div class="ttdeci">size_t grad_start</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00288">ckernel_section_layout.h:288</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_a8f5b64f6f0b8ce9fcd1264b8638b7082"><div class="ttname"><a href="structCKLayerGradOffsets.html#a8f5b64f6f0b8ce9fcd1264b8638b7082">CKLayerGradOffsets::d_residual1</a></div><div class="ttdeci">size_t d_residual1</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00273">ckernel_section_layout.h:273</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_aa093a6afe597f5b90196549170cb4aab"><div class="ttname"><a href="structCKLayerGradOffsets.html#aa093a6afe597f5b90196549170cb4aab">CKLayerGradOffsets::d_mlp_act_out</a></div><div class="ttdeci">size_t d_mlp_act_out</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00281">ckernel_section_layout.h:281</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_aa70642f467ced05a1ce8e4795c9ec152"><div class="ttname"><a href="structCKLayerGradOffsets.html#aa70642f467ced05a1ce8e4795c9ec152">CKLayerGradOffsets::d_mlp_up_b</a></div><div class="ttdeci">size_t d_mlp_up_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00280">ckernel_section_layout.h:280</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_ab0fdf34b696663ecd2a6adc66dc35e88"><div class="ttname"><a href="structCKLayerGradOffsets.html#ab0fdf34b696663ecd2a6adc66dc35e88">CKLayerGradOffsets::d_mlp_down_b</a></div><div class="ttdeci">size_t d_mlp_down_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00282">ckernel_section_layout.h:282</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_ab39bad6aa2d7b4cdd624e1a3d4b18ca9"><div class="ttname"><a href="structCKLayerGradOffsets.html#ab39bad6aa2d7b4cdd624e1a3d4b18ca9">CKLayerGradOffsets::d_proj_out</a></div><div class="ttdeci">size_t d_proj_out</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00272">ckernel_section_layout.h:272</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_ace7e61f43563a3d22ea91a363aeb5609"><div class="ttname"><a href="structCKLayerGradOffsets.html#ace7e61f43563a3d22ea91a363aeb5609">CKLayerGradOffsets::d_output</a></div><div class="ttdeci">size_t d_output</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00285">ckernel_section_layout.h:285</a></div></div>
<div class="ttc" id="astructCKLayerGradOffsets_html_ad3dcd4463deb7947578383f61a5800d9"><div class="ttname"><a href="structCKLayerGradOffsets.html#ad3dcd4463deb7947578383f61a5800d9">CKLayerGradOffsets::grad_end</a></div><div class="ttdeci">size_t grad_end</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00289">ckernel_section_layout.h:289</a></div></div>
<div class="ttc" id="astructCKLayerOffsets_html"><div class="ttname"><a href="structCKLayerOffsets.html">CKLayerOffsets</a></div><div class="ttdef"><b>Definition:</b> <a href="ckernel__memory__layout_8h_source.html#l00085">ckernel_memory_layout.h:85</a></div></div>
<div class="ttc" id="astructCKLayerOffsets_html_a207b51ce0a5d8afb92fbb3f810ca4574"><div class="ttname"><a href="structCKLayerOffsets.html#a207b51ce0a5d8afb92fbb3f810ca4574">CKLayerOffsets::input</a></div><div class="ttdeci">size_t input</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00168">ckernel_section_layout.h:168</a></div></div>
<div class="ttc" id="astructCKLayerOffsets_html_a253ebe103830f66006e992c1942359c6"><div class="ttname"><a href="structCKLayerOffsets.html#a253ebe103830f66006e992c1942359c6">CKLayerOffsets::output</a></div><div class="ttdeci">size_t output</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00240">ckernel_section_layout.h:240</a></div></div>
<div class="ttc" id="astructCKLayerOffsets_html_a6f26daba0ff5fda605b9a751ac2ba2ee"><div class="ttname"><a href="structCKLayerOffsets.html#a6f26daba0ff5fda605b9a751ac2ba2ee">CKLayerOffsets::attn_out</a></div><div class="ttdeci">size_t attn_out</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00201">ckernel_section_layout.h:201</a></div></div>
<div class="ttc" id="astructCKLayerOffsets_html_a968c7ab2fdc25c0e8bf2b98d12b79687"><div class="ttname"><a href="structCKLayerOffsets.html#a968c7ab2fdc25c0e8bf2b98d12b79687">CKLayerOffsets::layer_end</a></div><div class="ttdeci">size_t layer_end</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00248">ckernel_section_layout.h:248</a></div></div>
<div class="ttc" id="astructCKLayerOffsets_html_ace63bf4c6c97434a4fa90d2f765cf96f"><div class="ttname"><a href="structCKLayerOffsets.html#ace63bf4c6c97434a4fa90d2f765cf96f">CKLayerOffsets::layer_start</a></div><div class="ttdeci">size_t layer_start</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00247">ckernel_section_layout.h:247</a></div></div>
<div class="ttc" id="astructCKLayerOffsets_html_ad4bc2b7cea35add011aa22e48f10f99c"><div class="ttname"><a href="structCKLayerOffsets.html#ad4bc2b7cea35add011aa22e48f10f99c">CKLayerOffsets::proj_out</a></div><div class="ttdeci">size_t proj_out</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00206">ckernel_section_layout.h:206</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html">CKLayerOptimizerOffsets</a></div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00297">ckernel_section_layout.h:297</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a1bea81a97d9e230388a11aa88fcfaab8"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a1bea81a97d9e230388a11aa88fcfaab8">CKLayerOptimizerOffsets::v_bk</a></div><div class="ttdeci">size_t v_bk</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00309">ckernel_section_layout.h:309</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a205ea40a57d44759dce23b92ce8a853f"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a205ea40a57d44759dce23b92ce8a853f">CKLayerOptimizerOffsets::v_ln2_beta</a></div><div class="ttdeci">size_t v_ln2_beta</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00311">ckernel_section_layout.h:311</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a2b7d74bd97a70cc3ef67619b1090f5f1"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a2b7d74bd97a70cc3ef67619b1090f5f1">CKLayerOptimizerOffsets::v_mlp_gate_b</a></div><div class="ttdeci">size_t v_mlp_gate_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00312">ckernel_section_layout.h:312</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a33e61c51c31c2fa53bbf9f4a42a6acb4"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a33e61c51c31c2fa53bbf9f4a42a6acb4">CKLayerOptimizerOffsets::m_ln1_beta</a></div><div class="ttdeci">size_t m_ln1_beta</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00299">ckernel_section_layout.h:299</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a34a29c9146fdacaa56a6118fa684fa86"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a34a29c9146fdacaa56a6118fa684fa86">CKLayerOptimizerOffsets::m_mlp_down_b</a></div><div class="ttdeci">size_t m_mlp_down_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00305">ckernel_section_layout.h:305</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a3cf63cde129a1b236bdad073b670c502"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a3cf63cde129a1b236bdad073b670c502">CKLayerOptimizerOffsets::m_bk</a></div><div class="ttdeci">size_t m_bk</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00300">ckernel_section_layout.h:300</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a3f6bc539802d8836399a9bc58b64880f"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a3f6bc539802d8836399a9bc58b64880f">CKLayerOptimizerOffsets::m_mlp_gate_b</a></div><div class="ttdeci">size_t m_mlp_gate_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00303">ckernel_section_layout.h:303</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a64ed5b2a6e204efd8d40429fd9700744"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a64ed5b2a6e204efd8d40429fd9700744">CKLayerOptimizerOffsets::v_bo</a></div><div class="ttdeci">size_t v_bo</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00310">ckernel_section_layout.h:310</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a768c2644e129903d370b4010d37c74eb"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a768c2644e129903d370b4010d37c74eb">CKLayerOptimizerOffsets::opt_start</a></div><div class="ttdeci">size_t opt_start</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00317">ckernel_section_layout.h:317</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a7bafeba33b123654fbd253bbdded7bd6"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a7bafeba33b123654fbd253bbdded7bd6">CKLayerOptimizerOffsets::v_mlp_up_b</a></div><div class="ttdeci">size_t v_mlp_up_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00313">ckernel_section_layout.h:313</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a7cd21b2bb571c27da41ab7cd5c452b7f"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a7cd21b2bb571c27da41ab7cd5c452b7f">CKLayerOptimizerOffsets::v_mlp_down_b</a></div><div class="ttdeci">size_t v_mlp_down_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00314">ckernel_section_layout.h:314</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a821ddf375173a7d11f8694c177a63d93"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a821ddf375173a7d11f8694c177a63d93">CKLayerOptimizerOffsets::m_ln2_beta</a></div><div class="ttdeci">size_t m_ln2_beta</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00302">ckernel_section_layout.h:302</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_a9dec06808a0e417685225e98d95ff37a"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#a9dec06808a0e417685225e98d95ff37a">CKLayerOptimizerOffsets::m_mlp_up_b</a></div><div class="ttdeci">size_t m_mlp_up_b</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00304">ckernel_section_layout.h:304</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_aa562f5efd6173858cf43d57551e53a34"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#aa562f5efd6173858cf43d57551e53a34">CKLayerOptimizerOffsets::m_bo</a></div><div class="ttdeci">size_t m_bo</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00301">ckernel_section_layout.h:301</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_ac4940fcc8708472a83f4622f033ebbb6"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#ac4940fcc8708472a83f4622f033ebbb6">CKLayerOptimizerOffsets::opt_end</a></div><div class="ttdeci">size_t opt_end</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00318">ckernel_section_layout.h:318</a></div></div>
<div class="ttc" id="astructCKLayerOptimizerOffsets_html_acd7cb9443cff2872dc2fa0c6b6b159a6"><div class="ttname"><a href="structCKLayerOptimizerOffsets.html#acd7cb9443cff2872dc2fa0c6b6b159a6">CKLayerOptimizerOffsets::v_ln1_beta</a></div><div class="ttdeci">size_t v_ln1_beta</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00308">ckernel_section_layout.h:308</a></div></div>
<div class="ttc" id="astructCKModel_html"><div class="ttname"><a href="structCKModel.html">CKModel</a></div><div class="ttdef"><b>Definition:</b> <a href="ckernel__memory__layout_8h_source.html#l00236">ckernel_memory_layout.h:236</a></div></div>
<div class="ttc" id="astructCKModel_html_a23c5fb291d06cc7cbe7aa8bc2a07b06b"><div class="ttname"><a href="structCKModel.html#a23c5fb291d06cc7cbe7aa8bc2a07b06b">CKModel::shared_scratch</a></div><div class="ttdeci">size_t shared_scratch</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00434">ckernel_section_layout.h:434</a></div></div>
<div class="ttc" id="astructCKModel_html_a2a35dbca7a62e3ebe14b6c502c68f2aa"><div class="ttname"><a href="structCKModel.html#a2a35dbca7a62e3ebe14b6c502c68f2aa">CKModel::num_numa_nodes</a></div><div class="ttdeci">int num_numa_nodes</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00447">ckernel_section_layout.h:447</a></div></div>
<div class="ttc" id="astructCKModel_html_a30077b979aff326f5c4bd20da8b6d807"><div class="ttname"><a href="structCKModel.html#a30077b979aff326f5c4bd20da8b6d807">CKModel::kv_cache_enabled</a></div><div class="ttdeci">int kv_cache_enabled</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00439">ckernel_section_layout.h:439</a></div></div>
<div class="ttc" id="astructCKModel_html_a4f3d9a363a8fc7d37556b33e6b20cd69"><div class="ttname"><a href="structCKModel.html#a4f3d9a363a8fc7d37556b33e6b20cd69">CKModel::opt_bytes</a></div><div class="ttdeci">size_t opt_bytes</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00427">ckernel_section_layout.h:427</a></div></div>
<div class="ttc" id="astructCKModel_html_a84832de4929055025d6634e18ceae38a"><div class="ttname"><a href="structCKModel.html#a84832de4929055025d6634e18ceae38a">CKModel::training_enabled</a></div><div class="ttdeci">int training_enabled</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00438">ckernel_section_layout.h:438</a></div></div>
<div class="ttc" id="astructCKModel_html_a9122ea9b37528516af41eb29c237838f"><div class="ttname"><a href="structCKModel.html#a9122ea9b37528516af41eb29c237838f">CKModel::hugepage_size</a></div><div class="ttdeci">size_t hugepage_size</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00448">ckernel_section_layout.h:448</a></div></div>
<div class="ttc" id="astructCKModel_html_a9b0ad93300ab3b15395daf0d8e720f4d"><div class="ttname"><a href="structCKModel.html#a9b0ad93300ab3b15395daf0d8e720f4d">CKModel::current_pos</a></div><div class="ttdeci">int current_pos</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00444">ckernel_section_layout.h:444</a></div></div>
<div class="ttc" id="astructCKModel_html_afdaa49dc294acb37ed54a2708b6bc8e0"><div class="ttname"><a href="structCKModel.html#afdaa49dc294acb37ed54a2708b6bc8e0">CKModel::shared_scratch_bytes</a></div><div class="ttdeci">size_t shared_scratch_bytes</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00435">ckernel_section_layout.h:435</a></div></div>
<div class="ttc" id="astructCKSectionConfig_html"><div class="ttname"><a href="structCKSectionConfig.html">CKSectionConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="ckernel__memory__layout_8h_source.html#l00060">ckernel_memory_layout.h:60</a></div></div>
<div class="ttc" id="astructCKSectionConfig_html_a3348e1ea8c54d4e25647daa3685da89a"><div class="ttname"><a href="structCKSectionConfig.html#a3348e1ea8c54d4e25647daa3685da89a">CKSectionConfig::gated_mlp</a></div><div class="ttdeci">int gated_mlp</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00124">ckernel_section_layout.h:124</a></div></div>
<div class="ttc" id="astructCKSectionConfig_html_a4022d24bbcdac19db5fa032e6f02480f"><div class="ttname"><a href="structCKSectionConfig.html#a4022d24bbcdac19db5fa032e6f02480f">CKSectionConfig::has_rope</a></div><div class="ttdeci">int has_rope</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00122">ckernel_section_layout.h:122</a></div></div>
<div class="ttc" id="astructCKSectionConfig_html_a42f1619a5ca0b7dbee3506ab18f994e5"><div class="ttname"><a href="structCKSectionConfig.html#a42f1619a5ca0b7dbee3506ab18f994e5">CKSectionConfig::has_bias</a></div><div class="ttdeci">int has_bias</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00121">ckernel_section_layout.h:121</a></div></div>
<div class="ttc" id="astructCKSectionConfig_html_a5309473074acf80aeb6e9ac8ec68bbc8"><div class="ttname"><a href="structCKSectionConfig.html#a5309473074acf80aeb6e9ac8ec68bbc8">CKSectionConfig::has_pos_embed</a></div><div class="ttdeci">int has_pos_embed</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00123">ckernel_section_layout.h:123</a></div></div>
<div class="ttc" id="astructCKSectionConfig_html_a96ef28b42bf7654f3eeb5167950f31e9"><div class="ttname"><a href="structCKSectionConfig.html#a96ef28b42bf7654f3eeb5167950f31e9">CKSectionConfig::norm_type</a></div><div class="ttdeci">int norm_type</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00125">ckernel_section_layout.h:125</a></div></div>
<div class="ttc" id="astructCKSection_html"><div class="ttname"><a href="structCKSection.html">CKSection</a></div><div class="ttdef"><b>Definition:</b> <a href="ckernel__memory__layout_8h_source.html#l00197">ckernel_memory_layout.h:197</a></div></div>
<div class="ttc" id="astructCKSection_html_a0c37521cc2163ed38a4d65ff9ce2f381"><div class="ttname"><a href="structCKSection.html#a0c37521cc2163ed38a4d65ff9ce2f381">CKSection::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00381">ckernel_section_layout.h:381</a></div></div>
<div class="ttc" id="astructCKSection_html_a117cf20f51a6d9d22c18fad061fde15f"><div class="ttname"><a href="structCKSection.html#a117cf20f51a6d9d22c18fad061fde15f">CKSection::rope_sin</a></div><div class="ttdeci">size_t rope_sin</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00399">ckernel_section_layout.h:399</a></div></div>
<div class="ttc" id="astructCKSection_html_a50088bc199e240759c6402920180e469"><div class="ttname"><a href="structCKSection.html#a50088bc199e240759c6402920180e469">CKSection::section_weight_bytes</a></div><div class="ttdeci">size_t section_weight_bytes</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00405">ckernel_section_layout.h:405</a></div></div>
<div class="ttc" id="astructCKSection_html_a54f5ffde9d9968d1f3b928dc54bbd439"><div class="ttname"><a href="structCKSection.html#a54f5ffde9d9968d1f3b928dc54bbd439">CKSection::rope_cos</a></div><div class="ttdeci">size_t rope_cos</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00398">ckernel_section_layout.h:398</a></div></div>
<div class="ttc" id="astructCKSection_html_a74a02e21d1d89af4a3f64c236b5595d7"><div class="ttname"><a href="structCKSection.html#a74a02e21d1d89af4a3f64c236b5595d7">CKSection::causal_mask</a></div><div class="ttdeci">size_t causal_mask</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00400">ckernel_section_layout.h:400</a></div></div>
<div class="ttc" id="astructCKSection_html_a77177dc1f5d94b91942e9dd199556661"><div class="ttname"><a href="structCKSection.html#a77177dc1f5d94b91942e9dd199556661">CKSection::layer_opt</a></div><div class="ttdeci">CKLayerOptimizerOffsets * layer_opt</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00391">ckernel_section_layout.h:391</a></div></div>
<div class="ttc" id="astructCKSection_html_aa030a13ebf6b121d19344e0249786fb8"><div class="ttname"><a href="structCKSection.html#aa030a13ebf6b121d19344e0249786fb8">CKSection::footer</a></div><div class="ttdeci">CKFooterOffsets footer</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00394">ckernel_section_layout.h:394</a></div></div>
<div class="ttc" id="astructCKSection_html_aa21574168860ae278245951028df3ff0"><div class="ttname"><a href="structCKSection.html#aa21574168860ae278245951028df3ff0">CKSection::section_activation_bytes</a></div><div class="ttdeci">size_t section_activation_bytes</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00406">ckernel_section_layout.h:406</a></div></div>
<div class="ttc" id="astructCKSection_html_aaf13683953b54b12a83a90251eb6a881"><div class="ttname"><a href="structCKSection.html#aaf13683953b54b12a83a90251eb6a881">CKSection::section_id</a></div><div class="ttdeci">int section_id</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00382">ckernel_section_layout.h:382</a></div></div>
<div class="ttc" id="astructCKSection_html_abd9ca87b9ad74cd97d0096872749fbc8"><div class="ttname"><a href="structCKSection.html#abd9ca87b9ad74cd97d0096872749fbc8">CKSection::section_opt_bytes</a></div><div class="ttdeci">size_t section_opt_bytes</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00408">ckernel_section_layout.h:408</a></div></div>
<div class="ttc" id="astructCKSection_html_acd76a9f347cf9d4551e7c7cd33ca8f30"><div class="ttname"><a href="structCKSection.html#acd76a9f347cf9d4551e7c7cd33ca8f30">CKSection::layer_grads</a></div><div class="ttdeci">CKLayerGradOffsets * layer_grads</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00390">ckernel_section_layout.h:390</a></div></div>
<div class="ttc" id="astructCKSection_html_adafbb43b1edb42a0adb1b97311b601a4"><div class="ttname"><a href="structCKSection.html#adafbb43b1edb42a0adb1b97311b601a4">CKSection::header</a></div><div class="ttdeci">CKHeaderOffsets header</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00385">ckernel_section_layout.h:385</a></div></div>
<div class="ttc" id="astructCKSection_html_aeb788d634d43d321c22d52573318692f"><div class="ttname"><a href="structCKSection.html#aeb788d634d43d321c22d52573318692f">CKSection::footer_grads</a></div><div class="ttdeci">CKFooterGradOffsets footer_grads</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00395">ckernel_section_layout.h:395</a></div></div>
<div class="ttc" id="astructCKSection_html_aeea1efa805610505363a8dbe6d734282"><div class="ttname"><a href="structCKSection.html#aeea1efa805610505363a8dbe6d734282">CKSection::section_grad_bytes</a></div><div class="ttdeci">size_t section_grad_bytes</div><div class="ttdef"><b>Definition:</b> <a href="ckernel__section__layout_8h_source.html#l00407">ckernel_section_layout.h:407</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="ckernel__section__layout_8h.html">ckernel_section_layout.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
