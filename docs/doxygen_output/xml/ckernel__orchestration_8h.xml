<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="ckernel__orchestration_8h" kind="file" language="C++">
    <compoundname>ckernel_orchestration.h</compoundname>
    <includes local="no">stddef.h</includes>
    <includes refid="ckernel__dtype_8h" local="yes">ckernel_dtype.h</includes>
    <includedby refid="ckernel__orchestration_8c" local="yes">ckernel_orchestration.c</includedby>
    <includedby refid="attention__decode__fused_8c" local="yes">attention_decode_fused.c</includedby>
    <incdepgraph>
      <node id="3">
        <label>ckernel_dtype.h</label>
        <link refid="ckernel__dtype_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>stdint.h</label>
      </node>
      <node id="2">
        <label>stddef.h</label>
      </node>
      <node id="1">
        <label>ckernel_orchestration.h</label>
        <link refid="ckernel__orchestration_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="3">
        <label>attention_decode_fused.c</label>
        <link refid="attention__decode__fused_8c"/>
      </node>
      <node id="2">
        <label>ckernel_orchestration.c</label>
        <link refid="ckernel__orchestration_8c"/>
      </node>
      <node id="1">
        <label>ckernel_orchestration.h</label>
        <link refid="ckernel__orchestration_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
    </invincdepgraph>
    <innerclass refid="structCKLayerBackwardParams" prot="public">CKLayerBackwardParams</innerclass>
    <innerclass refid="structCKLayerForwardParams" prot="public">CKLayerForwardParams</innerclass>
    <innerclass refid="structCKLayerForwardParamsQ4K" prot="public">CKLayerForwardParamsQ4K</innerclass>
      <sectiondef kind="func">
      <memberdef kind="function" id="ckernel__orchestration_8h_1a2afc01d06448f40b94c48a51a6951dc5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_attention_project_head_major</definition>
        <argsstring>(const float *attn_out, const float *wo, const float *bo, float *out, float *scratch, int tokens, int aligned_embed_dim, int num_heads, int aligned_head_dim)</argsstring>
        <name>ck_attention_project_head_major</name>
        <param>
          <type>const float *</type>
          <declname>attn_out</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wo</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bo</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>out</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>scratch</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="174" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="483" bodyend="516" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="174" declcolumn="6"/>
        <references refid="ckernel__orchestration_8c_1a0020aef4ce512b3840b824a46e206dca" compoundref="ckernel__orchestration_8c" startline="472" endline="481">ck_add_inplace</references>
        <references refid="ckernel__engine_8h_1af4f0e756d3ac00b45ce2c7a296b61ae3" compoundref="gemm__kernels_8c" startline="642" endline="733">gemm_blocked_serial</references>
        <referencedby refid="ckernel__orchestration_8c_1a107109f43bf909569b9ab2dd75bffb18" compoundref="ckernel__orchestration_8c" startline="289" endline="345">ck_attention_project_head_major_quant</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1ab7dfa86e5bb0d80f0e346f85e870cb1d" compoundref="ckernel__orchestration_8c" startline="749" endline="854">ck_layer_forward_rmsnorm_swiglu</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1add4c3ac196a25f481496bf69f32a9ac6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_attention_project_head_major_backward</definition>
        <argsstring>(const float *d_out, const float *attn_out, const float *wo, float *d_attn_out, float *d_wo, float *d_bo, int tokens, int aligned_embed_dim, int num_heads, int aligned_head_dim)</argsstring>
        <name>ck_attention_project_head_major_backward</name>
        <param>
          <type>const float *</type>
          <declname>d_out</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>attn_out</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wo</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_attn_out</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_wo</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_bo</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="351" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="553" bodyend="607" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="351" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1a89a29fc853aae0baf9f6094fee52562a" compoundref="mlp__kernels_8c" startline="99" endline="137">fc2_backward_kernel</references>
        <referencedby refid="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" compoundref="ckernel__orchestration_8c" startline="2410" endline="2550">ck_layer_backward_rmsnorm_swiglu</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1ade31f5d0f381b108e331db103adc6251" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_attention_project_head_major_decode_token</definition>
        <argsstring>(const float *attn_token, const float *wo, const float *bo, float *out_token, int embed_dim, int aligned_embed_dim, int num_heads, int aligned_head_dim)</argsstring>
        <name>ck_attention_project_head_major_decode_token</name>
        <param>
          <type>const float *</type>
          <declname>attn_token</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wo</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bo</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>out_token</declname>
        </param>
        <param>
          <type>int</type>
          <declname>embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="184" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_decode_fused.c" bodystart="99" bodyend="125" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="184" declcolumn="6"/>
        <references refid="attention__decode__fused_8c_1a481d5a4d4ee37e40f432109b3873bc05" compoundref="attention__decode__fused_8c" startline="25" endline="60">ck_dot_f32</references>
        <referencedby refid="ckernel__orchestration_8h_1a745d032ebb518826e284b4a3680a8cb5" compoundref="ckernel__orchestration_8c" startline="1040" endline="1196">ck_layer_forward_rmsnorm_swiglu_decode</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1ab8d674c4a63b69a0cc0b38bbe58fa9f2" compoundref="ckernel__orchestration_8c" startline="1198" endline="1349">ck_layer_forward_rmsnorm_swiglu_decode_fused</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1ae07680f1a438bd1824fa4b1c3e4e826e" compoundref="ckernel__orchestration_8c" startline="2238" endline="2408">ck_layer_forward_rmsnorm_swiglu_decode_quant</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_backward_rmsnorm_swiglu</definition>
        <argsstring>(const CKLayerBackwardParams *p)</argsstring>
        <name>ck_layer_backward_rmsnorm_swiglu</name>
        <param>
          <type>const <ref refid="structCKLayerBackwardParams" kindref="compound">CKLayerBackwardParams</ref> *</type>
          <declname>p</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="387" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="2410" bodyend="2550" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="387" declcolumn="6"/>
        <references refid="structCKLayerBackwardParams_1abb77f11b42f7a8c458ff3930de775b69" compoundref="ckernel__orchestration_8h" startline="73">CKLayerBackwardParams::aligned_context_window</references>
        <references refid="structCKLayerBackwardParams_1add2ab7c4a1a702cabb893466e5d7803f" compoundref="ckernel__orchestration_8h" startline="68">CKLayerBackwardParams::aligned_embed_dim</references>
        <references refid="structCKLayerBackwardParams_1ae589cf1fe9b8972084f31ac77c0bb5f1" compoundref="ckernel__orchestration_8h" startline="72">CKLayerBackwardParams::aligned_head_dim</references>
        <references refid="structCKLayerBackwardParams_1ac8540356f4968d0d96310f98fa42be26" compoundref="ckernel__orchestration_8h" startline="75">CKLayerBackwardParams::aligned_intermediate_dim</references>
        <references refid="ckernel__engine_8h_1adbd2b55fbc53b6e288c98813b61cd6e3" compoundref="attention__kernels_8c" startline="942" endline="1068">attention_backward_causal_head_major_gqa</references>
        <references refid="structCKLayerBackwardParams_1ab5ce33fe414d678705eb03372371d68d" compoundref="ckernel__orchestration_8h" startline="109">CKLayerBackwardParams::attn_out</references>
        <references refid="structCKLayerBackwardParams_1a387bfd944836cbc49baf13b1761246aa" compoundref="ckernel__orchestration_8h" startline="93">CKLayerBackwardParams::bk</references>
        <references refid="structCKLayerBackwardParams_1a83064b5cc6decef3782fd31cdaee55d0" compoundref="ckernel__orchestration_8h" startline="91">CKLayerBackwardParams::bq</references>
        <references refid="structCKLayerBackwardParams_1a0a43398737b3990bce0677aedddd310c" compoundref="ckernel__orchestration_8h" startline="95">CKLayerBackwardParams::bv</references>
        <references refid="ckernel__orchestration_8c_1a0020aef4ce512b3840b824a46e206dca" compoundref="ckernel__orchestration_8c" startline="472" endline="481">ck_add_inplace</references>
        <references refid="ckernel__orchestration_8c_1add4c3ac196a25f481496bf69f32a9ac6" compoundref="ckernel__orchestration_8c" startline="553" endline="607">ck_attention_project_head_major_backward</references>
        <references refid="ckernel__orchestration_8c_1aae6b6e1796c190320ef20f0476dc2e9d" compoundref="ckernel__orchestration_8c" startline="609" endline="703">ck_qkv_project_head_major_backward</references>
        <references refid="ckernel__orchestration_8c_1a35426895690beefd7b84cf090639b169" compoundref="ckernel__orchestration_8c" startline="27" endline="42">ck_residual_add_backward</references>
        <references refid="structCKLayerBackwardParams_1a264bf54cc410085d63f127ebe4f46807" compoundref="ckernel__orchestration_8h" startline="136">CKLayerBackwardParams::d_attn_out</references>
        <references refid="structCKLayerBackwardParams_1ab9197d7470ebe9fbde84c93ce8742329" compoundref="ckernel__orchestration_8h" startline="127">CKLayerBackwardParams::d_b1</references>
        <references refid="structCKLayerBackwardParams_1a85571728b71c401e0dbe808ae585ded8" compoundref="ckernel__orchestration_8h" startline="129">CKLayerBackwardParams::d_b2</references>
        <references refid="structCKLayerBackwardParams_1ac904f8f7dce8dc759c7ed6c74120c4ab" compoundref="ckernel__orchestration_8h" startline="121">CKLayerBackwardParams::d_bk</references>
        <references refid="structCKLayerBackwardParams_1ac950096c67ae2bec22dcfe00860b78f3" compoundref="ckernel__orchestration_8h" startline="125">CKLayerBackwardParams::d_bo</references>
        <references refid="structCKLayerBackwardParams_1a9ecf421cb2e1e6ade5e1da91a64ab9f7" compoundref="ckernel__orchestration_8h" startline="119">CKLayerBackwardParams::d_bq</references>
        <references refid="structCKLayerBackwardParams_1ac86c1ddbe5f27c2a0887211e95e8c3f3" compoundref="ckernel__orchestration_8h" startline="123">CKLayerBackwardParams::d_bv</references>
        <references refid="structCKLayerBackwardParams_1ac6168273eb256fd282bbbe9d56d80665" compoundref="ckernel__orchestration_8h" startline="140">CKLayerBackwardParams::d_fc1_out</references>
        <references refid="structCKLayerBackwardParams_1a023a1e75829f8f420e35838f7384c3a3" compoundref="ckernel__orchestration_8h" startline="115">CKLayerBackwardParams::d_input</references>
        <references refid="structCKLayerBackwardParams_1a773d205b160c60d1f00e22f305b17b01" compoundref="ckernel__orchestration_8h" startline="133">CKLayerBackwardParams::d_k</references>
        <references refid="structCKLayerBackwardParams_1a6471df0d3010d3f2abb0c0b4db7c5d97" compoundref="ckernel__orchestration_8h" startline="116">CKLayerBackwardParams::d_ln1_gamma</references>
        <references refid="structCKLayerBackwardParams_1a2409b471e94658eb4c0e54235cb32556" compoundref="ckernel__orchestration_8h" startline="131">CKLayerBackwardParams::d_ln1_out</references>
        <references refid="structCKLayerBackwardParams_1ac5c0b3c38578ab234b991272a6a60cb2" compoundref="ckernel__orchestration_8h" startline="117">CKLayerBackwardParams::d_ln2_gamma</references>
        <references refid="structCKLayerBackwardParams_1ac7774ba926f53b73bb48dd32516b5203" compoundref="ckernel__orchestration_8h" startline="139">CKLayerBackwardParams::d_ln2_out</references>
        <references refid="structCKLayerBackwardParams_1aabe923efab694bfed90a3d86084c9be9" compoundref="ckernel__orchestration_8h" startline="142">CKLayerBackwardParams::d_mlp_out</references>
        <references refid="structCKLayerBackwardParams_1acdca6a8b98874d780004cf7c2649a15b" compoundref="ckernel__orchestration_8h" startline="114">CKLayerBackwardParams::d_output</references>
        <references refid="structCKLayerBackwardParams_1a3de5fdb762dc1589913133f378a46749" compoundref="ckernel__orchestration_8h" startline="137">CKLayerBackwardParams::d_proj_tmp</references>
        <references refid="structCKLayerBackwardParams_1a65b03d62d559a5ed23691be213b88e80" compoundref="ckernel__orchestration_8h" startline="132">CKLayerBackwardParams::d_q</references>
        <references refid="structCKLayerBackwardParams_1a3e6cdebb8a31c2e082fb96e46e51ca54" compoundref="ckernel__orchestration_8h" startline="138">CKLayerBackwardParams::d_residual1</references>
        <references refid="structCKLayerBackwardParams_1af47c65e499530a8b3ece76388b824eed" compoundref="ckernel__orchestration_8h" startline="135">CKLayerBackwardParams::d_scores</references>
        <references refid="structCKLayerBackwardParams_1ad6bb7e7d63201723843d2eeba8139147" compoundref="ckernel__orchestration_8h" startline="141">CKLayerBackwardParams::d_swiglu_out</references>
        <references refid="structCKLayerBackwardParams_1ab7e86eac04fcbcea49e83068a69ba7e2" compoundref="ckernel__orchestration_8h" startline="134">CKLayerBackwardParams::d_v</references>
        <references refid="structCKLayerBackwardParams_1a593dcdffe03ddd257ef56208f28aba2d" compoundref="ckernel__orchestration_8h" startline="126">CKLayerBackwardParams::d_w1</references>
        <references refid="structCKLayerBackwardParams_1a716fb04babf520cbecee5e1030636a1c" compoundref="ckernel__orchestration_8h" startline="128">CKLayerBackwardParams::d_w2</references>
        <references refid="structCKLayerBackwardParams_1ab5dbe28da979dc3ec573683f5db4abd2" compoundref="ckernel__orchestration_8h" startline="120">CKLayerBackwardParams::d_wk</references>
        <references refid="structCKLayerBackwardParams_1ad4813897637ed9497986bed56ee92642" compoundref="ckernel__orchestration_8h" startline="124">CKLayerBackwardParams::d_wo</references>
        <references refid="structCKLayerBackwardParams_1a5edd5b7050aad7e44c041ee40a0783ff" compoundref="ckernel__orchestration_8h" startline="118">CKLayerBackwardParams::d_wq</references>
        <references refid="structCKLayerBackwardParams_1a22e6960a2e5ea95a909e825f18d70224" compoundref="ckernel__orchestration_8h" startline="122">CKLayerBackwardParams::d_wv</references>
        <references refid="structCKLayerBackwardParams_1a0febb76bba354013a9f7c651010c11bf" compoundref="ckernel__orchestration_8h" startline="67">CKLayerBackwardParams::embed_dim</references>
        <references refid="ckernel__engine_8h_1a73e088d0e2388c78920e8fc99b0c3846" compoundref="mlp__kernels_8c" startline="148" endline="184">fc1_backward_kernel</references>
        <references refid="structCKLayerBackwardParams_1ab659147877d0b736b1487b6f74a16bc4" compoundref="ckernel__orchestration_8h" startline="111">CKLayerBackwardParams::fc1_out</references>
        <references refid="ckernel__engine_8h_1a89a29fc853aae0baf9f6094fee52562a" compoundref="mlp__kernels_8c" startline="99" endline="137">fc2_backward_kernel</references>
        <references refid="structCKLayerBackwardParams_1ace4e73b166d2b71dba81099ff55f9c5f" compoundref="ckernel__orchestration_8h" startline="71">CKLayerBackwardParams::head_dim</references>
        <references refid="structCKLayerBackwardParams_1ac93a8ba8f46764f67690abf1991f1bf8" compoundref="ckernel__orchestration_8h" startline="79">CKLayerBackwardParams::input</references>
        <references refid="structCKLayerBackwardParams_1a7cf0c367613e3e8b9985c92916c15d7e" compoundref="ckernel__orchestration_8h" startline="106">CKLayerBackwardParams::k</references>
        <references refid="structCKLayerBackwardParams_1aae3da518cc5f67a49d2d1d332f6fb620" compoundref="ckernel__orchestration_8h" startline="80">CKLayerBackwardParams::ln1_gamma</references>
        <references refid="structCKLayerBackwardParams_1aa9203c2951372bedee83fd38e3ef57fb" compoundref="ckernel__orchestration_8h" startline="82">CKLayerBackwardParams::ln1_out</references>
        <references refid="structCKLayerBackwardParams_1a8b0ad57a979f51ad0b14df175b2c7370" compoundref="ckernel__orchestration_8h" startline="83">CKLayerBackwardParams::ln1_rstd</references>
        <references refid="structCKLayerBackwardParams_1a888ee7a6df98528c4046b6b59b8c639c" compoundref="ckernel__orchestration_8h" startline="81">CKLayerBackwardParams::ln2_gamma</references>
        <references refid="structCKLayerBackwardParams_1a5e38a1d2f02842dae26099775995852c" compoundref="ckernel__orchestration_8h" startline="84">CKLayerBackwardParams::ln2_out</references>
        <references refid="structCKLayerBackwardParams_1a44e7ba32918b0db85c2ddafee1b60848" compoundref="ckernel__orchestration_8h" startline="85">CKLayerBackwardParams::ln2_rstd</references>
        <references refid="structCKLayerBackwardParams_1a763a742b7a501fec6ff59e1237b7bec4" compoundref="ckernel__orchestration_8h" startline="69">CKLayerBackwardParams::num_heads</references>
        <references refid="structCKLayerBackwardParams_1afb6c0da50e07fdc05e2ad5c3e160f388" compoundref="ckernel__orchestration_8h" startline="70">CKLayerBackwardParams::num_kv_heads</references>
        <references refid="structCKLayerBackwardParams_1aab3a0f3828a687d937a07f74131b2a3f" compoundref="ckernel__orchestration_8h" startline="105">CKLayerBackwardParams::q</references>
        <references refid="structCKLayerBackwardParams_1abb44b9dbf412823c5d1dc2a426b68d53" compoundref="ckernel__orchestration_8h" startline="110">CKLayerBackwardParams::residual1</references>
        <references refid="ckernel__engine_8h_1aca68d7dda1a7de9ff926920804751db0" compoundref="rmsnorm__kernels_8c" startline="157" endline="339">rmsnorm_backward</references>
        <references refid="ckernel__engine_8h_1a42fa03f293de94c5422681ada891a24f" compoundref="rope__kernels_8c" startline="391" endline="406">rope_backward_qk</references>
        <references refid="structCKLayerBackwardParams_1ac9983bf5c0f086d19bce3889e2abfbe8" compoundref="ckernel__orchestration_8h" startline="87">CKLayerBackwardParams::rope_cos</references>
        <references refid="structCKLayerBackwardParams_1ab177ccef441842dede3cb9717e4deff5" compoundref="ckernel__orchestration_8h" startline="77">CKLayerBackwardParams::rope_pos_offset</references>
        <references refid="structCKLayerBackwardParams_1af26bc4e2d6770ac37e07395a26c38993" compoundref="ckernel__orchestration_8h" startline="88">CKLayerBackwardParams::rope_sin</references>
        <references refid="structCKLayerBackwardParams_1a9e4a1e13e1a03430dfb1d4c35137a0c3" compoundref="ckernel__orchestration_8h" startline="108">CKLayerBackwardParams::scores</references>
        <references refid="ckernel__engine_8h_1a2d1ada314dda9d7788371a08067917d6" compoundref="swiglu__kernels_8c" startline="192" endline="301">swiglu_backward</references>
        <references refid="structCKLayerBackwardParams_1aa82d1124a56c3e119f2bb9336bfb364b" compoundref="ckernel__orchestration_8h" startline="112">CKLayerBackwardParams::swiglu_out</references>
        <references refid="structCKLayerBackwardParams_1a267b127c20c2f099f1b39e1bb618a2d1" compoundref="ckernel__orchestration_8h" startline="66">CKLayerBackwardParams::tokens</references>
        <references refid="structCKLayerBackwardParams_1ada3ee32dfad069f78687e2632f024837" compoundref="ckernel__orchestration_8h" startline="107">CKLayerBackwardParams::v</references>
        <references refid="structCKLayerBackwardParams_1acc46e12c5045c68eeabc8798ecde0bc0" compoundref="ckernel__orchestration_8h" startline="100">CKLayerBackwardParams::w1</references>
        <references refid="structCKLayerBackwardParams_1aef7a8891a18f2c6a7457375d0c0ed870" compoundref="ckernel__orchestration_8h" startline="102">CKLayerBackwardParams::w2</references>
        <references refid="structCKLayerBackwardParams_1a46302f164d918bf665f80e56179947cf" compoundref="ckernel__orchestration_8h" startline="92">CKLayerBackwardParams::wk</references>
        <references refid="structCKLayerBackwardParams_1a7b75fc7ac1370a2392bd7f2dff2f91f5" compoundref="ckernel__orchestration_8h" startline="97">CKLayerBackwardParams::wo</references>
        <references refid="structCKLayerBackwardParams_1a1d71a5bb91c011b20ab07a6968ff8a74" compoundref="ckernel__orchestration_8h" startline="90">CKLayerBackwardParams::wq</references>
        <references refid="structCKLayerBackwardParams_1a36b21e0cc015478bd7d5a83f8155d492" compoundref="ckernel__orchestration_8h" startline="94">CKLayerBackwardParams::wv</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1ab7dfa86e5bb0d80f0e346f85e870cb1d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_forward_rmsnorm_swiglu</definition>
        <argsstring>(const CKLayerForwardParams *p)</argsstring>
        <name>ck_layer_forward_rmsnorm_swiglu</name>
        <param>
          <type>const <ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref> *</type>
          <declname>p</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="228" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="749" bodyend="854" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="228" declcolumn="6"/>
        <references refid="structCKLayerForwardParams_1a7bc3195febcef409f9bbbbbd55b55840" compoundref="ckernel__orchestration_8h" startline="19">CKLayerForwardParams::aligned_context_window</references>
        <references refid="structCKLayerForwardParams_1adcd26186adf7f31c20dbdfed35cc0d88" compoundref="ckernel__orchestration_8h" startline="14">CKLayerForwardParams::aligned_embed_dim</references>
        <references refid="structCKLayerForwardParams_1a4eb2bdb409cf3a010bbb554a98e61e65" compoundref="ckernel__orchestration_8h" startline="18">CKLayerForwardParams::aligned_head_dim</references>
        <references refid="structCKLayerForwardParams_1add2c7b423bea0a7261e1fbdc2820d3d6" compoundref="ckernel__orchestration_8h" startline="21">CKLayerForwardParams::aligned_intermediate_dim</references>
        <references refid="ckernel__engine_8h_1a3e1aa7c55e515fd996318da27c2c5ade" compoundref="attention__kernels_8c" startline="195" endline="253">attention_forward_causal_head_major_gqa</references>
        <references refid="ckernel__engine_8h_1aac305a28084fe73b2264ae57613ba3ea" compoundref="attention__kernels_8c" startline="749" endline="796">attention_forward_causal_head_major_gqa_flash</references>
        <references refid="structCKLayerForwardParams_1af592e985b232ee6a07522504bff59ff8" compoundref="ckernel__orchestration_8h" startline="53">CKLayerForwardParams::attn_out</references>
        <references refid="structCKLayerForwardParams_1a8b216d5540d147750b5b7d6ebe238445" compoundref="ckernel__orchestration_8h" startline="43">CKLayerForwardParams::b1</references>
        <references refid="structCKLayerForwardParams_1acc91fa02742733363b55e38ff2305e7f" compoundref="ckernel__orchestration_8h" startline="45">CKLayerForwardParams::b2</references>
        <references refid="structCKLayerForwardParams_1a7e508ab8ae215c31fbae4f78b23d5929" compoundref="ckernel__orchestration_8h" startline="35">CKLayerForwardParams::bk</references>
        <references refid="structCKLayerForwardParams_1ae1e3ff68d1bc957125df225fec96dcc2" compoundref="ckernel__orchestration_8h" startline="40">CKLayerForwardParams::bo</references>
        <references refid="structCKLayerForwardParams_1a1002972e750e6b75ba1151cc4de47a05" compoundref="ckernel__orchestration_8h" startline="33">CKLayerForwardParams::bq</references>
        <references refid="structCKLayerForwardParams_1ab2e6f98706c4822473bee01a6b4c46d6" compoundref="ckernel__orchestration_8h" startline="37">CKLayerForwardParams::bv</references>
        <references refid="ckernel__orchestration_8c_1a2afc01d06448f40b94c48a51a6951dc5" compoundref="ckernel__orchestration_8c" startline="483" endline="516">ck_attention_project_head_major</references>
        <references refid="ckernel__orchestration_8c_1a2e894b79792aaf694427446c1d89fab8" compoundref="ckernel__orchestration_8c" startline="705" endline="725">ck_mlp_swiglu_forward</references>
        <references refid="ckernel__orchestration_8c_1ae1c428e05f8ea7795136ae8b160b8a0a" compoundref="ckernel__orchestration_8c" startline="44" endline="86">ck_qkv_project_head_major</references>
        <references refid="ckernel__orchestration_8c_1ab0948def8f4a6c6fd8a5288aacd22f01" compoundref="ckernel__orchestration_8c" startline="15" endline="25">ck_residual_add_token_major</references>
        <references refid="structCKLayerForwardParams_1a0a48ad009d13315fb1a18ec1f9aff5c8" compoundref="ckernel__orchestration_8h" startline="13">CKLayerForwardParams::embed_dim</references>
        <references refid="structCKLayerForwardParams_1a63e37652b3bb5e0d394ea70af0895595" compoundref="ckernel__orchestration_8h" startline="22">CKLayerForwardParams::eps</references>
        <references refid="structCKLayerForwardParams_1a7ca0c2bd14cfcde3504bd43030609e4b" compoundref="ckernel__orchestration_8h" startline="59">CKLayerForwardParams::fc1_out</references>
        <references refid="structCKLayerForwardParams_1a5aac19a779c176623a55fd48bb9502cf" compoundref="ckernel__orchestration_8h" startline="17">CKLayerForwardParams::head_dim</references>
        <references refid="structCKLayerForwardParams_1ad678ed659e2a04e07062a4aff3fe50a7" compoundref="ckernel__orchestration_8h" startline="25">CKLayerForwardParams::input</references>
        <references refid="structCKLayerForwardParams_1ac4abe1c97c14c49d953ae5dd8f910c96" compoundref="ckernel__orchestration_8h" startline="50">CKLayerForwardParams::k</references>
        <references refid="structCKLayerForwardParams_1a4a3337a600f787d4b2fe9ab83f7594c9" compoundref="ckernel__orchestration_8h" startline="26">CKLayerForwardParams::ln1_gamma</references>
        <references refid="structCKLayerForwardParams_1a58ea21593e7b3dfba61b3847843345ff" compoundref="ckernel__orchestration_8h" startline="47">CKLayerForwardParams::ln1_out</references>
        <references refid="structCKLayerForwardParams_1a402aac9e95e1c00fc1de2ab5a423a82d" compoundref="ckernel__orchestration_8h" startline="48">CKLayerForwardParams::ln1_rstd</references>
        <references refid="structCKLayerForwardParams_1aace627c9eb6644fac5c3fc5a4748f1f4" compoundref="ckernel__orchestration_8h" startline="27">CKLayerForwardParams::ln2_gamma</references>
        <references refid="structCKLayerForwardParams_1a122026c6f33e91f706fc37dab39c10b2" compoundref="ckernel__orchestration_8h" startline="57">CKLayerForwardParams::ln2_out</references>
        <references refid="structCKLayerForwardParams_1a4bad26d55e52ce0462fb8b4081880a0f" compoundref="ckernel__orchestration_8h" startline="58">CKLayerForwardParams::ln2_rstd</references>
        <references refid="structCKLayerForwardParams_1a86060e45304124966b764eb8db0365b7" compoundref="ckernel__orchestration_8h" startline="61">CKLayerForwardParams::mlp_out</references>
        <references refid="structCKLayerForwardParams_1a6ef0a14fb20cf0840ecc43d05ece08a5" compoundref="ckernel__orchestration_8h" startline="15">CKLayerForwardParams::num_heads</references>
        <references refid="structCKLayerForwardParams_1a16731d5e0724c25e7b807955d41be75a" compoundref="ckernel__orchestration_8h" startline="16">CKLayerForwardParams::num_kv_heads</references>
        <references refid="structCKLayerForwardParams_1a61d1bcef2bcffd12c7a49d243a6c51d1" compoundref="ckernel__orchestration_8h" startline="62">CKLayerForwardParams::output</references>
        <references refid="structCKLayerForwardParams_1a1d16cc6fe19fb9e3b934eccba86c35b0" compoundref="ckernel__orchestration_8h" startline="55">CKLayerForwardParams::proj_scratch</references>
        <references refid="structCKLayerForwardParams_1a1fa5c8ae6f1c35f1edd9041c6007731d" compoundref="ckernel__orchestration_8h" startline="54">CKLayerForwardParams::proj_tmp</references>
        <references refid="structCKLayerForwardParams_1a6d0ecfad1a74e3fe0583785851741e71" compoundref="ckernel__orchestration_8h" startline="49">CKLayerForwardParams::q</references>
        <references refid="structCKLayerForwardParams_1a97ce8698227c9cf419c8e21d17cebc12" compoundref="ckernel__orchestration_8h" startline="56">CKLayerForwardParams::residual1</references>
        <references refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" compoundref="rmsnorm__kernels_8c" startline="30" endline="144">rmsnorm_forward</references>
        <references refid="structCKLayerForwardParams_1a3be9a0f9fae1ab8fddc30e14628d74a0" compoundref="ckernel__orchestration_8h" startline="29">CKLayerForwardParams::rope_cos</references>
        <references refid="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" compoundref="rope__kernels_8c" startline="375" endline="388">rope_forward_qk</references>
        <references refid="structCKLayerForwardParams_1ad0e18a97d0cd2746890333bcc2d0d0e1" compoundref="ckernel__orchestration_8h" startline="23">CKLayerForwardParams::rope_pos_offset</references>
        <references refid="structCKLayerForwardParams_1a332fc12fb11a99adfd72dba034c56ea7" compoundref="ckernel__orchestration_8h" startline="30">CKLayerForwardParams::rope_sin</references>
        <references refid="structCKLayerForwardParams_1a9b1930ef9e3d94dae2f16bacd354dc2d" compoundref="ckernel__orchestration_8h" startline="52">CKLayerForwardParams::scores</references>
        <references refid="structCKLayerForwardParams_1a64b3c9bf08573696fe23f773e0af3f4a" compoundref="ckernel__orchestration_8h" startline="60">CKLayerForwardParams::swiglu_out</references>
        <references refid="structCKLayerForwardParams_1a9b2e8d95ad724035dc4ef7d8f2aeb2b8" compoundref="ckernel__orchestration_8h" startline="12">CKLayerForwardParams::tokens</references>
        <references refid="structCKLayerForwardParams_1ac49cad0850ce2e111044fc2114783d16" compoundref="ckernel__orchestration_8h" startline="51">CKLayerForwardParams::v</references>
        <references refid="structCKLayerForwardParams_1a72a52720f195370d45e7cc00a6985651" compoundref="ckernel__orchestration_8h" startline="42">CKLayerForwardParams::w1</references>
        <references refid="structCKLayerForwardParams_1a070376c4c42bb40d7cdd919ea74c669b" compoundref="ckernel__orchestration_8h" startline="44">CKLayerForwardParams::w2</references>
        <references refid="structCKLayerForwardParams_1a14ca061d781c1ed9631ff94df3e6278b" compoundref="ckernel__orchestration_8h" startline="34">CKLayerForwardParams::wk</references>
        <references refid="structCKLayerForwardParams_1a98753685d03e778a1d655f8f3cd486ea" compoundref="ckernel__orchestration_8h" startline="39">CKLayerForwardParams::wo</references>
        <references refid="structCKLayerForwardParams_1a621ed21298acc47932068d4a97ba72d7" compoundref="ckernel__orchestration_8h" startline="32">CKLayerForwardParams::wq</references>
        <references refid="structCKLayerForwardParams_1a7e8ccf20ccec87eb230737334d589f5d" compoundref="ckernel__orchestration_8h" startline="36">CKLayerForwardParams::wv</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1a745d032ebb518826e284b4a3680a8cb5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_forward_rmsnorm_swiglu_decode</definition>
        <argsstring>(const CKLayerForwardParams *p, int token_index, int cache_capacity)</argsstring>
        <name>ck_layer_forward_rmsnorm_swiglu_decode</name>
        <param>
          <type>const <ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref> *</type>
          <declname>p</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_index</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cache_capacity</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="241" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="1040" bodyend="1196" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="241" declcolumn="6"/>
        <references refid="structCKLayerForwardParams_1adcd26186adf7f31c20dbdfed35cc0d88" compoundref="ckernel__orchestration_8h" startline="14">CKLayerForwardParams::aligned_embed_dim</references>
        <references refid="structCKLayerForwardParams_1a4eb2bdb409cf3a010bbb554a98e61e65" compoundref="ckernel__orchestration_8h" startline="18">CKLayerForwardParams::aligned_head_dim</references>
        <references refid="structCKLayerForwardParams_1add2c7b423bea0a7261e1fbdc2820d3d6" compoundref="ckernel__orchestration_8h" startline="21">CKLayerForwardParams::aligned_intermediate_dim</references>
        <references refid="ckernel__engine_8h_1a84803f8c5509c325dd6b9feec50a0493" compoundref="attention__kernels_8c" startline="798" endline="847">attention_forward_decode_head_major_gqa_flash</references>
        <references refid="structCKLayerForwardParams_1a8b216d5540d147750b5b7d6ebe238445" compoundref="ckernel__orchestration_8h" startline="43">CKLayerForwardParams::b1</references>
        <references refid="structCKLayerForwardParams_1acc91fa02742733363b55e38ff2305e7f" compoundref="ckernel__orchestration_8h" startline="45">CKLayerForwardParams::b2</references>
        <references refid="structCKLayerForwardParams_1a7e508ab8ae215c31fbae4f78b23d5929" compoundref="ckernel__orchestration_8h" startline="35">CKLayerForwardParams::bk</references>
        <references refid="structCKLayerForwardParams_1ae1e3ff68d1bc957125df225fec96dcc2" compoundref="ckernel__orchestration_8h" startline="40">CKLayerForwardParams::bo</references>
        <references refid="structCKLayerForwardParams_1a1002972e750e6b75ba1151cc4de47a05" compoundref="ckernel__orchestration_8h" startline="33">CKLayerForwardParams::bq</references>
        <references refid="structCKLayerForwardParams_1ab2e6f98706c4822473bee01a6b4c46d6" compoundref="ckernel__orchestration_8h" startline="37">CKLayerForwardParams::bv</references>
        <references refid="ckernel__orchestration_8h_1ade31f5d0f381b108e331db103adc6251" compoundref="attention__decode__fused_8c" startline="99" endline="125">ck_attention_project_head_major_decode_token</references>
        <references refid="ckernel__orchestration_8c_1a2e894b79792aaf694427446c1d89fab8" compoundref="ckernel__orchestration_8c" startline="705" endline="725">ck_mlp_swiglu_forward</references>
        <references refid="ckernel__orchestration_8h_1ab6c6524b0f30733a077e3783bb55a592" compoundref="attention__decode__fused_8c" startline="62" endline="97">ck_qkv_project_head_major_token</references>
        <references refid="ckernel__orchestration_8c_1ab0948def8f4a6c6fd8a5288aacd22f01" compoundref="ckernel__orchestration_8c" startline="15" endline="25">ck_residual_add_token_major</references>
        <references refid="structCKLayerForwardParams_1a0a48ad009d13315fb1a18ec1f9aff5c8" compoundref="ckernel__orchestration_8h" startline="13">CKLayerForwardParams::embed_dim</references>
        <references refid="structCKLayerForwardParams_1a63e37652b3bb5e0d394ea70af0895595" compoundref="ckernel__orchestration_8h" startline="22">CKLayerForwardParams::eps</references>
        <references refid="structCKLayerForwardParams_1a7ca0c2bd14cfcde3504bd43030609e4b" compoundref="ckernel__orchestration_8h" startline="59">CKLayerForwardParams::fc1_out</references>
        <references refid="structCKLayerForwardParams_1a5aac19a779c176623a55fd48bb9502cf" compoundref="ckernel__orchestration_8h" startline="17">CKLayerForwardParams::head_dim</references>
        <references refid="structCKLayerForwardParams_1ad678ed659e2a04e07062a4aff3fe50a7" compoundref="ckernel__orchestration_8h" startline="25">CKLayerForwardParams::input</references>
        <references refid="structCKLayerForwardParams_1ac4abe1c97c14c49d953ae5dd8f910c96" compoundref="ckernel__orchestration_8h" startline="50">CKLayerForwardParams::k</references>
        <references refid="ckernel__engine_8h_1a1b1c905b9d69fc8aadca4c714147ce45" compoundref="kv__cache__kernels_8c" startline="48" endline="92">kv_cache_write_head_major</references>
        <references refid="structCKLayerForwardParams_1a4a3337a600f787d4b2fe9ab83f7594c9" compoundref="ckernel__orchestration_8h" startline="26">CKLayerForwardParams::ln1_gamma</references>
        <references refid="structCKLayerForwardParams_1a58ea21593e7b3dfba61b3847843345ff" compoundref="ckernel__orchestration_8h" startline="47">CKLayerForwardParams::ln1_out</references>
        <references refid="structCKLayerForwardParams_1a402aac9e95e1c00fc1de2ab5a423a82d" compoundref="ckernel__orchestration_8h" startline="48">CKLayerForwardParams::ln1_rstd</references>
        <references refid="structCKLayerForwardParams_1aace627c9eb6644fac5c3fc5a4748f1f4" compoundref="ckernel__orchestration_8h" startline="27">CKLayerForwardParams::ln2_gamma</references>
        <references refid="structCKLayerForwardParams_1a122026c6f33e91f706fc37dab39c10b2" compoundref="ckernel__orchestration_8h" startline="57">CKLayerForwardParams::ln2_out</references>
        <references refid="structCKLayerForwardParams_1a4bad26d55e52ce0462fb8b4081880a0f" compoundref="ckernel__orchestration_8h" startline="58">CKLayerForwardParams::ln2_rstd</references>
        <references refid="structCKLayerForwardParams_1a86060e45304124966b764eb8db0365b7" compoundref="ckernel__orchestration_8h" startline="61">CKLayerForwardParams::mlp_out</references>
        <references refid="structCKLayerForwardParams_1a6ef0a14fb20cf0840ecc43d05ece08a5" compoundref="ckernel__orchestration_8h" startline="15">CKLayerForwardParams::num_heads</references>
        <references refid="structCKLayerForwardParams_1a16731d5e0724c25e7b807955d41be75a" compoundref="ckernel__orchestration_8h" startline="16">CKLayerForwardParams::num_kv_heads</references>
        <references refid="structCKLayerForwardParams_1a61d1bcef2bcffd12c7a49d243a6c51d1" compoundref="ckernel__orchestration_8h" startline="62">CKLayerForwardParams::output</references>
        <references refid="structCKLayerForwardParams_1a1fa5c8ae6f1c35f1edd9041c6007731d" compoundref="ckernel__orchestration_8h" startline="54">CKLayerForwardParams::proj_tmp</references>
        <references refid="structCKLayerForwardParams_1a97ce8698227c9cf419c8e21d17cebc12" compoundref="ckernel__orchestration_8h" startline="56">CKLayerForwardParams::residual1</references>
        <references refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" compoundref="rmsnorm__kernels_8c" startline="30" endline="144">rmsnorm_forward</references>
        <references refid="structCKLayerForwardParams_1a3be9a0f9fae1ab8fddc30e14628d74a0" compoundref="ckernel__orchestration_8h" startline="29">CKLayerForwardParams::rope_cos</references>
        <references refid="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" compoundref="rope__kernels_8c" startline="375" endline="388">rope_forward_qk</references>
        <references refid="structCKLayerForwardParams_1ad0e18a97d0cd2746890333bcc2d0d0e1" compoundref="ckernel__orchestration_8h" startline="23">CKLayerForwardParams::rope_pos_offset</references>
        <references refid="structCKLayerForwardParams_1a332fc12fb11a99adfd72dba034c56ea7" compoundref="ckernel__orchestration_8h" startline="30">CKLayerForwardParams::rope_sin</references>
        <references refid="structCKLayerForwardParams_1a64b3c9bf08573696fe23f773e0af3f4a" compoundref="ckernel__orchestration_8h" startline="60">CKLayerForwardParams::swiglu_out</references>
        <references refid="structCKLayerForwardParams_1ac49cad0850ce2e111044fc2114783d16" compoundref="ckernel__orchestration_8h" startline="51">CKLayerForwardParams::v</references>
        <references refid="structCKLayerForwardParams_1a72a52720f195370d45e7cc00a6985651" compoundref="ckernel__orchestration_8h" startline="42">CKLayerForwardParams::w1</references>
        <references refid="structCKLayerForwardParams_1a070376c4c42bb40d7cdd919ea74c669b" compoundref="ckernel__orchestration_8h" startline="44">CKLayerForwardParams::w2</references>
        <references refid="structCKLayerForwardParams_1a14ca061d781c1ed9631ff94df3e6278b" compoundref="ckernel__orchestration_8h" startline="34">CKLayerForwardParams::wk</references>
        <references refid="structCKLayerForwardParams_1a98753685d03e778a1d655f8f3cd486ea" compoundref="ckernel__orchestration_8h" startline="39">CKLayerForwardParams::wo</references>
        <references refid="structCKLayerForwardParams_1a621ed21298acc47932068d4a97ba72d7" compoundref="ckernel__orchestration_8h" startline="32">CKLayerForwardParams::wq</references>
        <references refid="structCKLayerForwardParams_1a7e8ccf20ccec87eb230737334d589f5d" compoundref="ckernel__orchestration_8h" startline="36">CKLayerForwardParams::wv</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1ab8d674c4a63b69a0cc0b38bbe58fa9f2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_forward_rmsnorm_swiglu_decode_fused</definition>
        <argsstring>(const CKLayerForwardParams *p, int token_index, int cache_capacity)</argsstring>
        <name>ck_layer_forward_rmsnorm_swiglu_decode_fused</name>
        <param>
          <type>const <ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref> *</type>
          <declname>p</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_index</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cache_capacity</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="247" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="1198" bodyend="1349" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="247" declcolumn="6"/>
        <references refid="structCKLayerForwardParams_1adcd26186adf7f31c20dbdfed35cc0d88" compoundref="ckernel__orchestration_8h" startline="14">CKLayerForwardParams::aligned_embed_dim</references>
        <references refid="structCKLayerForwardParams_1a4eb2bdb409cf3a010bbb554a98e61e65" compoundref="ckernel__orchestration_8h" startline="18">CKLayerForwardParams::aligned_head_dim</references>
        <references refid="structCKLayerForwardParams_1add2c7b423bea0a7261e1fbdc2820d3d6" compoundref="ckernel__orchestration_8h" startline="21">CKLayerForwardParams::aligned_intermediate_dim</references>
        <references refid="ckernel__engine_8h_1a84803f8c5509c325dd6b9feec50a0493" compoundref="attention__kernels_8c" startline="798" endline="847">attention_forward_decode_head_major_gqa_flash</references>
        <references refid="structCKLayerForwardParams_1a8b216d5540d147750b5b7d6ebe238445" compoundref="ckernel__orchestration_8h" startline="43">CKLayerForwardParams::b1</references>
        <references refid="structCKLayerForwardParams_1acc91fa02742733363b55e38ff2305e7f" compoundref="ckernel__orchestration_8h" startline="45">CKLayerForwardParams::b2</references>
        <references refid="structCKLayerForwardParams_1a7e508ab8ae215c31fbae4f78b23d5929" compoundref="ckernel__orchestration_8h" startline="35">CKLayerForwardParams::bk</references>
        <references refid="structCKLayerForwardParams_1ae1e3ff68d1bc957125df225fec96dcc2" compoundref="ckernel__orchestration_8h" startline="40">CKLayerForwardParams::bo</references>
        <references refid="structCKLayerForwardParams_1a1002972e750e6b75ba1151cc4de47a05" compoundref="ckernel__orchestration_8h" startline="33">CKLayerForwardParams::bq</references>
        <references refid="structCKLayerForwardParams_1ab2e6f98706c4822473bee01a6b4c46d6" compoundref="ckernel__orchestration_8h" startline="37">CKLayerForwardParams::bv</references>
        <references refid="ckernel__orchestration_8h_1ade31f5d0f381b108e331db103adc6251" compoundref="attention__decode__fused_8c" startline="99" endline="125">ck_attention_project_head_major_decode_token</references>
        <references refid="ckernel__orchestration_8c_1a6aaebd943ca5ad278729a207b401ab45" compoundref="ckernel__orchestration_8c" startline="998" endline="1038">ck_mlp_swiglu_forward_fully_fused_token</references>
        <references refid="ckernel__orchestration_8h_1ab6c6524b0f30733a077e3783bb55a592" compoundref="attention__decode__fused_8c" startline="62" endline="97">ck_qkv_project_head_major_token</references>
        <references refid="ckernel__orchestration_8c_1ab0948def8f4a6c6fd8a5288aacd22f01" compoundref="ckernel__orchestration_8c" startline="15" endline="25">ck_residual_add_token_major</references>
        <references refid="structCKLayerForwardParams_1a0a48ad009d13315fb1a18ec1f9aff5c8" compoundref="ckernel__orchestration_8h" startline="13">CKLayerForwardParams::embed_dim</references>
        <references refid="structCKLayerForwardParams_1a63e37652b3bb5e0d394ea70af0895595" compoundref="ckernel__orchestration_8h" startline="22">CKLayerForwardParams::eps</references>
        <references refid="structCKLayerForwardParams_1a5aac19a779c176623a55fd48bb9502cf" compoundref="ckernel__orchestration_8h" startline="17">CKLayerForwardParams::head_dim</references>
        <references refid="structCKLayerForwardParams_1ad678ed659e2a04e07062a4aff3fe50a7" compoundref="ckernel__orchestration_8h" startline="25">CKLayerForwardParams::input</references>
        <references refid="structCKLayerForwardParams_1ac4abe1c97c14c49d953ae5dd8f910c96" compoundref="ckernel__orchestration_8h" startline="50">CKLayerForwardParams::k</references>
        <references refid="ckernel__engine_8h_1a1b1c905b9d69fc8aadca4c714147ce45" compoundref="kv__cache__kernels_8c" startline="48" endline="92">kv_cache_write_head_major</references>
        <references refid="structCKLayerForwardParams_1a4a3337a600f787d4b2fe9ab83f7594c9" compoundref="ckernel__orchestration_8h" startline="26">CKLayerForwardParams::ln1_gamma</references>
        <references refid="structCKLayerForwardParams_1a58ea21593e7b3dfba61b3847843345ff" compoundref="ckernel__orchestration_8h" startline="47">CKLayerForwardParams::ln1_out</references>
        <references refid="structCKLayerForwardParams_1a402aac9e95e1c00fc1de2ab5a423a82d" compoundref="ckernel__orchestration_8h" startline="48">CKLayerForwardParams::ln1_rstd</references>
        <references refid="structCKLayerForwardParams_1aace627c9eb6644fac5c3fc5a4748f1f4" compoundref="ckernel__orchestration_8h" startline="27">CKLayerForwardParams::ln2_gamma</references>
        <references refid="structCKLayerForwardParams_1a122026c6f33e91f706fc37dab39c10b2" compoundref="ckernel__orchestration_8h" startline="57">CKLayerForwardParams::ln2_out</references>
        <references refid="structCKLayerForwardParams_1a4bad26d55e52ce0462fb8b4081880a0f" compoundref="ckernel__orchestration_8h" startline="58">CKLayerForwardParams::ln2_rstd</references>
        <references refid="structCKLayerForwardParams_1a86060e45304124966b764eb8db0365b7" compoundref="ckernel__orchestration_8h" startline="61">CKLayerForwardParams::mlp_out</references>
        <references refid="structCKLayerForwardParams_1a6ef0a14fb20cf0840ecc43d05ece08a5" compoundref="ckernel__orchestration_8h" startline="15">CKLayerForwardParams::num_heads</references>
        <references refid="structCKLayerForwardParams_1a16731d5e0724c25e7b807955d41be75a" compoundref="ckernel__orchestration_8h" startline="16">CKLayerForwardParams::num_kv_heads</references>
        <references refid="structCKLayerForwardParams_1a61d1bcef2bcffd12c7a49d243a6c51d1" compoundref="ckernel__orchestration_8h" startline="62">CKLayerForwardParams::output</references>
        <references refid="structCKLayerForwardParams_1a1fa5c8ae6f1c35f1edd9041c6007731d" compoundref="ckernel__orchestration_8h" startline="54">CKLayerForwardParams::proj_tmp</references>
        <references refid="structCKLayerForwardParams_1a97ce8698227c9cf419c8e21d17cebc12" compoundref="ckernel__orchestration_8h" startline="56">CKLayerForwardParams::residual1</references>
        <references refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" compoundref="rmsnorm__kernels_8c" startline="30" endline="144">rmsnorm_forward</references>
        <references refid="structCKLayerForwardParams_1a3be9a0f9fae1ab8fddc30e14628d74a0" compoundref="ckernel__orchestration_8h" startline="29">CKLayerForwardParams::rope_cos</references>
        <references refid="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" compoundref="rope__kernels_8c" startline="375" endline="388">rope_forward_qk</references>
        <references refid="structCKLayerForwardParams_1ad0e18a97d0cd2746890333bcc2d0d0e1" compoundref="ckernel__orchestration_8h" startline="23">CKLayerForwardParams::rope_pos_offset</references>
        <references refid="structCKLayerForwardParams_1a332fc12fb11a99adfd72dba034c56ea7" compoundref="ckernel__orchestration_8h" startline="30">CKLayerForwardParams::rope_sin</references>
        <references refid="structCKLayerForwardParams_1a64b3c9bf08573696fe23f773e0af3f4a" compoundref="ckernel__orchestration_8h" startline="60">CKLayerForwardParams::swiglu_out</references>
        <references refid="structCKLayerForwardParams_1ac49cad0850ce2e111044fc2114783d16" compoundref="ckernel__orchestration_8h" startline="51">CKLayerForwardParams::v</references>
        <references refid="structCKLayerForwardParams_1a72a52720f195370d45e7cc00a6985651" compoundref="ckernel__orchestration_8h" startline="42">CKLayerForwardParams::w1</references>
        <references refid="structCKLayerForwardParams_1a070376c4c42bb40d7cdd919ea74c669b" compoundref="ckernel__orchestration_8h" startline="44">CKLayerForwardParams::w2</references>
        <references refid="structCKLayerForwardParams_1a14ca061d781c1ed9631ff94df3e6278b" compoundref="ckernel__orchestration_8h" startline="34">CKLayerForwardParams::wk</references>
        <references refid="structCKLayerForwardParams_1a98753685d03e778a1d655f8f3cd486ea" compoundref="ckernel__orchestration_8h" startline="39">CKLayerForwardParams::wo</references>
        <references refid="structCKLayerForwardParams_1a621ed21298acc47932068d4a97ba72d7" compoundref="ckernel__orchestration_8h" startline="32">CKLayerForwardParams::wq</references>
        <references refid="structCKLayerForwardParams_1a7e8ccf20ccec87eb230737334d589f5d" compoundref="ckernel__orchestration_8h" startline="36">CKLayerForwardParams::wv</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1ad466e4eeb1c0ab92d9c9bf15cb51f679" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_forward_rmsnorm_swiglu_decode_fused_attn</definition>
        <argsstring>(const CKLayerForwardParams *p, int token_index, int cache_capacity)</argsstring>
        <name>ck_layer_forward_rmsnorm_swiglu_decode_fused_attn</name>
        <param>
          <type>const <ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref> *</type>
          <declname>p</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_index</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cache_capacity</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="253" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_decode_fused.c" bodystart="325" bodyend="333" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="253" declcolumn="6"/>
        <references refid="attention__decode__fused_8c_1a1e6628f9f140c9749a6dd7c2c9ce263a" compoundref="attention__decode__fused_8c" startline="165" endline="323">ck_layer_forward_rmsnorm_swiglu_decode_fused_attn_impl</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1a50899fc552648f5d1cadd0e4c5671dc1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_forward_rmsnorm_swiglu_decode_fused_attn_mlp</definition>
        <argsstring>(const CKLayerForwardParams *p, int token_index, int cache_capacity)</argsstring>
        <name>ck_layer_forward_rmsnorm_swiglu_decode_fused_attn_mlp</name>
        <param>
          <type>const <ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref> *</type>
          <declname>p</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_index</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cache_capacity</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="257" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_decode_fused.c" bodystart="335" bodyend="343" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="257" declcolumn="6"/>
        <references refid="attention__decode__fused_8c_1a1e6628f9f140c9749a6dd7c2c9ce263a" compoundref="attention__decode__fused_8c" startline="165" endline="323">ck_layer_forward_rmsnorm_swiglu_decode_fused_attn_impl</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1abb01994013418ff7b8be71dc9bdcded5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_forward_rmsnorm_swiglu_decode_q4_k</definition>
        <argsstring>(const CKLayerForwardParamsQ4K *p, int token_index, int cache_capacity)</argsstring>
        <name>ck_layer_forward_rmsnorm_swiglu_decode_q4_k</name>
        <param>
          <type>const <ref refid="structCKLayerForwardParamsQ4K" kindref="compound">CKLayerForwardParamsQ4K</ref> *</type>
          <declname>p</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_index</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cache_capacity</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="337" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="1857" bodyend="2126" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="337" declcolumn="6"/>
        <references refid="structCKLayerForwardParamsQ4K_1a00e5d63076d9e3306bb3b189a47b1e14" compoundref="ckernel__orchestration_8h" startline="278">CKLayerForwardParamsQ4K::aligned_embed_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1ada91d4c0f5e6040aca475655f7f1bcab" compoundref="ckernel__orchestration_8h" startline="282">CKLayerForwardParamsQ4K::aligned_head_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1a4384a52ba7c2f30d4895d3edd4321cab" compoundref="ckernel__orchestration_8h" startline="285">CKLayerForwardParamsQ4K::aligned_intermediate_dim</references>
        <references refid="ckernel__engine_8h_1a84803f8c5509c325dd6b9feec50a0493" compoundref="attention__kernels_8c" startline="798" endline="847">attention_forward_decode_head_major_gqa_flash</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2aecde76c05afca045048df499be02f5" compoundref="ckernel__orchestration_8h" startline="307">CKLayerForwardParamsQ4K::b1</references>
        <references refid="structCKLayerForwardParamsQ4K_1a715be17f92fbcb0aa10ce00dcde62939" compoundref="ckernel__orchestration_8h" startline="309">CKLayerForwardParamsQ4K::b2</references>
        <references refid="structCKLayerForwardParamsQ4K_1a882236cfb15923ee4962013a53f893a0" compoundref="ckernel__orchestration_8h" startline="299">CKLayerForwardParamsQ4K::bk</references>
        <references refid="structCKLayerForwardParamsQ4K_1aaaba47dd4ef07fdb1a6662a88c2014cb" compoundref="ckernel__orchestration_8h" startline="304">CKLayerForwardParamsQ4K::bo</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5624ab23e1e9c41d5ea3b4b9e8569d03" compoundref="ckernel__orchestration_8h" startline="297">CKLayerForwardParamsQ4K::bq</references>
        <references refid="structCKLayerForwardParamsQ4K_1a1c7b2b14198b4296631e7169eec94919" compoundref="ckernel__orchestration_8h" startline="301">CKLayerForwardParamsQ4K::bv</references>
        <references refid="ckernel__orchestration_8c_1a9be0b5aaccd3e66b10a9ec0505ae8877" compoundref="ckernel__orchestration_8c" startline="347" endline="367">ck_mlp_swiglu_forward_q4_k</references>
        <references refid="ckernel__orchestration_8c_1a7310a1f37d7ebf7dfde9380c5e19812b" compoundref="ckernel__orchestration_8c" startline="393" endline="426">ck_mlp_swiglu_forward_q4_k_q8_k</references>
        <references refid="ckernel__orchestration_8c_1a45ad329928b675ddc00ad3d5059335b3" compoundref="ckernel__orchestration_8c" startline="88" endline="107">ck_q8k_activations_enabled</references>
        <references refid="ckernel__orchestration_8c_1ad492e291abbf309f2332cdf955597083" compoundref="ckernel__orchestration_8c" startline="1351" endline="1394">ck_qkv_project_head_major_token_q4_k</references>
        <references refid="ckernel__orchestration_8c_1a3a2f1ed53c42b0003b637f0020c419f9" compoundref="ckernel__orchestration_8c" startline="1396" endline="1439">ck_qkv_project_head_major_token_q4_k_q8_k</references>
        <references refid="ckernel__orchestration_8c_1ab0948def8f4a6c6fd8a5288aacd22f01" compoundref="ckernel__orchestration_8c" startline="15" endline="25">ck_residual_add_token_major</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad8373aa2774d6b69c1e4ea1d151d2646" compoundref="ckernel__orchestration_8h" startline="277">CKLayerForwardParamsQ4K::embed_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1a002187e74b3fa26e39bd17a965c72f8b" compoundref="ckernel__orchestration_8h" startline="286">CKLayerForwardParamsQ4K::eps</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7871fd5d96ccc288a12c6e08415c82dc" compoundref="ckernel__orchestration_8h" startline="323">CKLayerForwardParamsQ4K::fc1_out</references>
        <references refid="ckernel__engine_8h_1a3175d33b3e513cf585a31f96db726e39" compoundref="gemm__kernels__q4k_8c" startline="545" endline="573">gemm_nt_q4_k</references>
        <references refid="ckernel__engine_8h_1a64fc7f7c8582355c66edf044b9858964" compoundref="gemm__kernels__q4k__q8k_8c" startline="197" endline="222">gemm_nt_q4_k_q8_k</references>
        <references refid="structCKLayerForwardParamsQ4K_1a8f8ca9f6b17918a424041cc9003229e9" compoundref="ckernel__orchestration_8h" startline="281">CKLayerForwardParamsQ4K::head_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad73e1dbeb642314392d9bd140dd0aff8" compoundref="ckernel__orchestration_8h" startline="289">CKLayerForwardParamsQ4K::input</references>
        <references refid="structCKLayerForwardParamsQ4K_1a31e2ba79a8c69429c6e31c20ee1c6efa" compoundref="ckernel__orchestration_8h" startline="314">CKLayerForwardParamsQ4K::k</references>
        <references refid="ckernel__engine_8h_1a1b1c905b9d69fc8aadca4c714147ce45" compoundref="kv__cache__kernels_8c" startline="48" endline="92">kv_cache_write_head_major</references>
        <references refid="structCKLayerForwardParamsQ4K_1afae06ea5bb1f1d1aed99a1bfd54dd6bf" compoundref="ckernel__orchestration_8h" startline="290">CKLayerForwardParamsQ4K::ln1_gamma</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7ea6e14a98a47d72837f92f2a5601566" compoundref="ckernel__orchestration_8h" startline="311">CKLayerForwardParamsQ4K::ln1_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a658fef23434f9427fab5f76ef0cea95a" compoundref="ckernel__orchestration_8h" startline="312">CKLayerForwardParamsQ4K::ln1_rstd</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5241512944a07c6e9e9beee22d05c566" compoundref="ckernel__orchestration_8h" startline="291">CKLayerForwardParamsQ4K::ln2_gamma</references>
        <references refid="structCKLayerForwardParamsQ4K_1af0407fc50e027301417628d774a41ff3" compoundref="ckernel__orchestration_8h" startline="321">CKLayerForwardParamsQ4K::ln2_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2309c41abca4ad1bc357dd780e55fecb" compoundref="ckernel__orchestration_8h" startline="322">CKLayerForwardParamsQ4K::ln2_rstd</references>
        <references refid="structCKLayerForwardParamsQ4K_1a755532817e588edf60f4f9cf86f52f07" compoundref="ckernel__orchestration_8h" startline="325">CKLayerForwardParamsQ4K::mlp_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5f55a51a93b0a9b2f02520fd02c8dd0e" compoundref="ckernel__orchestration_8h" startline="279">CKLayerForwardParamsQ4K::num_heads</references>
        <references refid="structCKLayerForwardParamsQ4K_1aac37dcd8276a700a4a0123a4f3af8dc3" compoundref="ckernel__orchestration_8h" startline="280">CKLayerForwardParamsQ4K::num_kv_heads</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2532f454e8565aafe5bc975e518e90e2" compoundref="ckernel__orchestration_8h" startline="326">CKLayerForwardParamsQ4K::output</references>
        <references refid="structCKLayerForwardParamsQ4K_1a66da64885aa1cf87cb9e687ad7fcd34b" compoundref="ckernel__orchestration_8h" startline="318">CKLayerForwardParamsQ4K::proj_tmp</references>
        <references refid="ckernel__quant_8h_1afd2f43dcca46f268b2008cb200198e50" compoundref="ckernel__quant_8h" startline="69">QK_K</references>
        <references refid="ckernel__engine_8h_1a8a2064dd87b86a56f41b163bef7bdd9d" compoundref="gemm__kernels__q4k__q8k_8c" startline="34" endline="84">quantize_row_q8_k</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7ae4c7affb31c2e7a6ad09688e56ba42" compoundref="ckernel__orchestration_8h" startline="320">CKLayerForwardParamsQ4K::residual1</references>
        <references refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" compoundref="rmsnorm__kernels_8c" startline="30" endline="144">rmsnorm_forward</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2ddfb5a4e6442a028d7475dc1e9266cd" compoundref="ckernel__orchestration_8h" startline="293">CKLayerForwardParamsQ4K::rope_cos</references>
        <references refid="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" compoundref="rope__kernels_8c" startline="375" endline="388">rope_forward_qk</references>
        <references refid="structCKLayerForwardParamsQ4K_1a1923b2ba97133951c6705efd90978c72" compoundref="ckernel__orchestration_8h" startline="287">CKLayerForwardParamsQ4K::rope_pos_offset</references>
        <references refid="structCKLayerForwardParamsQ4K_1a716869dbb8759abc3d3d236ba7482383" compoundref="ckernel__orchestration_8h" startline="294">CKLayerForwardParamsQ4K::rope_sin</references>
        <references refid="structCKLayerForwardParamsQ4K_1a976fb97749625cdc0f8e16e690c5e5a0" compoundref="ckernel__orchestration_8h" startline="324">CKLayerForwardParamsQ4K::swiglu_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7b17e1545dee689697df5da4751de3ea" compoundref="ckernel__orchestration_8h" startline="315">CKLayerForwardParamsQ4K::v</references>
        <references refid="structCKLayerForwardParamsQ4K_1aafad2b7a679b5775026053a2b3cf82b1" compoundref="ckernel__orchestration_8h" startline="306">CKLayerForwardParamsQ4K::w1</references>
        <references refid="structCKLayerForwardParamsQ4K_1aac721dc3d07b7f9f3a0fcbdc6101e4bb" compoundref="ckernel__orchestration_8h" startline="308">CKLayerForwardParamsQ4K::w2</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad6e110f69299b040cd07f83ed612548b" compoundref="ckernel__orchestration_8h" startline="298">CKLayerForwardParamsQ4K::wk</references>
        <references refid="structCKLayerForwardParamsQ4K_1a52ce0d74a3fdff1ea8b04030a733fc1d" compoundref="ckernel__orchestration_8h" startline="303">CKLayerForwardParamsQ4K::wo</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2b71fe14402b1fa2a52ff6d212a42a21" compoundref="ckernel__orchestration_8h" startline="296">CKLayerForwardParamsQ4K::wq</references>
        <references refid="structCKLayerForwardParamsQ4K_1a35349f8d709bd6b19b8bdc1b46cbf10f" compoundref="ckernel__orchestration_8h" startline="300">CKLayerForwardParamsQ4K::wv</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1ae07680f1a438bd1824fa4b1c3e4e826e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_forward_rmsnorm_swiglu_decode_quant</definition>
        <argsstring>(const CKLayerForwardParamsQ4K *p, int token_index, int cache_capacity)</argsstring>
        <name>ck_layer_forward_rmsnorm_swiglu_decode_quant</name>
        <param>
          <type>const <ref refid="structCKLayerForwardParamsQ4K" kindref="compound">CKLayerForwardParamsQ4K</ref> *</type>
          <declname>p</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_index</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cache_capacity</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="341" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="2238" bodyend="2408" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="341" declcolumn="6"/>
        <references refid="structCKLayerForwardParamsQ4K_1a00e5d63076d9e3306bb3b189a47b1e14" compoundref="ckernel__orchestration_8h" startline="278">CKLayerForwardParamsQ4K::aligned_embed_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1ada91d4c0f5e6040aca475655f7f1bcab" compoundref="ckernel__orchestration_8h" startline="282">CKLayerForwardParamsQ4K::aligned_head_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1a4384a52ba7c2f30d4895d3edd4321cab" compoundref="ckernel__orchestration_8h" startline="285">CKLayerForwardParamsQ4K::aligned_intermediate_dim</references>
        <references refid="ckernel__engine_8h_1a84803f8c5509c325dd6b9feec50a0493" compoundref="attention__kernels_8c" startline="798" endline="847">attention_forward_decode_head_major_gqa_flash</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2aecde76c05afca045048df499be02f5" compoundref="ckernel__orchestration_8h" startline="307">CKLayerForwardParamsQ4K::b1</references>
        <references refid="structCKLayerForwardParamsQ4K_1a715be17f92fbcb0aa10ce00dcde62939" compoundref="ckernel__orchestration_8h" startline="309">CKLayerForwardParamsQ4K::b2</references>
        <references refid="structCKLayerForwardParamsQ4K_1a882236cfb15923ee4962013a53f893a0" compoundref="ckernel__orchestration_8h" startline="299">CKLayerForwardParamsQ4K::bk</references>
        <references refid="structCKLayerForwardParamsQ4K_1aaaba47dd4ef07fdb1a6662a88c2014cb" compoundref="ckernel__orchestration_8h" startline="304">CKLayerForwardParamsQ4K::bo</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5624ab23e1e9c41d5ea3b4b9e8569d03" compoundref="ckernel__orchestration_8h" startline="297">CKLayerForwardParamsQ4K::bq</references>
        <references refid="structCKLayerForwardParamsQ4K_1a1c7b2b14198b4296631e7169eec94919" compoundref="ckernel__orchestration_8h" startline="301">CKLayerForwardParamsQ4K::bv</references>
        <references refid="ckernel__orchestration_8h_1ade31f5d0f381b108e331db103adc6251" compoundref="attention__decode__fused_8c" startline="99" endline="125">ck_attention_project_head_major_decode_token</references>
        <references refid="ckernel__dtype_8h_1a9d2373b6c685cf9421a6fb638964aa65a9b7d39257d8dd8044a4012bc6db08e2b" compoundref="ckernel__dtype_8h" startline="27">CK_DT_FP32</references>
        <references refid="ckernel__dtype_8h_1a9d2373b6c685cf9421a6fb638964aa65a2a27336a01bd529878399bcad9ceb10a" compoundref="ckernel__dtype_8h" startline="37">CK_DT_Q4_K</references>
        <references refid="ckernel__dtype_8h_1a9d2373b6c685cf9421a6fb638964aa65aad14a988ad6ac1381e87803ed92be1b5" compoundref="ckernel__dtype_8h" startline="38">CK_DT_Q6_K</references>
        <references refid="ckernel__orchestration_8c_1a3754c7725e77065577179096b396c075" compoundref="ckernel__orchestration_8c" startline="369" endline="391">ck_mlp_swiglu_forward_quant</references>
        <references refid="ckernel__orchestration_8c_1ad9e143397c01620ba314aa448ed922a1" compoundref="ckernel__orchestration_8c" startline="1599" endline="1650">ck_qkv_project_head_major_token_quant</references>
        <references refid="ckernel__orchestration_8c_1ab0948def8f4a6c6fd8a5288aacd22f01" compoundref="ckernel__orchestration_8c" startline="15" endline="25">ck_residual_add_token_major</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad8373aa2774d6b69c1e4ea1d151d2646" compoundref="ckernel__orchestration_8h" startline="277">CKLayerForwardParamsQ4K::embed_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1a002187e74b3fa26e39bd17a965c72f8b" compoundref="ckernel__orchestration_8h" startline="286">CKLayerForwardParamsQ4K::eps</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7871fd5d96ccc288a12c6e08415c82dc" compoundref="ckernel__orchestration_8h" startline="323">CKLayerForwardParamsQ4K::fc1_out</references>
        <references refid="ckernel__engine_8h_1a3175d33b3e513cf585a31f96db726e39" compoundref="gemm__kernels__q4k_8c" startline="545" endline="573">gemm_nt_q4_k</references>
        <references refid="ckernel__engine_8h_1a7568db3d490c7a7372a5236d8b2fe207" compoundref="gemm__kernels__q6k_8c" startline="98" endline="126">gemm_nt_q6_k</references>
        <references refid="structCKLayerForwardParamsQ4K_1a8f8ca9f6b17918a424041cc9003229e9" compoundref="ckernel__orchestration_8h" startline="281">CKLayerForwardParamsQ4K::head_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad73e1dbeb642314392d9bd140dd0aff8" compoundref="ckernel__orchestration_8h" startline="289">CKLayerForwardParamsQ4K::input</references>
        <references refid="structCKLayerForwardParamsQ4K_1a31e2ba79a8c69429c6e31c20ee1c6efa" compoundref="ckernel__orchestration_8h" startline="314">CKLayerForwardParamsQ4K::k</references>
        <references refid="ckernel__engine_8h_1a1b1c905b9d69fc8aadca4c714147ce45" compoundref="kv__cache__kernels_8c" startline="48" endline="92">kv_cache_write_head_major</references>
        <references refid="structCKLayerForwardParamsQ4K_1afae06ea5bb1f1d1aed99a1bfd54dd6bf" compoundref="ckernel__orchestration_8h" startline="290">CKLayerForwardParamsQ4K::ln1_gamma</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7ea6e14a98a47d72837f92f2a5601566" compoundref="ckernel__orchestration_8h" startline="311">CKLayerForwardParamsQ4K::ln1_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a658fef23434f9427fab5f76ef0cea95a" compoundref="ckernel__orchestration_8h" startline="312">CKLayerForwardParamsQ4K::ln1_rstd</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5241512944a07c6e9e9beee22d05c566" compoundref="ckernel__orchestration_8h" startline="291">CKLayerForwardParamsQ4K::ln2_gamma</references>
        <references refid="structCKLayerForwardParamsQ4K_1af0407fc50e027301417628d774a41ff3" compoundref="ckernel__orchestration_8h" startline="321">CKLayerForwardParamsQ4K::ln2_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2309c41abca4ad1bc357dd780e55fecb" compoundref="ckernel__orchestration_8h" startline="322">CKLayerForwardParamsQ4K::ln2_rstd</references>
        <references refid="structCKLayerForwardParamsQ4K_1a755532817e588edf60f4f9cf86f52f07" compoundref="ckernel__orchestration_8h" startline="325">CKLayerForwardParamsQ4K::mlp_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5f55a51a93b0a9b2f02520fd02c8dd0e" compoundref="ckernel__orchestration_8h" startline="279">CKLayerForwardParamsQ4K::num_heads</references>
        <references refid="structCKLayerForwardParamsQ4K_1aac37dcd8276a700a4a0123a4f3af8dc3" compoundref="ckernel__orchestration_8h" startline="280">CKLayerForwardParamsQ4K::num_kv_heads</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2532f454e8565aafe5bc975e518e90e2" compoundref="ckernel__orchestration_8h" startline="326">CKLayerForwardParamsQ4K::output</references>
        <references refid="structCKLayerForwardParamsQ4K_1ac6fb5da685cc15ae713f5760f2c05c41" compoundref="ckernel__orchestration_8h" startline="319">CKLayerForwardParamsQ4K::proj_scratch</references>
        <references refid="structCKLayerForwardParamsQ4K_1a66da64885aa1cf87cb9e687ad7fcd34b" compoundref="ckernel__orchestration_8h" startline="318">CKLayerForwardParamsQ4K::proj_tmp</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7ae4c7affb31c2e7a6ad09688e56ba42" compoundref="ckernel__orchestration_8h" startline="320">CKLayerForwardParamsQ4K::residual1</references>
        <references refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" compoundref="rmsnorm__kernels_8c" startline="30" endline="144">rmsnorm_forward</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2ddfb5a4e6442a028d7475dc1e9266cd" compoundref="ckernel__orchestration_8h" startline="293">CKLayerForwardParamsQ4K::rope_cos</references>
        <references refid="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" compoundref="rope__kernels_8c" startline="375" endline="388">rope_forward_qk</references>
        <references refid="structCKLayerForwardParamsQ4K_1a1923b2ba97133951c6705efd90978c72" compoundref="ckernel__orchestration_8h" startline="287">CKLayerForwardParamsQ4K::rope_pos_offset</references>
        <references refid="structCKLayerForwardParamsQ4K_1a716869dbb8759abc3d3d236ba7482383" compoundref="ckernel__orchestration_8h" startline="294">CKLayerForwardParamsQ4K::rope_sin</references>
        <references refid="structCKLayerForwardParamsQ4K_1a976fb97749625cdc0f8e16e690c5e5a0" compoundref="ckernel__orchestration_8h" startline="324">CKLayerForwardParamsQ4K::swiglu_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7b17e1545dee689697df5da4751de3ea" compoundref="ckernel__orchestration_8h" startline="315">CKLayerForwardParamsQ4K::v</references>
        <references refid="structCKLayerForwardParamsQ4K_1aafad2b7a679b5775026053a2b3cf82b1" compoundref="ckernel__orchestration_8h" startline="306">CKLayerForwardParamsQ4K::w1</references>
        <references refid="structCKLayerForwardParamsQ4K_1ac06d139d08ab948841316c9ff74987f2" compoundref="ckernel__orchestration_8h" startline="332">CKLayerForwardParamsQ4K::w1_dtype</references>
        <references refid="structCKLayerForwardParamsQ4K_1aac721dc3d07b7f9f3a0fcbdc6101e4bb" compoundref="ckernel__orchestration_8h" startline="308">CKLayerForwardParamsQ4K::w2</references>
        <references refid="structCKLayerForwardParamsQ4K_1a07d7c68eeabbb2d5702ba6bdb13a3ebb" compoundref="ckernel__orchestration_8h" startline="333">CKLayerForwardParamsQ4K::w2_dtype</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad6e110f69299b040cd07f83ed612548b" compoundref="ckernel__orchestration_8h" startline="298">CKLayerForwardParamsQ4K::wk</references>
        <references refid="structCKLayerForwardParamsQ4K_1a150feea348e2b0c728b05364bc291d68" compoundref="ckernel__orchestration_8h" startline="329">CKLayerForwardParamsQ4K::wk_dtype</references>
        <references refid="structCKLayerForwardParamsQ4K_1a52ce0d74a3fdff1ea8b04030a733fc1d" compoundref="ckernel__orchestration_8h" startline="303">CKLayerForwardParamsQ4K::wo</references>
        <references refid="structCKLayerForwardParamsQ4K_1aaebd5f600a687e1e30800e831ecc5cb6" compoundref="ckernel__orchestration_8h" startline="331">CKLayerForwardParamsQ4K::wo_dtype</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2b71fe14402b1fa2a52ff6d212a42a21" compoundref="ckernel__orchestration_8h" startline="296">CKLayerForwardParamsQ4K::wq</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad7671a4ac45c1d65be5e28c03c700d2a" compoundref="ckernel__orchestration_8h" startline="328">CKLayerForwardParamsQ4K::wq_dtype</references>
        <references refid="structCKLayerForwardParamsQ4K_1a35349f8d709bd6b19b8bdc1b46cbf10f" compoundref="ckernel__orchestration_8h" startline="300">CKLayerForwardParamsQ4K::wv</references>
        <references refid="structCKLayerForwardParamsQ4K_1a1ed95932b94db2f9a45cdb1cc987f6da" compoundref="ckernel__orchestration_8h" startline="330">CKLayerForwardParamsQ4K::wv_dtype</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1a7b9d9ef1181d1fa0f7c8b19eefb7846d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_forward_rmsnorm_swiglu_q4_k</definition>
        <argsstring>(const CKLayerForwardParamsQ4K *p)</argsstring>
        <name>ck_layer_forward_rmsnorm_swiglu_q4_k</name>
        <param>
          <type>const <ref refid="structCKLayerForwardParamsQ4K" kindref="compound">CKLayerForwardParamsQ4K</ref> *</type>
          <declname>p</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="336" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="1652" bodyend="1855" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="336" declcolumn="6"/>
        <references refid="structCKLayerForwardParamsQ4K_1abf258991c7054233b5c72f0370862c42" compoundref="ckernel__orchestration_8h" startline="283">CKLayerForwardParamsQ4K::aligned_context_window</references>
        <references refid="structCKLayerForwardParamsQ4K_1a00e5d63076d9e3306bb3b189a47b1e14" compoundref="ckernel__orchestration_8h" startline="278">CKLayerForwardParamsQ4K::aligned_embed_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1ada91d4c0f5e6040aca475655f7f1bcab" compoundref="ckernel__orchestration_8h" startline="282">CKLayerForwardParamsQ4K::aligned_head_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1a4384a52ba7c2f30d4895d3edd4321cab" compoundref="ckernel__orchestration_8h" startline="285">CKLayerForwardParamsQ4K::aligned_intermediate_dim</references>
        <references refid="ckernel__engine_8h_1a3e1aa7c55e515fd996318da27c2c5ade" compoundref="attention__kernels_8c" startline="195" endline="253">attention_forward_causal_head_major_gqa</references>
        <references refid="ckernel__engine_8h_1aac305a28084fe73b2264ae57613ba3ea" compoundref="attention__kernels_8c" startline="749" endline="796">attention_forward_causal_head_major_gqa_flash</references>
        <references refid="structCKLayerForwardParamsQ4K_1a3372d9668e65bc5a77fcdb3e69547af3" compoundref="ckernel__orchestration_8h" startline="317">CKLayerForwardParamsQ4K::attn_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2aecde76c05afca045048df499be02f5" compoundref="ckernel__orchestration_8h" startline="307">CKLayerForwardParamsQ4K::b1</references>
        <references refid="structCKLayerForwardParamsQ4K_1a715be17f92fbcb0aa10ce00dcde62939" compoundref="ckernel__orchestration_8h" startline="309">CKLayerForwardParamsQ4K::b2</references>
        <references refid="structCKLayerForwardParamsQ4K_1a882236cfb15923ee4962013a53f893a0" compoundref="ckernel__orchestration_8h" startline="299">CKLayerForwardParamsQ4K::bk</references>
        <references refid="structCKLayerForwardParamsQ4K_1aaaba47dd4ef07fdb1a6662a88c2014cb" compoundref="ckernel__orchestration_8h" startline="304">CKLayerForwardParamsQ4K::bo</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5624ab23e1e9c41d5ea3b4b9e8569d03" compoundref="ckernel__orchestration_8h" startline="297">CKLayerForwardParamsQ4K::bq</references>
        <references refid="structCKLayerForwardParamsQ4K_1a1c7b2b14198b4296631e7169eec94919" compoundref="ckernel__orchestration_8h" startline="301">CKLayerForwardParamsQ4K::bv</references>
        <references refid="ckernel__orchestration_8c_1a4369f2c106b80c1888b99fe709b07f6c" compoundref="ckernel__orchestration_8c" startline="253" endline="287">ck_attention_project_head_major_q4_k</references>
        <references refid="ckernel__orchestration_8c_1a9656efa18c286d6551c636aa5b340761" compoundref="ckernel__orchestration_8c" startline="1506" endline="1548">ck_attention_project_head_major_q4_k_q8_k</references>
        <references refid="ckernel__orchestration_8c_1a9be0b5aaccd3e66b10a9ec0505ae8877" compoundref="ckernel__orchestration_8c" startline="347" endline="367">ck_mlp_swiglu_forward_q4_k</references>
        <references refid="ckernel__orchestration_8c_1ad6aa365279862f31a7bd98385374a268" compoundref="ckernel__orchestration_8c" startline="1550" endline="1597">ck_mlp_swiglu_forward_q4_k_q8_k_prefill</references>
        <references refid="ckernel__orchestration_8c_1a45ad329928b675ddc00ad3d5059335b3" compoundref="ckernel__orchestration_8c" startline="88" endline="107">ck_q8k_activations_enabled</references>
        <references refid="ckernel__orchestration_8c_1a476de61245e906fadb26c1af7c0dafb3" compoundref="ckernel__orchestration_8c" startline="146" endline="193">ck_qkv_project_head_major_q4_k</references>
        <references refid="ckernel__orchestration_8c_1a40623acc041514b7bed2c76c246091f7" compoundref="ckernel__orchestration_8c" startline="1441" endline="1504">ck_qkv_project_head_major_q4_k_q8_k</references>
        <references refid="ckernel__orchestration_8c_1ab0948def8f4a6c6fd8a5288aacd22f01" compoundref="ckernel__orchestration_8c" startline="15" endline="25">ck_residual_add_token_major</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad8373aa2774d6b69c1e4ea1d151d2646" compoundref="ckernel__orchestration_8h" startline="277">CKLayerForwardParamsQ4K::embed_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1a002187e74b3fa26e39bd17a965c72f8b" compoundref="ckernel__orchestration_8h" startline="286">CKLayerForwardParamsQ4K::eps</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7871fd5d96ccc288a12c6e08415c82dc" compoundref="ckernel__orchestration_8h" startline="323">CKLayerForwardParamsQ4K::fc1_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a8f8ca9f6b17918a424041cc9003229e9" compoundref="ckernel__orchestration_8h" startline="281">CKLayerForwardParamsQ4K::head_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad73e1dbeb642314392d9bd140dd0aff8" compoundref="ckernel__orchestration_8h" startline="289">CKLayerForwardParamsQ4K::input</references>
        <references refid="structCKLayerForwardParamsQ4K_1a31e2ba79a8c69429c6e31c20ee1c6efa" compoundref="ckernel__orchestration_8h" startline="314">CKLayerForwardParamsQ4K::k</references>
        <references refid="structCKLayerForwardParamsQ4K_1afae06ea5bb1f1d1aed99a1bfd54dd6bf" compoundref="ckernel__orchestration_8h" startline="290">CKLayerForwardParamsQ4K::ln1_gamma</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7ea6e14a98a47d72837f92f2a5601566" compoundref="ckernel__orchestration_8h" startline="311">CKLayerForwardParamsQ4K::ln1_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a658fef23434f9427fab5f76ef0cea95a" compoundref="ckernel__orchestration_8h" startline="312">CKLayerForwardParamsQ4K::ln1_rstd</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5241512944a07c6e9e9beee22d05c566" compoundref="ckernel__orchestration_8h" startline="291">CKLayerForwardParamsQ4K::ln2_gamma</references>
        <references refid="structCKLayerForwardParamsQ4K_1af0407fc50e027301417628d774a41ff3" compoundref="ckernel__orchestration_8h" startline="321">CKLayerForwardParamsQ4K::ln2_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2309c41abca4ad1bc357dd780e55fecb" compoundref="ckernel__orchestration_8h" startline="322">CKLayerForwardParamsQ4K::ln2_rstd</references>
        <references refid="structCKLayerForwardParamsQ4K_1a755532817e588edf60f4f9cf86f52f07" compoundref="ckernel__orchestration_8h" startline="325">CKLayerForwardParamsQ4K::mlp_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5f55a51a93b0a9b2f02520fd02c8dd0e" compoundref="ckernel__orchestration_8h" startline="279">CKLayerForwardParamsQ4K::num_heads</references>
        <references refid="structCKLayerForwardParamsQ4K_1aac37dcd8276a700a4a0123a4f3af8dc3" compoundref="ckernel__orchestration_8h" startline="280">CKLayerForwardParamsQ4K::num_kv_heads</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2532f454e8565aafe5bc975e518e90e2" compoundref="ckernel__orchestration_8h" startline="326">CKLayerForwardParamsQ4K::output</references>
        <references refid="structCKLayerForwardParamsQ4K_1ac6fb5da685cc15ae713f5760f2c05c41" compoundref="ckernel__orchestration_8h" startline="319">CKLayerForwardParamsQ4K::proj_scratch</references>
        <references refid="structCKLayerForwardParamsQ4K_1a66da64885aa1cf87cb9e687ad7fcd34b" compoundref="ckernel__orchestration_8h" startline="318">CKLayerForwardParamsQ4K::proj_tmp</references>
        <references refid="structCKLayerForwardParamsQ4K_1a63efa0f23630574508730fb141c113e9" compoundref="ckernel__orchestration_8h" startline="313">CKLayerForwardParamsQ4K::q</references>
        <references refid="ckernel__quant_8h_1afd2f43dcca46f268b2008cb200198e50" compoundref="ckernel__quant_8h" startline="69">QK_K</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7ae4c7affb31c2e7a6ad09688e56ba42" compoundref="ckernel__orchestration_8h" startline="320">CKLayerForwardParamsQ4K::residual1</references>
        <references refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" compoundref="rmsnorm__kernels_8c" startline="30" endline="144">rmsnorm_forward</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2ddfb5a4e6442a028d7475dc1e9266cd" compoundref="ckernel__orchestration_8h" startline="293">CKLayerForwardParamsQ4K::rope_cos</references>
        <references refid="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" compoundref="rope__kernels_8c" startline="375" endline="388">rope_forward_qk</references>
        <references refid="structCKLayerForwardParamsQ4K_1a1923b2ba97133951c6705efd90978c72" compoundref="ckernel__orchestration_8h" startline="287">CKLayerForwardParamsQ4K::rope_pos_offset</references>
        <references refid="structCKLayerForwardParamsQ4K_1a716869dbb8759abc3d3d236ba7482383" compoundref="ckernel__orchestration_8h" startline="294">CKLayerForwardParamsQ4K::rope_sin</references>
        <references refid="structCKLayerForwardParamsQ4K_1a9b6d571cb8120f8b62ca87a176edb0f2" compoundref="ckernel__orchestration_8h" startline="316">CKLayerForwardParamsQ4K::scores</references>
        <references refid="structCKLayerForwardParamsQ4K_1a976fb97749625cdc0f8e16e690c5e5a0" compoundref="ckernel__orchestration_8h" startline="324">CKLayerForwardParamsQ4K::swiglu_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a70dcc9d69d068743233b527d879154b1" compoundref="ckernel__orchestration_8h" startline="276">CKLayerForwardParamsQ4K::tokens</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7b17e1545dee689697df5da4751de3ea" compoundref="ckernel__orchestration_8h" startline="315">CKLayerForwardParamsQ4K::v</references>
        <references refid="structCKLayerForwardParamsQ4K_1aafad2b7a679b5775026053a2b3cf82b1" compoundref="ckernel__orchestration_8h" startline="306">CKLayerForwardParamsQ4K::w1</references>
        <references refid="structCKLayerForwardParamsQ4K_1aac721dc3d07b7f9f3a0fcbdc6101e4bb" compoundref="ckernel__orchestration_8h" startline="308">CKLayerForwardParamsQ4K::w2</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad6e110f69299b040cd07f83ed612548b" compoundref="ckernel__orchestration_8h" startline="298">CKLayerForwardParamsQ4K::wk</references>
        <references refid="structCKLayerForwardParamsQ4K_1a52ce0d74a3fdff1ea8b04030a733fc1d" compoundref="ckernel__orchestration_8h" startline="303">CKLayerForwardParamsQ4K::wo</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2b71fe14402b1fa2a52ff6d212a42a21" compoundref="ckernel__orchestration_8h" startline="296">CKLayerForwardParamsQ4K::wq</references>
        <references refid="structCKLayerForwardParamsQ4K_1a35349f8d709bd6b19b8bdc1b46cbf10f" compoundref="ckernel__orchestration_8h" startline="300">CKLayerForwardParamsQ4K::wv</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1a4bfddd851b4b52f7502330118a3e853d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_forward_rmsnorm_swiglu_quant</definition>
        <argsstring>(const CKLayerForwardParamsQ4K *p)</argsstring>
        <name>ck_layer_forward_rmsnorm_swiglu_quant</name>
        <param>
          <type>const <ref refid="structCKLayerForwardParamsQ4K" kindref="compound">CKLayerForwardParamsQ4K</ref> *</type>
          <declname>p</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="340" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="2128" bodyend="2236" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="340" declcolumn="6"/>
        <references refid="structCKLayerForwardParamsQ4K_1abf258991c7054233b5c72f0370862c42" compoundref="ckernel__orchestration_8h" startline="283">CKLayerForwardParamsQ4K::aligned_context_window</references>
        <references refid="structCKLayerForwardParamsQ4K_1a00e5d63076d9e3306bb3b189a47b1e14" compoundref="ckernel__orchestration_8h" startline="278">CKLayerForwardParamsQ4K::aligned_embed_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1ada91d4c0f5e6040aca475655f7f1bcab" compoundref="ckernel__orchestration_8h" startline="282">CKLayerForwardParamsQ4K::aligned_head_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1a4384a52ba7c2f30d4895d3edd4321cab" compoundref="ckernel__orchestration_8h" startline="285">CKLayerForwardParamsQ4K::aligned_intermediate_dim</references>
        <references refid="ckernel__engine_8h_1a3e1aa7c55e515fd996318da27c2c5ade" compoundref="attention__kernels_8c" startline="195" endline="253">attention_forward_causal_head_major_gqa</references>
        <references refid="ckernel__engine_8h_1aac305a28084fe73b2264ae57613ba3ea" compoundref="attention__kernels_8c" startline="749" endline="796">attention_forward_causal_head_major_gqa_flash</references>
        <references refid="structCKLayerForwardParamsQ4K_1a3372d9668e65bc5a77fcdb3e69547af3" compoundref="ckernel__orchestration_8h" startline="317">CKLayerForwardParamsQ4K::attn_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2aecde76c05afca045048df499be02f5" compoundref="ckernel__orchestration_8h" startline="307">CKLayerForwardParamsQ4K::b1</references>
        <references refid="structCKLayerForwardParamsQ4K_1a715be17f92fbcb0aa10ce00dcde62939" compoundref="ckernel__orchestration_8h" startline="309">CKLayerForwardParamsQ4K::b2</references>
        <references refid="structCKLayerForwardParamsQ4K_1a882236cfb15923ee4962013a53f893a0" compoundref="ckernel__orchestration_8h" startline="299">CKLayerForwardParamsQ4K::bk</references>
        <references refid="structCKLayerForwardParamsQ4K_1aaaba47dd4ef07fdb1a6662a88c2014cb" compoundref="ckernel__orchestration_8h" startline="304">CKLayerForwardParamsQ4K::bo</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5624ab23e1e9c41d5ea3b4b9e8569d03" compoundref="ckernel__orchestration_8h" startline="297">CKLayerForwardParamsQ4K::bq</references>
        <references refid="structCKLayerForwardParamsQ4K_1a1c7b2b14198b4296631e7169eec94919" compoundref="ckernel__orchestration_8h" startline="301">CKLayerForwardParamsQ4K::bv</references>
        <references refid="ckernel__orchestration_8c_1a107109f43bf909569b9ab2dd75bffb18" compoundref="ckernel__orchestration_8c" startline="289" endline="345">ck_attention_project_head_major_quant</references>
        <references refid="ckernel__orchestration_8c_1a3754c7725e77065577179096b396c075" compoundref="ckernel__orchestration_8c" startline="369" endline="391">ck_mlp_swiglu_forward_quant</references>
        <references refid="ckernel__orchestration_8c_1aa1ebc47c823d864fbbe18d975df74704" compoundref="ckernel__orchestration_8c" startline="195" endline="251">ck_qkv_project_head_major_quant</references>
        <references refid="ckernel__orchestration_8c_1ab0948def8f4a6c6fd8a5288aacd22f01" compoundref="ckernel__orchestration_8c" startline="15" endline="25">ck_residual_add_token_major</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad8373aa2774d6b69c1e4ea1d151d2646" compoundref="ckernel__orchestration_8h" startline="277">CKLayerForwardParamsQ4K::embed_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1a002187e74b3fa26e39bd17a965c72f8b" compoundref="ckernel__orchestration_8h" startline="286">CKLayerForwardParamsQ4K::eps</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7871fd5d96ccc288a12c6e08415c82dc" compoundref="ckernel__orchestration_8h" startline="323">CKLayerForwardParamsQ4K::fc1_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a8f8ca9f6b17918a424041cc9003229e9" compoundref="ckernel__orchestration_8h" startline="281">CKLayerForwardParamsQ4K::head_dim</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad73e1dbeb642314392d9bd140dd0aff8" compoundref="ckernel__orchestration_8h" startline="289">CKLayerForwardParamsQ4K::input</references>
        <references refid="structCKLayerForwardParamsQ4K_1a31e2ba79a8c69429c6e31c20ee1c6efa" compoundref="ckernel__orchestration_8h" startline="314">CKLayerForwardParamsQ4K::k</references>
        <references refid="structCKLayerForwardParamsQ4K_1afae06ea5bb1f1d1aed99a1bfd54dd6bf" compoundref="ckernel__orchestration_8h" startline="290">CKLayerForwardParamsQ4K::ln1_gamma</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7ea6e14a98a47d72837f92f2a5601566" compoundref="ckernel__orchestration_8h" startline="311">CKLayerForwardParamsQ4K::ln1_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a658fef23434f9427fab5f76ef0cea95a" compoundref="ckernel__orchestration_8h" startline="312">CKLayerForwardParamsQ4K::ln1_rstd</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5241512944a07c6e9e9beee22d05c566" compoundref="ckernel__orchestration_8h" startline="291">CKLayerForwardParamsQ4K::ln2_gamma</references>
        <references refid="structCKLayerForwardParamsQ4K_1af0407fc50e027301417628d774a41ff3" compoundref="ckernel__orchestration_8h" startline="321">CKLayerForwardParamsQ4K::ln2_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2309c41abca4ad1bc357dd780e55fecb" compoundref="ckernel__orchestration_8h" startline="322">CKLayerForwardParamsQ4K::ln2_rstd</references>
        <references refid="structCKLayerForwardParamsQ4K_1a755532817e588edf60f4f9cf86f52f07" compoundref="ckernel__orchestration_8h" startline="325">CKLayerForwardParamsQ4K::mlp_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a5f55a51a93b0a9b2f02520fd02c8dd0e" compoundref="ckernel__orchestration_8h" startline="279">CKLayerForwardParamsQ4K::num_heads</references>
        <references refid="structCKLayerForwardParamsQ4K_1aac37dcd8276a700a4a0123a4f3af8dc3" compoundref="ckernel__orchestration_8h" startline="280">CKLayerForwardParamsQ4K::num_kv_heads</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2532f454e8565aafe5bc975e518e90e2" compoundref="ckernel__orchestration_8h" startline="326">CKLayerForwardParamsQ4K::output</references>
        <references refid="structCKLayerForwardParamsQ4K_1ac6fb5da685cc15ae713f5760f2c05c41" compoundref="ckernel__orchestration_8h" startline="319">CKLayerForwardParamsQ4K::proj_scratch</references>
        <references refid="structCKLayerForwardParamsQ4K_1a66da64885aa1cf87cb9e687ad7fcd34b" compoundref="ckernel__orchestration_8h" startline="318">CKLayerForwardParamsQ4K::proj_tmp</references>
        <references refid="structCKLayerForwardParamsQ4K_1a63efa0f23630574508730fb141c113e9" compoundref="ckernel__orchestration_8h" startline="313">CKLayerForwardParamsQ4K::q</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7ae4c7affb31c2e7a6ad09688e56ba42" compoundref="ckernel__orchestration_8h" startline="320">CKLayerForwardParamsQ4K::residual1</references>
        <references refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" compoundref="rmsnorm__kernels_8c" startline="30" endline="144">rmsnorm_forward</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2ddfb5a4e6442a028d7475dc1e9266cd" compoundref="ckernel__orchestration_8h" startline="293">CKLayerForwardParamsQ4K::rope_cos</references>
        <references refid="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" compoundref="rope__kernels_8c" startline="375" endline="388">rope_forward_qk</references>
        <references refid="structCKLayerForwardParamsQ4K_1a1923b2ba97133951c6705efd90978c72" compoundref="ckernel__orchestration_8h" startline="287">CKLayerForwardParamsQ4K::rope_pos_offset</references>
        <references refid="structCKLayerForwardParamsQ4K_1a716869dbb8759abc3d3d236ba7482383" compoundref="ckernel__orchestration_8h" startline="294">CKLayerForwardParamsQ4K::rope_sin</references>
        <references refid="structCKLayerForwardParamsQ4K_1a9b6d571cb8120f8b62ca87a176edb0f2" compoundref="ckernel__orchestration_8h" startline="316">CKLayerForwardParamsQ4K::scores</references>
        <references refid="structCKLayerForwardParamsQ4K_1a976fb97749625cdc0f8e16e690c5e5a0" compoundref="ckernel__orchestration_8h" startline="324">CKLayerForwardParamsQ4K::swiglu_out</references>
        <references refid="structCKLayerForwardParamsQ4K_1a70dcc9d69d068743233b527d879154b1" compoundref="ckernel__orchestration_8h" startline="276">CKLayerForwardParamsQ4K::tokens</references>
        <references refid="structCKLayerForwardParamsQ4K_1a7b17e1545dee689697df5da4751de3ea" compoundref="ckernel__orchestration_8h" startline="315">CKLayerForwardParamsQ4K::v</references>
        <references refid="structCKLayerForwardParamsQ4K_1aafad2b7a679b5775026053a2b3cf82b1" compoundref="ckernel__orchestration_8h" startline="306">CKLayerForwardParamsQ4K::w1</references>
        <references refid="structCKLayerForwardParamsQ4K_1ac06d139d08ab948841316c9ff74987f2" compoundref="ckernel__orchestration_8h" startline="332">CKLayerForwardParamsQ4K::w1_dtype</references>
        <references refid="structCKLayerForwardParamsQ4K_1aac721dc3d07b7f9f3a0fcbdc6101e4bb" compoundref="ckernel__orchestration_8h" startline="308">CKLayerForwardParamsQ4K::w2</references>
        <references refid="structCKLayerForwardParamsQ4K_1a07d7c68eeabbb2d5702ba6bdb13a3ebb" compoundref="ckernel__orchestration_8h" startline="333">CKLayerForwardParamsQ4K::w2_dtype</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad6e110f69299b040cd07f83ed612548b" compoundref="ckernel__orchestration_8h" startline="298">CKLayerForwardParamsQ4K::wk</references>
        <references refid="structCKLayerForwardParamsQ4K_1a150feea348e2b0c728b05364bc291d68" compoundref="ckernel__orchestration_8h" startline="329">CKLayerForwardParamsQ4K::wk_dtype</references>
        <references refid="structCKLayerForwardParamsQ4K_1a52ce0d74a3fdff1ea8b04030a733fc1d" compoundref="ckernel__orchestration_8h" startline="303">CKLayerForwardParamsQ4K::wo</references>
        <references refid="structCKLayerForwardParamsQ4K_1aaebd5f600a687e1e30800e831ecc5cb6" compoundref="ckernel__orchestration_8h" startline="331">CKLayerForwardParamsQ4K::wo_dtype</references>
        <references refid="structCKLayerForwardParamsQ4K_1a2b71fe14402b1fa2a52ff6d212a42a21" compoundref="ckernel__orchestration_8h" startline="296">CKLayerForwardParamsQ4K::wq</references>
        <references refid="structCKLayerForwardParamsQ4K_1ad7671a4ac45c1d65be5e28c03c700d2a" compoundref="ckernel__orchestration_8h" startline="328">CKLayerForwardParamsQ4K::wq_dtype</references>
        <references refid="structCKLayerForwardParamsQ4K_1a35349f8d709bd6b19b8bdc1b46cbf10f" compoundref="ckernel__orchestration_8h" startline="300">CKLayerForwardParamsQ4K::wv</references>
        <references refid="structCKLayerForwardParamsQ4K_1a1ed95932b94db2f9a45cdb1cc987f6da" compoundref="ckernel__orchestration_8h" startline="330">CKLayerForwardParamsQ4K::wv_dtype</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1acc9d893cdd6cf7bf0dbf35d42c5f0e99" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_layer_forward_rmsnorm_swiglu_ref</definition>
        <argsstring>(const CKLayerForwardParams *p)</argsstring>
        <name>ck_layer_forward_rmsnorm_swiglu_ref</name>
        <param>
          <type>const <ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref> *</type>
          <declname>p</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="229" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="856" bodyend="961" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="229" declcolumn="6"/>
        <references refid="structCKLayerForwardParams_1a7bc3195febcef409f9bbbbbd55b55840" compoundref="ckernel__orchestration_8h" startline="19">CKLayerForwardParams::aligned_context_window</references>
        <references refid="structCKLayerForwardParams_1adcd26186adf7f31c20dbdfed35cc0d88" compoundref="ckernel__orchestration_8h" startline="14">CKLayerForwardParams::aligned_embed_dim</references>
        <references refid="structCKLayerForwardParams_1a4eb2bdb409cf3a010bbb554a98e61e65" compoundref="ckernel__orchestration_8h" startline="18">CKLayerForwardParams::aligned_head_dim</references>
        <references refid="structCKLayerForwardParams_1add2c7b423bea0a7261e1fbdc2820d3d6" compoundref="ckernel__orchestration_8h" startline="21">CKLayerForwardParams::aligned_intermediate_dim</references>
        <references refid="ckernel__engine_8h_1a3e1aa7c55e515fd996318da27c2c5ade" compoundref="attention__kernels_8c" startline="195" endline="253">attention_forward_causal_head_major_gqa</references>
        <references refid="ckernel__engine_8h_1aac305a28084fe73b2264ae57613ba3ea" compoundref="attention__kernels_8c" startline="749" endline="796">attention_forward_causal_head_major_gqa_flash</references>
        <references refid="structCKLayerForwardParams_1af592e985b232ee6a07522504bff59ff8" compoundref="ckernel__orchestration_8h" startline="53">CKLayerForwardParams::attn_out</references>
        <references refid="structCKLayerForwardParams_1a8b216d5540d147750b5b7d6ebe238445" compoundref="ckernel__orchestration_8h" startline="43">CKLayerForwardParams::b1</references>
        <references refid="structCKLayerForwardParams_1acc91fa02742733363b55e38ff2305e7f" compoundref="ckernel__orchestration_8h" startline="45">CKLayerForwardParams::b2</references>
        <references refid="structCKLayerForwardParams_1a7e508ab8ae215c31fbae4f78b23d5929" compoundref="ckernel__orchestration_8h" startline="35">CKLayerForwardParams::bk</references>
        <references refid="structCKLayerForwardParams_1ae1e3ff68d1bc957125df225fec96dcc2" compoundref="ckernel__orchestration_8h" startline="40">CKLayerForwardParams::bo</references>
        <references refid="structCKLayerForwardParams_1a1002972e750e6b75ba1151cc4de47a05" compoundref="ckernel__orchestration_8h" startline="33">CKLayerForwardParams::bq</references>
        <references refid="structCKLayerForwardParams_1ab2e6f98706c4822473bee01a6b4c46d6" compoundref="ckernel__orchestration_8h" startline="37">CKLayerForwardParams::bv</references>
        <references refid="ckernel__orchestration_8c_1a34e3e4ce864cbfd383097bcf417124ad" compoundref="ckernel__orchestration_8c" startline="518" endline="551">ck_attention_project_head_major_ref</references>
        <references refid="ckernel__orchestration_8c_1ac841f4e0a273b07808cc036a715b742e" compoundref="ckernel__orchestration_8c" startline="727" endline="747">ck_mlp_swiglu_forward_ref</references>
        <references refid="ckernel__orchestration_8c_1a3678c4745f6b4d3f39e3c07cdff6db12" compoundref="ckernel__orchestration_8c" startline="428" endline="470">ck_qkv_project_head_major_ref</references>
        <references refid="ckernel__orchestration_8c_1ab0948def8f4a6c6fd8a5288aacd22f01" compoundref="ckernel__orchestration_8c" startline="15" endline="25">ck_residual_add_token_major</references>
        <references refid="structCKLayerForwardParams_1a0a48ad009d13315fb1a18ec1f9aff5c8" compoundref="ckernel__orchestration_8h" startline="13">CKLayerForwardParams::embed_dim</references>
        <references refid="structCKLayerForwardParams_1a63e37652b3bb5e0d394ea70af0895595" compoundref="ckernel__orchestration_8h" startline="22">CKLayerForwardParams::eps</references>
        <references refid="structCKLayerForwardParams_1a7ca0c2bd14cfcde3504bd43030609e4b" compoundref="ckernel__orchestration_8h" startline="59">CKLayerForwardParams::fc1_out</references>
        <references refid="structCKLayerForwardParams_1a5aac19a779c176623a55fd48bb9502cf" compoundref="ckernel__orchestration_8h" startline="17">CKLayerForwardParams::head_dim</references>
        <references refid="structCKLayerForwardParams_1ad678ed659e2a04e07062a4aff3fe50a7" compoundref="ckernel__orchestration_8h" startline="25">CKLayerForwardParams::input</references>
        <references refid="structCKLayerForwardParams_1ac4abe1c97c14c49d953ae5dd8f910c96" compoundref="ckernel__orchestration_8h" startline="50">CKLayerForwardParams::k</references>
        <references refid="structCKLayerForwardParams_1a4a3337a600f787d4b2fe9ab83f7594c9" compoundref="ckernel__orchestration_8h" startline="26">CKLayerForwardParams::ln1_gamma</references>
        <references refid="structCKLayerForwardParams_1a58ea21593e7b3dfba61b3847843345ff" compoundref="ckernel__orchestration_8h" startline="47">CKLayerForwardParams::ln1_out</references>
        <references refid="structCKLayerForwardParams_1a402aac9e95e1c00fc1de2ab5a423a82d" compoundref="ckernel__orchestration_8h" startline="48">CKLayerForwardParams::ln1_rstd</references>
        <references refid="structCKLayerForwardParams_1aace627c9eb6644fac5c3fc5a4748f1f4" compoundref="ckernel__orchestration_8h" startline="27">CKLayerForwardParams::ln2_gamma</references>
        <references refid="structCKLayerForwardParams_1a122026c6f33e91f706fc37dab39c10b2" compoundref="ckernel__orchestration_8h" startline="57">CKLayerForwardParams::ln2_out</references>
        <references refid="structCKLayerForwardParams_1a4bad26d55e52ce0462fb8b4081880a0f" compoundref="ckernel__orchestration_8h" startline="58">CKLayerForwardParams::ln2_rstd</references>
        <references refid="structCKLayerForwardParams_1a86060e45304124966b764eb8db0365b7" compoundref="ckernel__orchestration_8h" startline="61">CKLayerForwardParams::mlp_out</references>
        <references refid="structCKLayerForwardParams_1a6ef0a14fb20cf0840ecc43d05ece08a5" compoundref="ckernel__orchestration_8h" startline="15">CKLayerForwardParams::num_heads</references>
        <references refid="structCKLayerForwardParams_1a16731d5e0724c25e7b807955d41be75a" compoundref="ckernel__orchestration_8h" startline="16">CKLayerForwardParams::num_kv_heads</references>
        <references refid="structCKLayerForwardParams_1a61d1bcef2bcffd12c7a49d243a6c51d1" compoundref="ckernel__orchestration_8h" startline="62">CKLayerForwardParams::output</references>
        <references refid="structCKLayerForwardParams_1a1d16cc6fe19fb9e3b934eccba86c35b0" compoundref="ckernel__orchestration_8h" startline="55">CKLayerForwardParams::proj_scratch</references>
        <references refid="structCKLayerForwardParams_1a1fa5c8ae6f1c35f1edd9041c6007731d" compoundref="ckernel__orchestration_8h" startline="54">CKLayerForwardParams::proj_tmp</references>
        <references refid="structCKLayerForwardParams_1a6d0ecfad1a74e3fe0583785851741e71" compoundref="ckernel__orchestration_8h" startline="49">CKLayerForwardParams::q</references>
        <references refid="structCKLayerForwardParams_1a97ce8698227c9cf419c8e21d17cebc12" compoundref="ckernel__orchestration_8h" startline="56">CKLayerForwardParams::residual1</references>
        <references refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" compoundref="rmsnorm__kernels_8c" startline="30" endline="144">rmsnorm_forward</references>
        <references refid="structCKLayerForwardParams_1a3be9a0f9fae1ab8fddc30e14628d74a0" compoundref="ckernel__orchestration_8h" startline="29">CKLayerForwardParams::rope_cos</references>
        <references refid="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" compoundref="rope__kernels_8c" startline="375" endline="388">rope_forward_qk</references>
        <references refid="structCKLayerForwardParams_1ad0e18a97d0cd2746890333bcc2d0d0e1" compoundref="ckernel__orchestration_8h" startline="23">CKLayerForwardParams::rope_pos_offset</references>
        <references refid="structCKLayerForwardParams_1a332fc12fb11a99adfd72dba034c56ea7" compoundref="ckernel__orchestration_8h" startline="30">CKLayerForwardParams::rope_sin</references>
        <references refid="structCKLayerForwardParams_1a9b1930ef9e3d94dae2f16bacd354dc2d" compoundref="ckernel__orchestration_8h" startline="52">CKLayerForwardParams::scores</references>
        <references refid="structCKLayerForwardParams_1a64b3c9bf08573696fe23f773e0af3f4a" compoundref="ckernel__orchestration_8h" startline="60">CKLayerForwardParams::swiglu_out</references>
        <references refid="structCKLayerForwardParams_1a9b2e8d95ad724035dc4ef7d8f2aeb2b8" compoundref="ckernel__orchestration_8h" startline="12">CKLayerForwardParams::tokens</references>
        <references refid="structCKLayerForwardParams_1ac49cad0850ce2e111044fc2114783d16" compoundref="ckernel__orchestration_8h" startline="51">CKLayerForwardParams::v</references>
        <references refid="structCKLayerForwardParams_1a72a52720f195370d45e7cc00a6985651" compoundref="ckernel__orchestration_8h" startline="42">CKLayerForwardParams::w1</references>
        <references refid="structCKLayerForwardParams_1a070376c4c42bb40d7cdd919ea74c669b" compoundref="ckernel__orchestration_8h" startline="44">CKLayerForwardParams::w2</references>
        <references refid="structCKLayerForwardParams_1a14ca061d781c1ed9631ff94df3e6278b" compoundref="ckernel__orchestration_8h" startline="34">CKLayerForwardParams::wk</references>
        <references refid="structCKLayerForwardParams_1a98753685d03e778a1d655f8f3cd486ea" compoundref="ckernel__orchestration_8h" startline="39">CKLayerForwardParams::wo</references>
        <references refid="structCKLayerForwardParams_1a621ed21298acc47932068d4a97ba72d7" compoundref="ckernel__orchestration_8h" startline="32">CKLayerForwardParams::wq</references>
        <references refid="structCKLayerForwardParams_1a7e8ccf20ccec87eb230737334d589f5d" compoundref="ckernel__orchestration_8h" startline="36">CKLayerForwardParams::wv</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1a2e894b79792aaf694427446c1d89fab8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_mlp_swiglu_forward</definition>
        <argsstring>(const float *input, const float *w1, const float *b1, const float *w2, const float *b2, float *fc1_out, float *swiglu_out, float *output, int tokens, int aligned_embed_dim, int aligned_intermediate_dim)</argsstring>
        <name>ck_mlp_swiglu_forward</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>w1</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b1</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>w2</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b2</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>fc1_out</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>swiglu_out</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_intermediate_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="193" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="705" bodyend="725" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="193" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1af4f0e756d3ac00b45ce2c7a296b61ae3" compoundref="gemm__kernels_8c" startline="642" endline="733">gemm_blocked_serial</references>
        <references refid="ckernel__engine_8h_1a26369aa07808fb6aae4502d54a1ba650" compoundref="swiglu__kernels_8c" startline="111" endline="182">swiglu_forward</references>
        <referencedby refid="ckernel__orchestration_8h_1ab7dfa86e5bb0d80f0e346f85e870cb1d" compoundref="ckernel__orchestration_8c" startline="749" endline="854">ck_layer_forward_rmsnorm_swiglu</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1a745d032ebb518826e284b4a3680a8cb5" compoundref="ckernel__orchestration_8c" startline="1040" endline="1196">ck_layer_forward_rmsnorm_swiglu_decode</referencedby>
        <referencedby refid="attention__decode__fused_8c_1a1e6628f9f140c9749a6dd7c2c9ce263a" compoundref="attention__decode__fused_8c" startline="165" endline="323">ck_layer_forward_rmsnorm_swiglu_decode_fused_attn_impl</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1a6aaebd943ca5ad278729a207b401ab45" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_mlp_swiglu_forward_fully_fused_token</definition>
        <argsstring>(const float *input_row, const float *w1, const float *b1, const float *w2, const float *b2, float *output_row, int aligned_embed_dim, int aligned_intermediate_dim)</argsstring>
        <name>ck_mlp_swiglu_forward_fully_fused_token</name>
        <param>
          <type>const float *</type>
          <declname>input_row</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>w1</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b1</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>w2</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b2</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output_row</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_intermediate_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="219" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="998" bodyend="1038" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="219" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1ac7e379fa8eb4c8b963e70daf7e761277" compoundref="mlp__fused__decode_8c" startline="304" endline="404">fused_mlp_swiglu_decode_v2</references>
        <referencedby refid="ckernel__orchestration_8h_1ab8d674c4a63b69a0cc0b38bbe58fa9f2" compoundref="ckernel__orchestration_8c" startline="1198" endline="1349">ck_layer_forward_rmsnorm_swiglu_decode_fused</referencedby>
        <referencedby refid="attention__decode__fused_8c_1a1e6628f9f140c9749a6dd7c2c9ce263a" compoundref="attention__decode__fused_8c" startline="165" endline="323">ck_layer_forward_rmsnorm_swiglu_decode_fused_attn_impl</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1a266b9c19eafb8e11f3e51253c8dd0b45" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_mlp_swiglu_forward_fused_token</definition>
        <argsstring>(const float *input_row, const float *w1, const float *b1, const float *w2, const float *b2, float *swiglu_row, float *output_row, int aligned_embed_dim, int aligned_intermediate_dim)</argsstring>
        <name>ck_mlp_swiglu_forward_fused_token</name>
        <param>
          <type>const float *</type>
          <declname>input_row</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>w1</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b1</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>w2</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b2</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>swiglu_row</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output_row</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_intermediate_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="205" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="963" bodyend="996" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="205" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1af4f0e756d3ac00b45ce2c7a296b61ae3" compoundref="gemm__kernels_8c" startline="642" endline="733">gemm_blocked_serial</references>
        <references refid="ckernel__engine_8h_1a2ae3bbf03cebc529c1e7962a7dba2568" compoundref="gemm__fused__kernels_8c" startline="231" endline="306">gemm_swiglu_fused</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1ae1c428e05f8ea7795136ae8b160b8a0a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_qkv_project_head_major</definition>
        <argsstring>(const float *input, const float *wq, const float *bq, const float *wk, const float *bk, const float *wv, const float *bv, float *q, float *k, float *v, int tokens, int aligned_embed_dim, int num_heads, int num_kv_heads, int aligned_head_dim)</argsstring>
        <name>ck_qkv_project_head_major</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wq</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bq</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wk</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bk</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wv</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bv</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>k</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>v</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="151" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="44" bodyend="86" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="151" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1af4f0e756d3ac00b45ce2c7a296b61ae3" compoundref="gemm__kernels_8c" startline="642" endline="733">gemm_blocked_serial</references>
        <referencedby refid="ckernel__orchestration_8h_1ab7dfa86e5bb0d80f0e346f85e870cb1d" compoundref="ckernel__orchestration_8c" startline="749" endline="854">ck_layer_forward_rmsnorm_swiglu</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1aae6b6e1796c190320ef20f0476dc2e9d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_qkv_project_head_major_backward</definition>
        <argsstring>(const float *d_q, const float *d_k, const float *d_v, const float *input, const float *wq, const float *bq, const float *wk, const float *bk, const float *wv, const float *bv, float *d_input, float *d_wq, float *d_bq, float *d_wk, float *d_bk, float *d_wv, float *d_bv, float *scratch, int tokens, int aligned_embed_dim, int num_heads, int num_kv_heads, int aligned_head_dim, int num_threads)</argsstring>
        <name>ck_qkv_project_head_major_backward</name>
        <param>
          <type>const float *</type>
          <declname>d_q</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>d_k</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>d_v</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wq</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bq</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wk</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bk</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wv</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bv</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_wq</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_bq</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_wk</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_bk</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_wv</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_bv</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>scratch</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_threads</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="362" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="609" bodyend="703" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="362" declcolumn="6"/>
        <references refid="ckernel__orchestration_8c_1a0020aef4ce512b3840b824a46e206dca" compoundref="ckernel__orchestration_8c" startline="472" endline="481">ck_add_inplace</references>
        <references refid="ckernel__engine_8h_1a89a29fc853aae0baf9f6094fee52562a" compoundref="mlp__kernels_8c" startline="99" endline="137">fc2_backward_kernel</references>
        <referencedby refid="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" compoundref="ckernel__orchestration_8c" startline="2410" endline="2550">ck_layer_backward_rmsnorm_swiglu</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1ab6c6524b0f30733a077e3783bb55a592" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_qkv_project_head_major_token</definition>
        <argsstring>(const float *input_row, const float *wq, const float *bq, const float *wk, const float *bk, const float *wv, const float *bv, float *q_token, float *k_token, float *v_token, int aligned_embed_dim, int num_heads, int num_kv_heads, int aligned_head_dim)</argsstring>
        <name>ck_qkv_project_head_major_token</name>
        <param>
          <type>const float *</type>
          <declname>input_row</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wq</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bq</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wk</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bk</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>wv</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bv</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>q_token</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>k_token</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>v_token</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="162" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_decode_fused.c" bodystart="62" bodyend="97" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="162" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1af4f0e756d3ac00b45ce2c7a296b61ae3" compoundref="gemm__kernels_8c" startline="642" endline="733">gemm_blocked_serial</references>
        <referencedby refid="ckernel__orchestration_8h_1a745d032ebb518826e284b4a3680a8cb5" compoundref="ckernel__orchestration_8c" startline="1040" endline="1196">ck_layer_forward_rmsnorm_swiglu_decode</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1ab8d674c4a63b69a0cc0b38bbe58fa9f2" compoundref="ckernel__orchestration_8c" startline="1198" endline="1349">ck_layer_forward_rmsnorm_swiglu_decode_fused</referencedby>
        <referencedby refid="attention__decode__fused_8c_1a1e6628f9f140c9749a6dd7c2c9ce263a" compoundref="attention__decode__fused_8c" startline="165" endline="323">ck_layer_forward_rmsnorm_swiglu_decode_fused_attn_impl</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1a35426895690beefd7b84cf090639b169" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_residual_add_backward</definition>
        <argsstring>(const float *d_out, float *d_a, float *d_b, int tokens, int aligned_embed_dim)</argsstring>
        <name>ck_residual_add_backward</name>
        <param>
          <type>const float *</type>
          <declname>d_out</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_a</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_b</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="345" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="27" bodyend="42" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="345" declcolumn="6"/>
        <referencedby refid="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" compoundref="ckernel__orchestration_8c" startline="2410" endline="2550">ck_layer_backward_rmsnorm_swiglu</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__orchestration_8h_1ab0948def8f4a6c6fd8a5288aacd22f01" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_residual_add_token_major</definition>
        <argsstring>(const float *a, const float *b, float *out, int tokens, int aligned_embed_dim)</argsstring>
        <name>ck_residual_add_token_major</name>
        <param>
          <type>const float *</type>
          <declname>a</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>out</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" line="145" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_orchestration.c" bodystart="15" bodyend="25" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h" declline="145" declcolumn="6"/>
        <referencedby refid="ckernel__orchestration_8h_1ab7dfa86e5bb0d80f0e346f85e870cb1d" compoundref="ckernel__orchestration_8c" startline="749" endline="854">ck_layer_forward_rmsnorm_swiglu</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1a745d032ebb518826e284b4a3680a8cb5" compoundref="ckernel__orchestration_8c" startline="1040" endline="1196">ck_layer_forward_rmsnorm_swiglu_decode</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1ab8d674c4a63b69a0cc0b38bbe58fa9f2" compoundref="ckernel__orchestration_8c" startline="1198" endline="1349">ck_layer_forward_rmsnorm_swiglu_decode_fused</referencedby>
        <referencedby refid="attention__decode__fused_8c_1a1e6628f9f140c9749a6dd7c2c9ce263a" compoundref="attention__decode__fused_8c" startline="165" endline="323">ck_layer_forward_rmsnorm_swiglu_decode_fused_attn_impl</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1abb01994013418ff7b8be71dc9bdcded5" compoundref="ckernel__orchestration_8c" startline="1857" endline="2126">ck_layer_forward_rmsnorm_swiglu_decode_q4_k</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1ae07680f1a438bd1824fa4b1c3e4e826e" compoundref="ckernel__orchestration_8c" startline="2238" endline="2408">ck_layer_forward_rmsnorm_swiglu_decode_quant</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1a7b9d9ef1181d1fa0f7c8b19eefb7846d" compoundref="ckernel__orchestration_8c" startline="1652" endline="1855">ck_layer_forward_rmsnorm_swiglu_q4_k</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1a4bfddd851b4b52f7502330118a3e853d" compoundref="ckernel__orchestration_8c" startline="2128" endline="2236">ck_layer_forward_rmsnorm_swiglu_quant</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1acc9d893cdd6cf7bf0dbf35d42c5f0e99" compoundref="ckernel__orchestration_8c" startline="856" endline="961">ck_layer_forward_rmsnorm_swiglu_ref</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#ifndef<sp/>CKERNEL_ORCHESTRATION_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CKERNEL_ORCHESTRATION_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ckernel__dtype_8h" kindref="compound">ckernel_dtype.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11" refid="structCKLayerForwardParams" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="12" refid="structCKLayerForwardParams_1a9b2e8d95ad724035dc4ef7d8f2aeb2b8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1a9b2e8d95ad724035dc4ef7d8f2aeb2b8" kindref="member">tokens</ref>;</highlight></codeline>
<codeline lineno="13" refid="structCKLayerForwardParams_1a0a48ad009d13315fb1a18ec1f9aff5c8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1a0a48ad009d13315fb1a18ec1f9aff5c8" kindref="member">embed_dim</ref>;</highlight></codeline>
<codeline lineno="14" refid="structCKLayerForwardParams_1adcd26186adf7f31c20dbdfed35cc0d88" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1adcd26186adf7f31c20dbdfed35cc0d88" kindref="member">aligned_embed_dim</ref>;</highlight></codeline>
<codeline lineno="15" refid="structCKLayerForwardParams_1a6ef0a14fb20cf0840ecc43d05ece08a5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1a6ef0a14fb20cf0840ecc43d05ece08a5" kindref="member">num_heads</ref>;</highlight></codeline>
<codeline lineno="16" refid="structCKLayerForwardParams_1a16731d5e0724c25e7b807955d41be75a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1a16731d5e0724c25e7b807955d41be75a" kindref="member">num_kv_heads</ref>;</highlight></codeline>
<codeline lineno="17" refid="structCKLayerForwardParams_1a5aac19a779c176623a55fd48bb9502cf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1a5aac19a779c176623a55fd48bb9502cf" kindref="member">head_dim</ref>;</highlight></codeline>
<codeline lineno="18" refid="structCKLayerForwardParams_1a4eb2bdb409cf3a010bbb554a98e61e65" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1a4eb2bdb409cf3a010bbb554a98e61e65" kindref="member">aligned_head_dim</ref>;</highlight></codeline>
<codeline lineno="19" refid="structCKLayerForwardParams_1a7bc3195febcef409f9bbbbbd55b55840" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1a7bc3195febcef409f9bbbbbd55b55840" kindref="member">aligned_context_window</ref>;</highlight></codeline>
<codeline lineno="20" refid="structCKLayerForwardParams_1ac1ce35724d91ff94c95707a6d879d0a9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1ac1ce35724d91ff94c95707a6d879d0a9" kindref="member">intermediate_dim</ref>;</highlight></codeline>
<codeline lineno="21" refid="structCKLayerForwardParams_1add2c7b423bea0a7261e1fbdc2820d3d6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1add2c7b423bea0a7261e1fbdc2820d3d6" kindref="member">aligned_intermediate_dim</ref>;</highlight></codeline>
<codeline lineno="22" refid="structCKLayerForwardParams_1a63e37652b3bb5e0d394ea70af0895595" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1a63e37652b3bb5e0d394ea70af0895595" kindref="member">eps</ref>;</highlight></codeline>
<codeline lineno="23" refid="structCKLayerForwardParams_1ad0e18a97d0cd2746890333bcc2d0d0e1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams_1ad0e18a97d0cd2746890333bcc2d0d0e1" kindref="member">rope_pos_offset</ref>;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25" refid="structCKLayerForwardParams_1ad678ed659e2a04e07062a4aff3fe50a7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1ad678ed659e2a04e07062a4aff3fe50a7" kindref="member">input</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26" refid="structCKLayerForwardParams_1a4a3337a600f787d4b2fe9ab83f7594c9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a4a3337a600f787d4b2fe9ab83f7594c9" kindref="member">ln1_gamma</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27" refid="structCKLayerForwardParams_1aace627c9eb6644fac5c3fc5a4748f1f4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1aace627c9eb6644fac5c3fc5a4748f1f4" kindref="member">ln2_gamma</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29" refid="structCKLayerForwardParams_1a3be9a0f9fae1ab8fddc30e14628d74a0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a3be9a0f9fae1ab8fddc30e14628d74a0" kindref="member">rope_cos</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[max_seq_len<sp/>x<sp/>head_dim/2]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30" refid="structCKLayerForwardParams_1a332fc12fb11a99adfd72dba034c56ea7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a332fc12fb11a99adfd72dba034c56ea7" kindref="member">rope_sin</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[max_seq_len<sp/>x<sp/>head_dim/2]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32" refid="structCKLayerForwardParams_1a621ed21298acc47932068d4a97ba72d7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a621ed21298acc47932068d4a97ba72d7" kindref="member">wq</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33" refid="structCKLayerForwardParams_1a1002972e750e6b75ba1151cc4de47a05" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a1002972e750e6b75ba1151cc4de47a05" kindref="member">bq</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="structCKLayerForwardParams_1a14ca061d781c1ed9631ff94df3e6278b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a14ca061d781c1ed9631ff94df3e6278b" kindref="member">wk</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="structCKLayerForwardParams_1a7e508ab8ae215c31fbae4f78b23d5929" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a7e508ab8ae215c31fbae4f78b23d5929" kindref="member">bk</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36" refid="structCKLayerForwardParams_1a7e8ccf20ccec87eb230737334d589f5d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a7e8ccf20ccec87eb230737334d589f5d" kindref="member">wv</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37" refid="structCKLayerForwardParams_1ab2e6f98706c4822473bee01a6b4c46d6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1ab2e6f98706c4822473bee01a6b4c46d6" kindref="member">bv</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="structCKLayerForwardParams_1a98753685d03e778a1d655f8f3cd486ea" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a98753685d03e778a1d655f8f3cd486ea" kindref="member">wo</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[H<sp/>x<sp/>aligned_embed_dim<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40" refid="structCKLayerForwardParams_1ae1e3ff68d1bc957125df225fec96dcc2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1ae1e3ff68d1bc957125df225fec96dcc2" kindref="member">bo</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42" refid="structCKLayerForwardParams_1a72a52720f195370d45e7cc00a6985651" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a72a52720f195370d45e7cc00a6985651" kindref="member">w1</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[2*aligned_intermediate_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43" refid="structCKLayerForwardParams_1a8b216d5540d147750b5b7d6ebe238445" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a8b216d5540d147750b5b7d6ebe238445" kindref="member">b1</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[2*aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44" refid="structCKLayerForwardParams_1a070376c4c42bb40d7cdd919ea74c669b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a070376c4c42bb40d7cdd919ea74c669b" kindref="member">w2</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim<sp/>x<sp/>aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45" refid="structCKLayerForwardParams_1acc91fa02742733363b55e38ff2305e7f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1acc91fa02742733363b55e38ff2305e7f" kindref="member">b2</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47" refid="structCKLayerForwardParams_1a58ea21593e7b3dfba61b3847843345ff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a58ea21593e7b3dfba61b3847843345ff" kindref="member">ln1_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48" refid="structCKLayerForwardParams_1a402aac9e95e1c00fc1de2ab5a423a82d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a402aac9e95e1c00fc1de2ab5a423a82d" kindref="member">ln1_rstd</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[T]<sp/>(optional)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49" refid="structCKLayerForwardParams_1a6d0ecfad1a74e3fe0583785851741e71" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a6d0ecfad1a74e3fe0583785851741e71" kindref="member">q</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50" refid="structCKLayerForwardParams_1ac4abe1c97c14c49d953ae5dd8f910c96" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1ac4abe1c97c14c49d953ae5dd8f910c96" kindref="member">k</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51" refid="structCKLayerForwardParams_1ac49cad0850ce2e111044fc2114783d16" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1ac49cad0850ce2e111044fc2114783d16" kindref="member">v</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52" refid="structCKLayerForwardParams_1a9b1930ef9e3d94dae2f16bacd354dc2d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a9b1930ef9e3d94dae2f16bacd354dc2d" kindref="member">scores</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_context_window<sp/>x<sp/>aligned_context_window]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53" refid="structCKLayerForwardParams_1af592e985b232ee6a07522504bff59ff8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1af592e985b232ee6a07522504bff59ff8" kindref="member">attn_out</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54" refid="structCKLayerForwardParams_1a1fa5c8ae6f1c35f1edd9041c6007731d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a1fa5c8ae6f1c35f1edd9041c6007731d" kindref="member">proj_tmp</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55" refid="structCKLayerForwardParams_1a1d16cc6fe19fb9e3b934eccba86c35b0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a1d16cc6fe19fb9e3b934eccba86c35b0" kindref="member">proj_scratch</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim],<sp/>required<sp/>if<sp/>num_heads<sp/>&gt;<sp/>1<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="structCKLayerForwardParams_1a97ce8698227c9cf419c8e21d17cebc12" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a97ce8698227c9cf419c8e21d17cebc12" kindref="member">residual1</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57" refid="structCKLayerForwardParams_1a122026c6f33e91f706fc37dab39c10b2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a122026c6f33e91f706fc37dab39c10b2" kindref="member">ln2_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58" refid="structCKLayerForwardParams_1a4bad26d55e52ce0462fb8b4081880a0f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a4bad26d55e52ce0462fb8b4081880a0f" kindref="member">ln2_rstd</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[T]<sp/>(optional)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59" refid="structCKLayerForwardParams_1a7ca0c2bd14cfcde3504bd43030609e4b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a7ca0c2bd14cfcde3504bd43030609e4b" kindref="member">fc1_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>2*aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60" refid="structCKLayerForwardParams_1a64b3c9bf08573696fe23f773e0af3f4a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a64b3c9bf08573696fe23f773e0af3f4a" kindref="member">swiglu_out</ref>;</highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61" refid="structCKLayerForwardParams_1a86060e45304124966b764eb8db0365b7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a86060e45304124966b764eb8db0365b7" kindref="member">mlp_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62" refid="structCKLayerForwardParams_1a61d1bcef2bcffd12c7a49d243a6c51d1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParams_1a61d1bcef2bcffd12c7a49d243a6c51d1" kindref="member">output</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal">}<sp/><ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref>;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="structCKLayerBackwardParams" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="66" refid="structCKLayerBackwardParams_1a267b127c20c2f099f1b39e1bb618a2d1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1a267b127c20c2f099f1b39e1bb618a2d1" kindref="member">tokens</ref>;</highlight></codeline>
<codeline lineno="67" refid="structCKLayerBackwardParams_1a0febb76bba354013a9f7c651010c11bf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1a0febb76bba354013a9f7c651010c11bf" kindref="member">embed_dim</ref>;</highlight></codeline>
<codeline lineno="68" refid="structCKLayerBackwardParams_1add2ab7c4a1a702cabb893466e5d7803f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1add2ab7c4a1a702cabb893466e5d7803f" kindref="member">aligned_embed_dim</ref>;</highlight></codeline>
<codeline lineno="69" refid="structCKLayerBackwardParams_1a763a742b7a501fec6ff59e1237b7bec4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1a763a742b7a501fec6ff59e1237b7bec4" kindref="member">num_heads</ref>;</highlight></codeline>
<codeline lineno="70" refid="structCKLayerBackwardParams_1afb6c0da50e07fdc05e2ad5c3e160f388" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1afb6c0da50e07fdc05e2ad5c3e160f388" kindref="member">num_kv_heads</ref>;</highlight></codeline>
<codeline lineno="71" refid="structCKLayerBackwardParams_1ace4e73b166d2b71dba81099ff55f9c5f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1ace4e73b166d2b71dba81099ff55f9c5f" kindref="member">head_dim</ref>;</highlight></codeline>
<codeline lineno="72" refid="structCKLayerBackwardParams_1ae589cf1fe9b8972084f31ac77c0bb5f1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1ae589cf1fe9b8972084f31ac77c0bb5f1" kindref="member">aligned_head_dim</ref>;</highlight></codeline>
<codeline lineno="73" refid="structCKLayerBackwardParams_1abb77f11b42f7a8c458ff3930de775b69" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1abb77f11b42f7a8c458ff3930de775b69" kindref="member">aligned_context_window</ref>;</highlight></codeline>
<codeline lineno="74" refid="structCKLayerBackwardParams_1a5b49b24d78c69f0ffbac75cea89bf697" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1a5b49b24d78c69f0ffbac75cea89bf697" kindref="member">intermediate_dim</ref>;</highlight></codeline>
<codeline lineno="75" refid="structCKLayerBackwardParams_1ac8540356f4968d0d96310f98fa42be26" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1ac8540356f4968d0d96310f98fa42be26" kindref="member">aligned_intermediate_dim</ref>;</highlight></codeline>
<codeline lineno="76" refid="structCKLayerBackwardParams_1ab6c8a9964ea61d631737361e490766c7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1ab6c8a9964ea61d631737361e490766c7" kindref="member">eps</ref>;</highlight></codeline>
<codeline lineno="77" refid="structCKLayerBackwardParams_1ab177ccef441842dede3cb9717e4deff5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams_1ab177ccef441842dede3cb9717e4deff5" kindref="member">rope_pos_offset</ref>;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79" refid="structCKLayerBackwardParams_1ac93a8ba8f46764f67690abf1991f1bf8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ac93a8ba8f46764f67690abf1991f1bf8" kindref="member">input</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="structCKLayerBackwardParams_1aae3da518cc5f67a49d2d1d332f6fb620" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1aae3da518cc5f67a49d2d1d332f6fb620" kindref="member">ln1_gamma</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81" refid="structCKLayerBackwardParams_1a888ee7a6df98528c4046b6b59b8c639c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a888ee7a6df98528c4046b6b59b8c639c" kindref="member">ln2_gamma</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82" refid="structCKLayerBackwardParams_1aa9203c2951372bedee83fd38e3ef57fb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1aa9203c2951372bedee83fd38e3ef57fb" kindref="member">ln1_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83" refid="structCKLayerBackwardParams_1a8b0ad57a979f51ad0b14df175b2c7370" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a8b0ad57a979f51ad0b14df175b2c7370" kindref="member">ln1_rstd</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[T]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="structCKLayerBackwardParams_1a5e38a1d2f02842dae26099775995852c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a5e38a1d2f02842dae26099775995852c" kindref="member">ln2_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85" refid="structCKLayerBackwardParams_1a44e7ba32918b0db85c2ddafee1b60848" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a44e7ba32918b0db85c2ddafee1b60848" kindref="member">ln2_rstd</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[T]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87" refid="structCKLayerBackwardParams_1ac9983bf5c0f086d19bce3889e2abfbe8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ac9983bf5c0f086d19bce3889e2abfbe8" kindref="member">rope_cos</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[max_seq_len<sp/>x<sp/>head_dim/2]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="structCKLayerBackwardParams_1af26bc4e2d6770ac37e07395a26c38993" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1af26bc4e2d6770ac37e07395a26c38993" kindref="member">rope_sin</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[max_seq_len<sp/>x<sp/>head_dim/2]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="90" refid="structCKLayerBackwardParams_1a1d71a5bb91c011b20ab07a6968ff8a74" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a1d71a5bb91c011b20ab07a6968ff8a74" kindref="member">wq</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91" refid="structCKLayerBackwardParams_1a83064b5cc6decef3782fd31cdaee55d0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a83064b5cc6decef3782fd31cdaee55d0" kindref="member">bq</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92" refid="structCKLayerBackwardParams_1a46302f164d918bf665f80e56179947cf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a46302f164d918bf665f80e56179947cf" kindref="member">wk</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93" refid="structCKLayerBackwardParams_1a387bfd944836cbc49baf13b1761246aa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a387bfd944836cbc49baf13b1761246aa" kindref="member">bk</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94" refid="structCKLayerBackwardParams_1a36b21e0cc015478bd7d5a83f8155d492" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a36b21e0cc015478bd7d5a83f8155d492" kindref="member">wv</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95" refid="structCKLayerBackwardParams_1a0a43398737b3990bce0677aedddd310c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a0a43398737b3990bce0677aedddd310c" kindref="member">bv</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97" refid="structCKLayerBackwardParams_1a7b75fc7ac1370a2392bd7f2dff2f91f5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a7b75fc7ac1370a2392bd7f2dff2f91f5" kindref="member">wo</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[H<sp/>x<sp/>aligned_embed_dim<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98" refid="structCKLayerBackwardParams_1acc77ca9763e3208a7cfb1c5484da23a7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1acc77ca9763e3208a7cfb1c5484da23a7" kindref="member">bo</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100" refid="structCKLayerBackwardParams_1acc46e12c5045c68eeabc8798ecde0bc0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1acc46e12c5045c68eeabc8798ecde0bc0" kindref="member">w1</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[2*aligned_intermediate_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101" refid="structCKLayerBackwardParams_1ad725b9991eca276996a97b04f5a7095f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ad725b9991eca276996a97b04f5a7095f" kindref="member">b1</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[2*aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102" refid="structCKLayerBackwardParams_1aef7a8891a18f2c6a7457375d0c0ed870" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1aef7a8891a18f2c6a7457375d0c0ed870" kindref="member">w2</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim<sp/>x<sp/>aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103" refid="structCKLayerBackwardParams_1a0b2505938624d2addd57ca43e3f5c685" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a0b2505938624d2addd57ca43e3f5c685" kindref="member">b2</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105" refid="structCKLayerBackwardParams_1aab3a0f3828a687d937a07f74131b2a3f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1aab3a0f3828a687d937a07f74131b2a3f" kindref="member">q</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106" refid="structCKLayerBackwardParams_1a7cf0c367613e3e8b9985c92916c15d7e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a7cf0c367613e3e8b9985c92916c15d7e" kindref="member">k</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107" refid="structCKLayerBackwardParams_1ada3ee32dfad069f78687e2632f024837" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ada3ee32dfad069f78687e2632f024837" kindref="member">v</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="structCKLayerBackwardParams_1a9e4a1e13e1a03430dfb1d4c35137a0c3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a9e4a1e13e1a03430dfb1d4c35137a0c3" kindref="member">scores</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_context_window<sp/>x<sp/>aligned_context_window]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109" refid="structCKLayerBackwardParams_1ab5ce33fe414d678705eb03372371d68d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ab5ce33fe414d678705eb03372371d68d" kindref="member">attn_out</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110" refid="structCKLayerBackwardParams_1abb44b9dbf412823c5d1dc2a426b68d53" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1abb44b9dbf412823c5d1dc2a426b68d53" kindref="member">residual1</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111" refid="structCKLayerBackwardParams_1ab659147877d0b736b1487b6f74a16bc4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ab659147877d0b736b1487b6f74a16bc4" kindref="member">fc1_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>2*aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112" refid="structCKLayerBackwardParams_1aa82d1124a56c3e119f2bb9336bfb364b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1aa82d1124a56c3e119f2bb9336bfb364b" kindref="member">swiglu_out</ref>;</highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114" refid="structCKLayerBackwardParams_1acdca6a8b98874d780004cf7c2649a15b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1acdca6a8b98874d780004cf7c2649a15b" kindref="member">d_output</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="structCKLayerBackwardParams_1a023a1e75829f8f420e35838f7384c3a3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a023a1e75829f8f420e35838f7384c3a3" kindref="member">d_input</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116" refid="structCKLayerBackwardParams_1a6471df0d3010d3f2abb0c0b4db7c5d97" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a6471df0d3010d3f2abb0c0b4db7c5d97" kindref="member">d_ln1_gamma</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117" refid="structCKLayerBackwardParams_1ac5c0b3c38578ab234b991272a6a60cb2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ac5c0b3c38578ab234b991272a6a60cb2" kindref="member">d_ln2_gamma</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118" refid="structCKLayerBackwardParams_1a5edd5b7050aad7e44c041ee40a0783ff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a5edd5b7050aad7e44c041ee40a0783ff" kindref="member">d_wq</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119" refid="structCKLayerBackwardParams_1a9ecf421cb2e1e6ade5e1da91a64ab9f7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a9ecf421cb2e1e6ade5e1da91a64ab9f7" kindref="member">d_bq</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120" refid="structCKLayerBackwardParams_1ab5dbe28da979dc3ec573683f5db4abd2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ab5dbe28da979dc3ec573683f5db4abd2" kindref="member">d_wk</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="121" refid="structCKLayerBackwardParams_1ac904f8f7dce8dc759c7ed6c74120c4ab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ac904f8f7dce8dc759c7ed6c74120c4ab" kindref="member">d_bk</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122" refid="structCKLayerBackwardParams_1a22e6960a2e5ea95a909e825f18d70224" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a22e6960a2e5ea95a909e825f18d70224" kindref="member">d_wv</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123" refid="structCKLayerBackwardParams_1ac86c1ddbe5f27c2a0887211e95e8c3f3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ac86c1ddbe5f27c2a0887211e95e8c3f3" kindref="member">d_bv</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124" refid="structCKLayerBackwardParams_1ad4813897637ed9497986bed56ee92642" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ad4813897637ed9497986bed56ee92642" kindref="member">d_wo</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[H<sp/>x<sp/>aligned_embed_dim<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125" refid="structCKLayerBackwardParams_1ac950096c67ae2bec22dcfe00860b78f3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ac950096c67ae2bec22dcfe00860b78f3" kindref="member">d_bo</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126" refid="structCKLayerBackwardParams_1a593dcdffe03ddd257ef56208f28aba2d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a593dcdffe03ddd257ef56208f28aba2d" kindref="member">d_w1</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[2*aligned_intermediate_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127" refid="structCKLayerBackwardParams_1ab9197d7470ebe9fbde84c93ce8742329" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ab9197d7470ebe9fbde84c93ce8742329" kindref="member">d_b1</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[2*aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128" refid="structCKLayerBackwardParams_1a716fb04babf520cbecee5e1030636a1c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a716fb04babf520cbecee5e1030636a1c" kindref="member">d_w2</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim<sp/>x<sp/>aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129" refid="structCKLayerBackwardParams_1a85571728b71c401e0dbe808ae585ded8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a85571728b71c401e0dbe808ae585ded8" kindref="member">d_b2</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131" refid="structCKLayerBackwardParams_1a2409b471e94658eb4c0e54235cb32556" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a2409b471e94658eb4c0e54235cb32556" kindref="member">d_ln1_out</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132" refid="structCKLayerBackwardParams_1a65b03d62d559a5ed23691be213b88e80" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a65b03d62d559a5ed23691be213b88e80" kindref="member">d_q</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133" refid="structCKLayerBackwardParams_1a773d205b160c60d1f00e22f305b17b01" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a773d205b160c60d1f00e22f305b17b01" kindref="member">d_k</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134" refid="structCKLayerBackwardParams_1ab7e86eac04fcbcea49e83068a69ba7e2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ab7e86eac04fcbcea49e83068a69ba7e2" kindref="member">d_v</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135" refid="structCKLayerBackwardParams_1af47c65e499530a8b3ece76388b824eed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1af47c65e499530a8b3ece76388b824eed" kindref="member">d_scores</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_context_window<sp/>x<sp/>aligned_context_window]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136" refid="structCKLayerBackwardParams_1a264bf54cc410085d63f127ebe4f46807" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a264bf54cc410085d63f127ebe4f46807" kindref="member">d_attn_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137" refid="structCKLayerBackwardParams_1a3de5fdb762dc1589913133f378a46749" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a3de5fdb762dc1589913133f378a46749" kindref="member">d_proj_tmp</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138" refid="structCKLayerBackwardParams_1a3e6cdebb8a31c2e082fb96e46e51ca54" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1a3e6cdebb8a31c2e082fb96e46e51ca54" kindref="member">d_residual1</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="139" refid="structCKLayerBackwardParams_1ac7774ba926f53b73bb48dd32516b5203" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ac7774ba926f53b73bb48dd32516b5203" kindref="member">d_ln2_out</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140" refid="structCKLayerBackwardParams_1ac6168273eb256fd282bbbe9d56d80665" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ac6168273eb256fd282bbbe9d56d80665" kindref="member">d_fc1_out</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>2*aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141" refid="structCKLayerBackwardParams_1ad6bb7e7d63201723843d2eeba8139147" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1ad6bb7e7d63201723843d2eeba8139147" kindref="member">d_swiglu_out</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142" refid="structCKLayerBackwardParams_1aabe923efab694bfed90a3d86084c9be9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerBackwardParams_1aabe923efab694bfed90a3d86084c9be9" kindref="member">d_mlp_out</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal">}<sp/><ref refid="structCKLayerBackwardParams" kindref="compound">CKLayerBackwardParams</ref>;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1ab0948def8f4a6c6fd8a5288aacd22f01" kindref="member">ck_residual_add_token_major</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*a,</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b,</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*out,</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1ae1c428e05f8ea7795136ae8b160b8a0a" kindref="member">ck_qkv_project_head_major</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wq,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bq,</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wk,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bk,</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wv,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bv,</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*q,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*v,</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim);</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1ab6c6524b0f30733a077e3783bb55a592" kindref="member">ck_qkv_project_head_major_token</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input_row,</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wq,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bq,</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wk,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bk,</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wv,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bv,</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*q_token,</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k_token,</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*v_token,</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1a2afc01d06448f40b94c48a51a6951dc5" kindref="member">ck_attention_project_head_major</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*attn_out,</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wo,</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bo,</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*out,</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*scratch,</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim);</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1ade31f5d0f381b108e331db103adc6251" kindref="member">ck_attention_project_head_major_decode_token</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*attn_token,</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wo,</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bo,</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*out_token,</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>embed_dim,</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1a2e894b79792aaf694427446c1d89fab8" kindref="member">ck_mlp_swiglu_forward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*w1,</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b1,</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*w2,</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b2,</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*fc1_out,</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*swiglu_out,</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_intermediate_dim);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1a266b9c19eafb8e11f3e51253c8dd0b45" kindref="member">ck_mlp_swiglu_forward_fused_token</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input_row,</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*w1,</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b1,</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*w2,</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b2,</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*swiglu_row,</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output_row,</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_intermediate_dim);</highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Fully<sp/>fused<sp/>MLP<sp/>for<sp/>decode<sp/>(single<sp/>token).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight><highlight class="comment">//<sp/>All<sp/>three<sp/>projections<sp/>(gate,<sp/>up,<sp/>down)<sp/>fused<sp/>into<sp/>one<sp/>kernel.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Eliminates<sp/>DRAM<sp/>round-trip<sp/>for<sp/>intermediate<sp/>swiglu<sp/>values.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Best<sp/>for<sp/>AVX-512<sp/>systems<sp/>with<sp/>many<sp/>cores<sp/>(24+).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1a6aaebd943ca5ad278729a207b401ab45" kindref="member">ck_mlp_swiglu_forward_fully_fused_token</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input_row,</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*w1,</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b1,</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*w2,</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b2,</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output_row,</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_intermediate_dim);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1ab7dfa86e5bb0d80f0e346f85e870cb1d" kindref="member">ck_layer_forward_rmsnorm_swiglu</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref><sp/>*p);</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1acc9d893cdd6cf7bf0dbf35d42c5f0e99" kindref="member">ck_layer_forward_rmsnorm_swiglu_ref</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref><sp/>*p);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Decode-style<sp/>layer<sp/>forward<sp/>for<sp/>autoregressive<sp/>generation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Computes<sp/>only<sp/>a<sp/>single<sp/>token<sp/>at<sp/>`token_index`,<sp/>while<sp/>attending<sp/>over<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight><highlight class="comment">//<sp/>KV-cache<sp/>stored<sp/>in<sp/>`p-&gt;k`/`p-&gt;v`<sp/>in<sp/>head-major<sp/>cache<sp/>layout:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>k/v:<sp/>[num_kv_heads,<sp/>cache_capacity,<sp/>aligned_head_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight><highlight class="comment">//<sp/>The<sp/>caller<sp/>is<sp/>responsible<sp/>for:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>-<sp/>ensuring<sp/>`p-&gt;k`/`p-&gt;v`<sp/>already<sp/>contain<sp/>tokens<sp/>[0..token_index-1]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>-<sp/>setting<sp/>`p-&gt;rope_pos_offset`<sp/>to<sp/>the<sp/>absolute<sp/>position<sp/>for<sp/>this<sp/>token</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>-<sp/>passing<sp/>a<sp/>matching<sp/>`cache_capacity`<sp/>(usually<sp/>model<sp/>context_window)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1a745d032ebb518826e284b4a3680a8cb5" kindref="member">ck_layer_forward_rmsnorm_swiglu_decode</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref><sp/>*p,</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_index,</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cache_capacity);</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Decode-style<sp/>layer<sp/>forward<sp/>using<sp/>fused<sp/>SwiGLU<sp/>(gate+up)<sp/>matvec.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Inference-only<sp/>fast<sp/>path:<sp/>produces<sp/>the<sp/>same<sp/>outputs<sp/>as<sp/>the<sp/>unfused<sp/>decode<sp/>path.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1ab8d674c4a63b69a0cc0b38bbe58fa9f2" kindref="member">ck_layer_forward_rmsnorm_swiglu_decode_fused</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref><sp/>*p,</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_index,</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cache_capacity);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Decode-style<sp/>layer<sp/>forward<sp/>using<sp/>fused<sp/>attention<sp/>(QKV+RoPE+KV+attention+Wo).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Optionally<sp/>pairs<sp/>with<sp/>fused<sp/>SwiGLU<sp/>via<sp/>ck_layer_forward_rmsnorm_swiglu_decode_fused_attn_mlp.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1ad466e4eeb1c0ab92d9c9bf15cb51f679" kindref="member">ck_layer_forward_rmsnorm_swiglu_decode_fused_attn</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref><sp/>*p,</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_index,</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cache_capacity);</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1a50899fc552648f5d1cadd0e4c5671dc1" kindref="member">ck_layer_forward_rmsnorm_swiglu_decode_fused_attn_mlp</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParams" kindref="compound">CKLayerForwardParams</ref><sp/>*p,</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_index,</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cache_capacity);</highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>============================================================================</highlight></codeline>
<codeline lineno="262"><highlight class="comment"><sp/>*<sp/>Quantized<sp/>(Q4_K<sp/>/<sp/>Q4_K_M)<sp/>inference<sp/>orchestration</highlight></codeline>
<codeline lineno="263"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="264"><highlight class="comment"><sp/>*<sp/>These<sp/>entry<sp/>points<sp/>mirror<sp/>the<sp/>fp32<sp/>paths<sp/>but<sp/>accept<sp/>weight<sp/>matrices<sp/>stored</highlight></codeline>
<codeline lineno="265"><highlight class="comment"><sp/>*<sp/>in<sp/>GGML-compatible<sp/>Q4_K<sp/>blocks.<sp/>Activations<sp/>remain<sp/>fp32<sp/>by<sp/>default;<sp/>the</highlight></codeline>
<codeline lineno="266"><highlight class="comment"><sp/>*<sp/>decode<sp/>path<sp/>can<sp/>switch<sp/>to<sp/>Q8_K<sp/>activations<sp/>via<sp/>CK_Q8K_ACTIVATIONS=1<sp/>(or</highlight></codeline>
<codeline lineno="267"><highlight class="comment"><sp/>*<sp/>auto-enable<sp/>when<sp/>strict<sp/>parity<sp/>is<sp/>off).</highlight></codeline>
<codeline lineno="268"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="269"><highlight class="comment"><sp/>*<sp/>Design<sp/>note:</highlight></codeline>
<codeline lineno="270"><highlight class="comment"><sp/>*<sp/><sp/>-<sp/>If<sp/>you<sp/>enable<sp/>Q4_K<sp/>weights,<sp/>ensure<sp/>the<sp/>relevant<sp/>K<sp/>dimensions<sp/>are<sp/>a</highlight></codeline>
<codeline lineno="271"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>multiple<sp/>of<sp/>256<sp/>(QK_K).<sp/>The<sp/>engine<sp/>keeps<sp/>the<sp/>quantized<sp/>weights<sp/>in<sp/>their</highlight></codeline>
<codeline lineno="272"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>compact<sp/>block<sp/>form<sp/>and<sp/>dequantizes<sp/>on-the-fly<sp/>inside<sp/>GEMM/GEMV<sp/>kernels.</highlight></codeline>
<codeline lineno="273"><highlight class="comment"><sp/>*<sp/>============================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275" refid="structCKLayerForwardParamsQ4K" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="276" refid="structCKLayerForwardParamsQ4K_1a70dcc9d69d068743233b527d879154b1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1a70dcc9d69d068743233b527d879154b1" kindref="member">tokens</ref>;</highlight></codeline>
<codeline lineno="277" refid="structCKLayerForwardParamsQ4K_1ad8373aa2774d6b69c1e4ea1d151d2646" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1ad8373aa2774d6b69c1e4ea1d151d2646" kindref="member">embed_dim</ref>;</highlight></codeline>
<codeline lineno="278" refid="structCKLayerForwardParamsQ4K_1a00e5d63076d9e3306bb3b189a47b1e14" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1a00e5d63076d9e3306bb3b189a47b1e14" kindref="member">aligned_embed_dim</ref>;</highlight></codeline>
<codeline lineno="279" refid="structCKLayerForwardParamsQ4K_1a5f55a51a93b0a9b2f02520fd02c8dd0e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1a5f55a51a93b0a9b2f02520fd02c8dd0e" kindref="member">num_heads</ref>;</highlight></codeline>
<codeline lineno="280" refid="structCKLayerForwardParamsQ4K_1aac37dcd8276a700a4a0123a4f3af8dc3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1aac37dcd8276a700a4a0123a4f3af8dc3" kindref="member">num_kv_heads</ref>;</highlight></codeline>
<codeline lineno="281" refid="structCKLayerForwardParamsQ4K_1a8f8ca9f6b17918a424041cc9003229e9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1a8f8ca9f6b17918a424041cc9003229e9" kindref="member">head_dim</ref>;</highlight></codeline>
<codeline lineno="282" refid="structCKLayerForwardParamsQ4K_1ada91d4c0f5e6040aca475655f7f1bcab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1ada91d4c0f5e6040aca475655f7f1bcab" kindref="member">aligned_head_dim</ref>;</highlight></codeline>
<codeline lineno="283" refid="structCKLayerForwardParamsQ4K_1abf258991c7054233b5c72f0370862c42" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1abf258991c7054233b5c72f0370862c42" kindref="member">aligned_context_window</ref>;</highlight></codeline>
<codeline lineno="284" refid="structCKLayerForwardParamsQ4K_1af9afcd6bc50e22482a16dd1237aee02e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1af9afcd6bc50e22482a16dd1237aee02e" kindref="member">intermediate_dim</ref>;</highlight></codeline>
<codeline lineno="285" refid="structCKLayerForwardParamsQ4K_1a4384a52ba7c2f30d4895d3edd4321cab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1a4384a52ba7c2f30d4895d3edd4321cab" kindref="member">aligned_intermediate_dim</ref>;</highlight></codeline>
<codeline lineno="286" refid="structCKLayerForwardParamsQ4K_1a002187e74b3fa26e39bd17a965c72f8b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1a002187e74b3fa26e39bd17a965c72f8b" kindref="member">eps</ref>;</highlight></codeline>
<codeline lineno="287" refid="structCKLayerForwardParamsQ4K_1a1923b2ba97133951c6705efd90978c72" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K_1a1923b2ba97133951c6705efd90978c72" kindref="member">rope_pos_offset</ref>;</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289" refid="structCKLayerForwardParamsQ4K_1ad73e1dbeb642314392d9bd140dd0aff8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1ad73e1dbeb642314392d9bd140dd0aff8" kindref="member">input</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290" refid="structCKLayerForwardParamsQ4K_1afae06ea5bb1f1d1aed99a1bfd54dd6bf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1afae06ea5bb1f1d1aed99a1bfd54dd6bf" kindref="member">ln1_gamma</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291" refid="structCKLayerForwardParamsQ4K_1a5241512944a07c6e9e9beee22d05c566" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a5241512944a07c6e9e9beee22d05c566" kindref="member">ln2_gamma</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293" refid="structCKLayerForwardParamsQ4K_1a2ddfb5a4e6442a028d7475dc1e9266cd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a2ddfb5a4e6442a028d7475dc1e9266cd" kindref="member">rope_cos</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[max_seq_len<sp/>x<sp/>head_dim/2]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="294" refid="structCKLayerForwardParamsQ4K_1a716869dbb8759abc3d3d236ba7482383" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a716869dbb8759abc3d3d236ba7482383" kindref="member">rope_sin</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[max_seq_len<sp/>x<sp/>head_dim/2]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="296" refid="structCKLayerForwardParamsQ4K_1a2b71fe14402b1fa2a52ff6d212a42a21" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a2b71fe14402b1fa2a52ff6d212a42a21" kindref="member">wq</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Q4_K:<sp/>[num_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="297" refid="structCKLayerForwardParamsQ4K_1a5624ab23e1e9c41d5ea3b4b9e8569d03" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a5624ab23e1e9c41d5ea3b4b9e8569d03" kindref="member">bq</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298" refid="structCKLayerForwardParamsQ4K_1ad6e110f69299b040cd07f83ed612548b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1ad6e110f69299b040cd07f83ed612548b" kindref="member">wk</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Q4_K:<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299" refid="structCKLayerForwardParamsQ4K_1a882236cfb15923ee4962013a53f893a0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a882236cfb15923ee4962013a53f893a0" kindref="member">bk</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300" refid="structCKLayerForwardParamsQ4K_1a35349f8d709bd6b19b8bdc1b46cbf10f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a35349f8d709bd6b19b8bdc1b46cbf10f" kindref="member">wv</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Q4_K:<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301" refid="structCKLayerForwardParamsQ4K_1a1c7b2b14198b4296631e7169eec94919" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a1c7b2b14198b4296631e7169eec94919" kindref="member">bv</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303" refid="structCKLayerForwardParamsQ4K_1a52ce0d74a3fdff1ea8b04030a733fc1d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a52ce0d74a3fdff1ea8b04030a733fc1d" kindref="member">wo</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Q4_K:<sp/>[aligned_embed_dim<sp/>x<sp/>(num_heads*aligned_head_dim)]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304" refid="structCKLayerForwardParamsQ4K_1aaaba47dd4ef07fdb1a6662a88c2014cb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1aaaba47dd4ef07fdb1a6662a88c2014cb" kindref="member">bo</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight></codeline>
<codeline lineno="306" refid="structCKLayerForwardParamsQ4K_1aafad2b7a679b5775026053a2b3cf82b1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1aafad2b7a679b5775026053a2b3cf82b1" kindref="member">w1</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Q4_K:<sp/>[2*aligned_intermediate_dim<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="307" refid="structCKLayerForwardParamsQ4K_1a2aecde76c05afca045048df499be02f5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a2aecde76c05afca045048df499be02f5" kindref="member">b1</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[2*aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="308" refid="structCKLayerForwardParamsQ4K_1aac721dc3d07b7f9f3a0fcbdc6101e4bb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1aac721dc3d07b7f9f3a0fcbdc6101e4bb" kindref="member">w2</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Q4_K:<sp/>[aligned_embed_dim<sp/>x<sp/>aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309" refid="structCKLayerForwardParamsQ4K_1a715be17f92fbcb0aa10ce00dcde62939" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a715be17f92fbcb0aa10ce00dcde62939" kindref="member">b2</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="311" refid="structCKLayerForwardParamsQ4K_1a7ea6e14a98a47d72837f92f2a5601566" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a7ea6e14a98a47d72837f92f2a5601566" kindref="member">ln1_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312" refid="structCKLayerForwardParamsQ4K_1a658fef23434f9427fab5f76ef0cea95a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a658fef23434f9427fab5f76ef0cea95a" kindref="member">ln1_rstd</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[T]<sp/>(optional)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313" refid="structCKLayerForwardParamsQ4K_1a63efa0f23630574508730fb141c113e9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a63efa0f23630574508730fb141c113e9" kindref="member">q</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314" refid="structCKLayerForwardParamsQ4K_1a31e2ba79a8c69429c6e31c20ee1c6efa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a31e2ba79a8c69429c6e31c20ee1c6efa" kindref="member">k</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315" refid="structCKLayerForwardParamsQ4K_1a7b17e1545dee689697df5da4751de3ea" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a7b17e1545dee689697df5da4751de3ea" kindref="member">v</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_kv_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="316" refid="structCKLayerForwardParamsQ4K_1a9b6d571cb8120f8b62ca87a176edb0f2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a9b6d571cb8120f8b62ca87a176edb0f2" kindref="member">scores</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>aligned_context_window<sp/>x<sp/>aligned_context_window]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317" refid="structCKLayerForwardParamsQ4K_1a3372d9668e65bc5a77fcdb3e69547af3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a3372d9668e65bc5a77fcdb3e69547af3" kindref="member">attn_out</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[num_heads<sp/>x<sp/>T<sp/>x<sp/>aligned_head_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="318" refid="structCKLayerForwardParamsQ4K_1a66da64885aa1cf87cb9e687ad7fcd34b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a66da64885aa1cf87cb9e687ad7fcd34b" kindref="member">proj_tmp</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="319" refid="structCKLayerForwardParamsQ4K_1ac6fb5da685cc15ae713f5760f2c05c41" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1ac6fb5da685cc15ae713f5760f2c05c41" kindref="member">proj_scratch</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim],<sp/>required<sp/>(transpose<sp/>buffer)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320" refid="structCKLayerForwardParamsQ4K_1a7ae4c7affb31c2e7a6ad09688e56ba42" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a7ae4c7affb31c2e7a6ad09688e56ba42" kindref="member">residual1</ref>;<sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321" refid="structCKLayerForwardParamsQ4K_1af0407fc50e027301417628d774a41ff3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1af0407fc50e027301417628d774a41ff3" kindref="member">ln2_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="322" refid="structCKLayerForwardParamsQ4K_1a2309c41abca4ad1bc357dd780e55fecb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a2309c41abca4ad1bc357dd780e55fecb" kindref="member">ln2_rstd</ref>;<sp/><sp/></highlight><highlight class="comment">/*<sp/>[T]<sp/>(optional)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323" refid="structCKLayerForwardParamsQ4K_1a7871fd5d96ccc288a12c6e08415c82dc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a7871fd5d96ccc288a12c6e08415c82dc" kindref="member">fc1_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>2*aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="324" refid="structCKLayerForwardParamsQ4K_1a976fb97749625cdc0f8e16e690c5e5a0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a976fb97749625cdc0f8e16e690c5e5a0" kindref="member">swiglu_out</ref>;</highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_intermediate_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="325" refid="structCKLayerForwardParamsQ4K_1a755532817e588edf60f4f9cf86f52f07" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a755532817e588edf60f4f9cf86f52f07" kindref="member">mlp_out</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="326" refid="structCKLayerForwardParamsQ4K_1a2532f454e8565aafe5bc975e518e90e2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*<ref refid="structCKLayerForwardParamsQ4K_1a2532f454e8565aafe5bc975e518e90e2" kindref="member">output</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[T<sp/>x<sp/>aligned_embed_dim]<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328" refid="structCKLayerForwardParamsQ4K_1ad7671a4ac45c1d65be5e28c03c700d2a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ckernel__dtype_8h_1a9d2373b6c685cf9421a6fb638964aa65" kindref="member">CKDataType</ref><sp/><ref refid="structCKLayerForwardParamsQ4K_1ad7671a4ac45c1d65be5e28c03c700d2a" kindref="member">wq_dtype</ref>;</highlight></codeline>
<codeline lineno="329" refid="structCKLayerForwardParamsQ4K_1a150feea348e2b0c728b05364bc291d68" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ckernel__dtype_8h_1a9d2373b6c685cf9421a6fb638964aa65" kindref="member">CKDataType</ref><sp/><ref refid="structCKLayerForwardParamsQ4K_1a150feea348e2b0c728b05364bc291d68" kindref="member">wk_dtype</ref>;</highlight></codeline>
<codeline lineno="330" refid="structCKLayerForwardParamsQ4K_1a1ed95932b94db2f9a45cdb1cc987f6da" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ckernel__dtype_8h_1a9d2373b6c685cf9421a6fb638964aa65" kindref="member">CKDataType</ref><sp/><ref refid="structCKLayerForwardParamsQ4K_1a1ed95932b94db2f9a45cdb1cc987f6da" kindref="member">wv_dtype</ref>;</highlight></codeline>
<codeline lineno="331" refid="structCKLayerForwardParamsQ4K_1aaebd5f600a687e1e30800e831ecc5cb6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ckernel__dtype_8h_1a9d2373b6c685cf9421a6fb638964aa65" kindref="member">CKDataType</ref><sp/><ref refid="structCKLayerForwardParamsQ4K_1aaebd5f600a687e1e30800e831ecc5cb6" kindref="member">wo_dtype</ref>;</highlight></codeline>
<codeline lineno="332" refid="structCKLayerForwardParamsQ4K_1ac06d139d08ab948841316c9ff74987f2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ckernel__dtype_8h_1a9d2373b6c685cf9421a6fb638964aa65" kindref="member">CKDataType</ref><sp/><ref refid="structCKLayerForwardParamsQ4K_1ac06d139d08ab948841316c9ff74987f2" kindref="member">w1_dtype</ref>;</highlight></codeline>
<codeline lineno="333" refid="structCKLayerForwardParamsQ4K_1a07d7c68eeabbb2d5702ba6bdb13a3ebb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ckernel__dtype_8h_1a9d2373b6c685cf9421a6fb638964aa65" kindref="member">CKDataType</ref><sp/><ref refid="structCKLayerForwardParamsQ4K_1a07d7c68eeabbb2d5702ba6bdb13a3ebb" kindref="member">w2_dtype</ref>;</highlight></codeline>
<codeline lineno="334"><highlight class="normal">}<sp/><ref refid="structCKLayerForwardParamsQ4K" kindref="compound">CKLayerForwardParamsQ4K</ref>;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1a7b9d9ef1181d1fa0f7c8b19eefb7846d" kindref="member">ck_layer_forward_rmsnorm_swiglu_q4_k</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K" kindref="compound">CKLayerForwardParamsQ4K</ref><sp/>*p);</highlight></codeline>
<codeline lineno="337"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1abb01994013418ff7b8be71dc9bdcded5" kindref="member">ck_layer_forward_rmsnorm_swiglu_decode_q4_k</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K" kindref="compound">CKLayerForwardParamsQ4K</ref><sp/>*p,</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_index,</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cache_capacity);</highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1a4bfddd851b4b52f7502330118a3e853d" kindref="member">ck_layer_forward_rmsnorm_swiglu_quant</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K" kindref="compound">CKLayerForwardParamsQ4K</ref><sp/>*p);</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1ae07680f1a438bd1824fa4b1c3e4e826e" kindref="member">ck_layer_forward_rmsnorm_swiglu_decode_quant</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerForwardParamsQ4K" kindref="compound">CKLayerForwardParamsQ4K</ref><sp/>*p,</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_index,</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cache_capacity);</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1a35426895690beefd7b84cf090639b169" kindref="member">ck_residual_add_backward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_out,</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_a,</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_b,</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1add4c3ac196a25f481496bf69f32a9ac6" kindref="member">ck_attention_project_head_major_backward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_out,</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*attn_out,</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wo,</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_attn_out,</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_wo,</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_bo,</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim);</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1aae6b6e1796c190320ef20f0476dc2e9d" kindref="member">ck_qkv_project_head_major_backward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_q,</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_k,</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_v,</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wq,</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bq,</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wk,</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bk,</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*wv,</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bv,</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_input,</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_wq,</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_bq,</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_wk,</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_bk,</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_wv,</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_bv,</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*scratch,</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_threads);</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" kindref="member">ck_layer_backward_rmsnorm_swiglu</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCKLayerBackwardParams" kindref="compound">CKLayerBackwardParams</ref><sp/>*p);</highlight></codeline>
<codeline lineno="388"><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="390"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>extern<sp/>&quot;C&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>CKERNEL_ORCHESTRATION_H<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_orchestration.h"/>
  </compounddef>
</doxygen>
