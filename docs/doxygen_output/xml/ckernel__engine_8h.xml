<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="ckernel__engine_8h" kind="file" language="C++">
    <compoundname>ckernel_engine.h</compoundname>
    <includes local="no">stddef.h</includes>
    <includes local="no">stdint.h</includes>
    <includedby refid="backend__native_8c" local="yes">backend_native.c</includedby>
    <includedby refid="ckernel__orchestration_8c" local="yes">ckernel_orchestration.c</includedby>
    <includedby refid="ckernel__strict_8c" local="yes">ckernel_strict.c</includedby>
    <includedby refid="attention__kernels_8c" local="yes">attention_kernels.c</includedby>
    <includedby refid="embedding__kernels_8c" local="yes">embedding_kernels.c</includedby>
    <includedby refid="embedding__kernels__bf16_8c" local="yes">embedding_kernels_bf16.c</includedby>
    <includedby refid="gelu__kernels__bf16_8c" local="yes">gelu_kernels_bf16.c</includedby>
    <includedby refid="gemm__fused__kernels_8c" local="yes">gemm_fused_kernels.c</includedby>
    <includedby refid="gemm__kernels_8c" local="yes">gemm_kernels.c</includedby>
    <includedby refid="gemm__kernels__bf16_8c" local="yes">gemm_kernels_bf16.c</includedby>
    <includedby refid="gemm__microkernel_8c" local="yes">gemm_microkernel.c</includedby>
    <includedby refid="kv__cache__kernels_8c" local="yes">kv_cache_kernels.c</includedby>
    <includedby refid="layernorm__kernels__bf16_8c" local="yes">layernorm_kernels_bf16.c</includedby>
    <includedby refid="loss__kernels_8c" local="yes">loss_kernels.c</includedby>
    <includedby refid="loss__kernels__bf16_8c" local="yes">loss_kernels_bf16.c</includedby>
    <includedby refid="mlp__kernels_8c" local="yes">mlp_kernels.c</includedby>
    <includedby refid="mlp__kernels__bf16_8c" local="yes">mlp_kernels_bf16.c</includedby>
    <includedby refid="relu__kernels__bf16_8c" local="yes">relu_kernels_bf16.c</includedby>
    <includedby refid="rmsnorm__kernels__bf16_8c" local="yes">rmsnorm_kernels_bf16.c</includedby>
    <includedby refid="rmsnorm__kernels__int4_8c" local="yes">rmsnorm_kernels_int4.c</includedby>
    <includedby refid="rmsnorm__kernels__int8_8c" local="yes">rmsnorm_kernels_int8.c</includedby>
    <includedby refid="rope__kernels__bf16_8c" local="yes">rope_kernels_bf16.c</includedby>
    <includedby refid="sigmoid__kernels__bf16_8c" local="yes">sigmoid_kernels_bf16.c</includedby>
    <includedby refid="softmax__kernels__bf16_8c" local="yes">softmax_kernels_bf16.c</includedby>
    <includedby refid="swiglu__kernels_8c" local="yes">swiglu_kernels.c</includedby>
    <includedby refid="swiglu__kernels__bf16_8c" local="yes">swiglu_kernels_bf16.c</includedby>
    <includedby refid="vision__kernels__bf16_8c" local="yes">vision_kernels_bf16.c</includedby>
    <incdepgraph>
      <node id="3">
        <label>stdint.h</label>
      </node>
      <node id="1">
        <label>ckernel_engine.h</label>
        <link refid="ckernel__engine_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>stddef.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="22">
        <label>rmsnorm_kernels_int8.c</label>
        <link refid="rmsnorm__kernels__int8_8c"/>
      </node>
      <node id="23">
        <label>rope_kernels_bf16.c</label>
        <link refid="rope__kernels__bf16_8c"/>
      </node>
      <node id="19">
        <label>relu_kernels_bf16.c</label>
        <link refid="relu__kernels__bf16_8c"/>
      </node>
      <node id="24">
        <label>sigmoid_kernels_bf16.c</label>
        <link refid="sigmoid__kernels__bf16_8c"/>
      </node>
      <node id="2">
        <label>backend_native.c</label>
        <link refid="backend__native_8c"/>
      </node>
      <node id="26">
        <label>swiglu_kernels.c</label>
        <link refid="swiglu__kernels_8c"/>
      </node>
      <node id="4">
        <label>ckernel_strict.c</label>
        <link refid="ckernel__strict_8c"/>
      </node>
      <node id="16">
        <label>loss_kernels_bf16.c</label>
        <link refid="loss__kernels__bf16_8c"/>
      </node>
      <node id="10">
        <label>gemm_kernels.c</label>
        <link refid="gemm__kernels_8c"/>
      </node>
      <node id="5">
        <label>attention_kernels.c</label>
        <link refid="attention__kernels_8c"/>
      </node>
      <node id="11">
        <label>gemm_kernels_bf16.c</label>
        <link refid="gemm__kernels__bf16_8c"/>
      </node>
      <node id="1">
        <label>ckernel_engine.h</label>
        <link refid="ckernel__engine_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>gemm_fused_kernels.c</label>
        <link refid="gemm__fused__kernels_8c"/>
      </node>
      <node id="17">
        <label>mlp_kernels.c</label>
        <link refid="mlp__kernels_8c"/>
      </node>
      <node id="27">
        <label>swiglu_kernels_bf16.c</label>
        <link refid="swiglu__kernels__bf16_8c"/>
      </node>
      <node id="3">
        <label>ckernel_orchestration.c</label>
        <link refid="ckernel__orchestration_8c"/>
      </node>
      <node id="14">
        <label>layernorm_kernels_bf16.c</label>
        <link refid="layernorm__kernels__bf16_8c"/>
      </node>
      <node id="7">
        <label>embedding_kernels_bf16.c</label>
        <link refid="embedding__kernels__bf16_8c"/>
      </node>
      <node id="12">
        <label>gemm_microkernel.c</label>
        <link refid="gemm__microkernel_8c"/>
      </node>
      <node id="18">
        <label>mlp_kernels_bf16.c</label>
        <link refid="mlp__kernels__bf16_8c"/>
      </node>
      <node id="25">
        <label>softmax_kernels_bf16.c</label>
        <link refid="softmax__kernels__bf16_8c"/>
      </node>
      <node id="15">
        <label>loss_kernels.c</label>
        <link refid="loss__kernels_8c"/>
      </node>
      <node id="8">
        <label>gelu_kernels_bf16.c</label>
        <link refid="gelu__kernels__bf16_8c"/>
      </node>
      <node id="13">
        <label>kv_cache_kernels.c</label>
        <link refid="kv__cache__kernels_8c"/>
      </node>
      <node id="20">
        <label>rmsnorm_kernels_bf16.c</label>
        <link refid="rmsnorm__kernels__bf16_8c"/>
      </node>
      <node id="28">
        <label>vision_kernels_bf16.c</label>
        <link refid="vision__kernels__bf16_8c"/>
      </node>
      <node id="6">
        <label>embedding_kernels.c</label>
        <link refid="embedding__kernels_8c"/>
      </node>
      <node id="21">
        <label>rmsnorm_kernels_int4.c</label>
        <link refid="rmsnorm__kernels__int4_8c"/>
      </node>
    </invincdepgraph>
    <innerclass refid="structCKMathBackend" prot="public">CKMathBackend</innerclass>
      <sectiondef kind="func">
      <memberdef kind="function" id="ckernel__engine_8h_1ad611fd5e8dba3e906482d6e68f919788" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void attention_backward_causal_head_major</definition>
        <argsstring>(const float *d_output, const float *q, const float *k, const float *v, const float *attn_weights, float *d_q, float *d_k, float *d_v, float *d_scores, int num_heads, int num_tokens, int head_dim, int aligned_head_dim, int aligned_context_window)</argsstring>
        <name>attention_backward_causal_head_major</name>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>k</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>v</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>attn_weights</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_q</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_k</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_v</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_scores</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_context_window</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="595" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_kernels.c" bodystart="589" bodyend="610" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="595" declcolumn="6"/>
        <references refid="attention__kernels_8c_1adbd2b55fbc53b6e288c98813b61cd6e3" compoundref="attention__kernels_8c" startline="460" endline="586">attention_backward_causal_head_major_gqa</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1adbd2b55fbc53b6e288c98813b61cd6e3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void attention_backward_causal_head_major_gqa</definition>
        <argsstring>(const float *d_output, const float *q, const float *k, const float *v, const float *attn_weights, float *d_q, float *d_k, float *d_v, float *d_scores, int num_heads, int num_kv_heads, int num_tokens, int head_dim, int aligned_head_dim, int aligned_context_window)</argsstring>
        <name>attention_backward_causal_head_major_gqa</name>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>k</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>v</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>attn_weights</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_q</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_k</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_v</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_scores</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_context_window</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="577" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_kernels.c" bodystart="460" bodyend="586" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="577" declcolumn="6"/>
        <references refid="attention__kernels_8c_1a0102833b3c8a1d4114e65c0638ddbfb1" compoundref="attention__kernels_8c" startline="20" endline="28">qkv_index</references>
        <references refid="attention__kernels_8c_1a730fa391639fb17027ee898e26e5db06" compoundref="attention__kernels_8c" startline="32" endline="40">score_index</references>
        <referencedby refid="ckernel__engine_8h_1ad611fd5e8dba3e906482d6e68f919788" compoundref="attention__kernels_8c" startline="589" endline="610">attention_backward_causal_head_major</referencedby>
        <referencedby refid="ckernel__engine_8h_1a1a95c2e93bfbe603df487d0c0eb5ea2b" compoundref="attention__kernels_8c" startline="402" endline="458">attention_backward_causal_head_major_gqa_bf16</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" compoundref="ckernel__orchestration_8c" startline="816" endline="956">ck_layer_backward_rmsnorm_swiglu</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a1a95c2e93bfbe603df487d0c0eb5ea2b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void attention_backward_causal_head_major_gqa_bf16</definition>
        <argsstring>(const uint16_t *d_output, float *d_x, const uint16_t *q, const uint16_t *k, const uint16_t *v, const float *attn_weights, float *d_q, float *d_k, float *d_v, float *d_scores, int num_heads, int num_kv_heads, int num_tokens, int head_dim, int aligned_head_dim, int aligned_context_window)</argsstring>
        <name>attention_backward_causal_head_major_gqa_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_x</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>k</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>v</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>attn_weights</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_q</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_k</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_v</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_scores</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_context_window</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="611" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_kernels.c" bodystart="402" bodyend="458" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="611" declcolumn="6"/>
        <references refid="attention__kernels_8c_1adbd2b55fbc53b6e288c98813b61cd6e3" compoundref="attention__kernels_8c" startline="460" endline="586">attention_backward_causal_head_major_gqa</references>
        <references refid="attention__kernels_8c_1a4113194a0a57126146cb4d5471c05bd5" compoundref="attention__kernels_8c" startline="6" endline="16">convert_bf16_tensor</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a3d8664b9e0808546484af9ec7d4ddfe1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void attention_forward_causal_head_major</definition>
        <argsstring>(const float *q, const float *k, const float *v, float *scores, float *output, int num_heads, int num_tokens, int head_dim, int aligned_head_dim, int aligned_context_window)</argsstring>
        <name>attention_forward_causal_head_major</name>
        <param>
          <type>const float *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>k</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>v</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>scores</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_context_window</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="396" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_kernels.c" bodystart="56" bodyend="120" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="396" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1a920868f80137fe3e0c9cd11acb7ba567" compoundref="softmax__kernels_8c" startline="10" endline="46">causal_softmax_head_major</references>
        <references refid="attention__kernels_8c_1a0102833b3c8a1d4114e65c0638ddbfb1" compoundref="attention__kernels_8c" startline="20" endline="28">qkv_index</references>
        <references refid="attention__kernels_8c_1a730fa391639fb17027ee898e26e5db06" compoundref="attention__kernels_8c" startline="32" endline="40">score_index</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a3e1aa7c55e515fd996318da27c2c5ade" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void attention_forward_causal_head_major_gqa</definition>
        <argsstring>(const float *q, const float *k, const float *v, float *scores, float *output, int num_heads, int num_kv_heads, int num_tokens, int head_dim, int aligned_head_dim, int aligned_context_window)</argsstring>
        <name>attention_forward_causal_head_major_gqa</name>
        <param>
          <type>const float *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>k</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>v</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>scores</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_context_window</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="408" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_kernels.c" bodystart="124" bodyend="182" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="408" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1a920868f80137fe3e0c9cd11acb7ba567" compoundref="softmax__kernels_8c" startline="10" endline="46">causal_softmax_head_major</references>
        <references refid="attention__kernels_8c_1a0102833b3c8a1d4114e65c0638ddbfb1" compoundref="attention__kernels_8c" startline="20" endline="28">qkv_index</references>
        <references refid="attention__kernels_8c_1a730fa391639fb17027ee898e26e5db06" compoundref="attention__kernels_8c" startline="32" endline="40">score_index</references>
        <referencedby refid="ckernel__engine_8h_1af749b0ec6a9cc8a63033fa2069759722" compoundref="attention__kernels_8c" startline="184" endline="222">attention_forward_causal_head_major_gqa_bf16</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1ab7dfa86e5bb0d80f0e346f85e870cb1d" compoundref="ckernel__orchestration_8c" startline="403" endline="508">ck_layer_forward_rmsnorm_swiglu</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1acc9d893cdd6cf7bf0dbf35d42c5f0e99" compoundref="ckernel__orchestration_8c" startline="510" endline="615">ck_layer_forward_rmsnorm_swiglu_ref</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1af749b0ec6a9cc8a63033fa2069759722" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void attention_forward_causal_head_major_gqa_bf16</definition>
        <argsstring>(const uint16_t *q, const uint16_t *k, const uint16_t *v, float *scores, float *output, int num_heads, int num_kv_heads, int num_tokens, int head_dim, int aligned_head_dim, int aligned_context_window)</argsstring>
        <name>attention_forward_causal_head_major_gqa_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>k</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>v</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>scores</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_context_window</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="420" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_kernels.c" bodystart="184" bodyend="222" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="420" declcolumn="6"/>
        <references refid="attention__kernels_8c_1a3e1aa7c55e515fd996318da27c2c5ade" compoundref="attention__kernels_8c" startline="124" endline="182">attention_forward_causal_head_major_gqa</references>
        <references refid="attention__kernels_8c_1a4113194a0a57126146cb4d5471c05bd5" compoundref="attention__kernels_8c" startline="6" endline="16">convert_bf16_tensor</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aac305a28084fe73b2264ae57613ba3ea" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void attention_forward_causal_head_major_gqa_flash</definition>
        <argsstring>(const float *q, const float *k, const float *v, float *output, int num_heads, int num_kv_heads, int num_tokens, int head_dim, int aligned_head_dim)</argsstring>
        <name>attention_forward_causal_head_major_gqa_flash</name>
        <param>
          <type>const float *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>k</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>v</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="437" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_kernels.c" bodystart="294" bodyend="328" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="437" declcolumn="6"/>
        <references refid="attention__kernels_8c_1aa09ace92ab625ae8365e61f47c3d93a5" compoundref="attention__kernels_8c" startline="236" endline="292">attention_flash_query_causal</references>
        <references refid="attention__kernels_8c_1a0102833b3c8a1d4114e65c0638ddbfb1" compoundref="attention__kernels_8c" startline="20" endline="28">qkv_index</references>
        <referencedby refid="ckernel__orchestration_8h_1ab7dfa86e5bb0d80f0e346f85e870cb1d" compoundref="ckernel__orchestration_8c" startline="403" endline="508">ck_layer_forward_rmsnorm_swiglu</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1acc9d893cdd6cf7bf0dbf35d42c5f0e99" compoundref="ckernel__orchestration_8c" startline="510" endline="615">ck_layer_forward_rmsnorm_swiglu_ref</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a84803f8c5509c325dd6b9feec50a0493" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void attention_forward_decode_head_major_gqa_flash</definition>
        <argsstring>(const float *q_token, const float *k_cache, const float *v_cache, float *out_token, int num_heads, int num_kv_heads, int kv_tokens, int cache_capacity, int head_dim, int aligned_head_dim)</argsstring>
        <name>attention_forward_decode_head_major_gqa_flash</name>
        <param>
          <type>const float *</type>
          <declname>q_token</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>k_cache</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>v_cache</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>out_token</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>kv_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cache_capacity</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="451" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/attention_kernels.c" bodystart="330" bodyend="365" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="451" declcolumn="6"/>
        <references refid="attention__kernels_8c_1aa09ace92ab625ae8365e61f47c3d93a5" compoundref="attention__kernels_8c" startline="236" endline="292">attention_flash_query_causal</references>
        <referencedby refid="ckernel__orchestration_8h_1a745d032ebb518826e284b4a3680a8cb5" compoundref="ckernel__orchestration_8c" startline="653" endline="814">ck_layer_forward_rmsnorm_swiglu_decode</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a3d0ffc191c77d983b953984f8012589d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void backward_causal_softmax_head_major</definition>
        <argsstring>(float *d_scores, const float *weights, int num_heads, int num_tokens, int aligned_context_window)</argsstring>
        <name>backward_causal_softmax_head_major</name>
        <param>
          <type>float *</type>
          <declname>d_scores</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>weights</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_context_window</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="375" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/softmax_kernels.c" bodystart="51" bodyend="83" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="375" declcolumn="6"/>
        <referencedby refid="ckernel__engine_8h_1afe83b7a562f3b21fef1993782ff3792b" compoundref="softmax__kernels__bf16_8c" startline="36" endline="64">backward_causal_softmax_head_major_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1afe83b7a562f3b21fef1993782ff3792b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void backward_causal_softmax_head_major_bf16</definition>
        <argsstring>(uint16_t *d_scores, const uint16_t *weights, int num_heads, int num_tokens, int aligned_context_window)</argsstring>
        <name>backward_causal_softmax_head_major_bf16</name>
        <param>
          <type>uint16_t *</type>
          <declname>d_scores</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>weights</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_context_window</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="386" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/softmax_kernels_bf16.c" bodystart="36" bodyend="64" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="386" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1a3d0ffc191c77d983b953984f8012589d" compoundref="softmax__kernels_8c" startline="51" endline="83">backward_causal_softmax_head_major</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a920868f80137fe3e0c9cd11acb7ba567" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void causal_softmax_head_major</definition>
        <argsstring>(float *scores, int num_heads, int num_tokens, int aligned_context_window)</argsstring>
        <name>causal_softmax_head_major</name>
        <param>
          <type>float *</type>
          <declname>scores</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_context_window</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="370" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/softmax_kernels.c" bodystart="10" bodyend="46" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="370" declcolumn="6"/>
        <referencedby refid="ckernel__engine_8h_1a3d8664b9e0808546484af9ec7d4ddfe1" compoundref="attention__kernels_8c" startline="56" endline="120">attention_forward_causal_head_major</referencedby>
        <referencedby refid="ckernel__engine_8h_1a3e1aa7c55e515fd996318da27c2c5ade" compoundref="attention__kernels_8c" startline="124" endline="182">attention_forward_causal_head_major_gqa</referencedby>
        <referencedby refid="ckernel__engine_8h_1a1cc637a888846ddbcf1a58ac72b4aaf6" compoundref="softmax__kernels__bf16_8c" startline="12" endline="34">causal_softmax_head_major_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a1cc637a888846ddbcf1a58ac72b4aaf6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void causal_softmax_head_major_bf16</definition>
        <argsstring>(uint16_t *scores, int num_heads, int num_tokens, int aligned_context_window)</argsstring>
        <name>causal_softmax_head_major_bf16</name>
        <param>
          <type>uint16_t *</type>
          <declname>scores</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_context_window</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="381" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/softmax_kernels_bf16.c" bodystart="12" bodyend="34" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="381" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="ckernel__engine_8h_1a920868f80137fe3e0c9cd11acb7ba567" compoundref="softmax__kernels_8c" startline="10" endline="46">causal_softmax_head_major</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a8bcb6fa03c4861c8f45d59fa424d1146" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ck_set_strict_parity</definition>
        <argsstring>(int enabled)</argsstring>
        <name>ck_set_strict_parity</name>
        <param>
          <type>int</type>
          <declname>enabled</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="37" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_strict.c" bodystart="9" bodyend="18" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="37" declcolumn="6"/>
        <references refid="ckernel__strict_8c_1a6dbb8ec1125b21473b47d31ae92427c3" compoundref="ckernel__strict_8c" startline="7">ck_strict_parity</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ck_strict_parity_enabled</definition>
        <argsstring>(void)</argsstring>
        <name>ck_strict_parity_enabled</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="38" column="5" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/ckernel_strict.c" bodystart="20" bodyend="23" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="38" declcolumn="5"/>
        <references refid="ckernel__strict_8c_1a6dbb8ec1125b21473b47d31ae92427c3" compoundref="ckernel__strict_8c" startline="7">ck_strict_parity</references>
        <referencedby refid="ckernel__engine_8h_1a9af477f77eb64b2cdd2ccddae9c84e72" compoundref="gemm__kernels_8c" startline="67" endline="120">gemm_avx512_parallel</referencedby>
        <referencedby refid="ckernel__engine_8h_1af4f0e756d3ac00b45ce2c7a296b61ae3" compoundref="gemm__kernels_8c" startline="578" endline="646">gemm_blocked_serial</referencedby>
        <referencedby refid="ckernel__engine_8h_1abab2d2aaed47f4c682c019bd77fab1ed" compoundref="gemm__kernels_8c" startline="123" endline="210">gemm_fine_grained_parallel</referencedby>
        <referencedby refid="ckernel__engine_8h_1a1cd1848bd75a4fb5874fe0feaa8716e4" compoundref="gemm__kernels_8c" startline="43" endline="64">gemm_naive_parallel</referencedby>
        <referencedby refid="ckernel__engine_8h_1a91c10e18555ecb27791d5405c8dc3ae4" compoundref="gemm__kernels_8c" startline="257" endline="318">gemm_nn_avx512</referencedby>
        <referencedby refid="ckernel__engine_8h_1afd447dc190bd77241a42d8972f9c5fba" compoundref="gemm__kernels_8c" startline="320" endline="391">gemm_nn_blocked</referencedby>
        <referencedby refid="ckernel__engine_8h_1a3549b849a914ea46c5d51c7d485fecec" compoundref="gemm__kernels_8c" startline="235" endline="255">gemm_nn_parallel</referencedby>
        <referencedby refid="ckernel__engine_8h_1afe5bf17f909def227c3e25b0c4338f93" compoundref="gemm__kernels_8c" startline="439" endline="497">gemm_tn_avx512</referencedby>
        <referencedby refid="ckernel__engine_8h_1ae3bc36ea7b8562f9121e527f0f408b43" compoundref="gemm__kernels_8c" startline="499" endline="570">gemm_tn_blocked</referencedby>
        <referencedby refid="ckernel__engine_8h_1a84ce00fad7103b550ea75b52a21a98f7" compoundref="gemm__kernels_8c" startline="417" endline="437">gemm_tn_parallel</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a6c6a2e37aa74b6f118d94eb08debcff3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="structCKMathBackend" kindref="compound">CKMathBackend</ref></type>
        <definition>CKMathBackend ckernel_backend_native</definition>
        <argsstring>(void)</argsstring>
        <name>ckernel_backend_native</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Obtain the built-in native backend (single-node CPU, C + intrinsics). </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="34" column="15" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/backend_native.c" bodystart="39" bodyend="44" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="34" declcolumn="15"/>
        <references refid="backend__native_8c_1a9008610196b2d6750454c58f87a6cc78" compoundref="backend__native_8c" startline="18" endline="37">ckernel_sgemm_native</references>
        <references refid="structCKMathBackend_1a7e59ba4baa9c776241287338a219d9c4" compoundref="ckernel__engine_8h" startline="24">CKMathBackend::sgemm</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a7fb7087da26dca964798795062f5b0a5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void embedding_backward</definition>
        <argsstring>(const int32_t *token_ids, int token_count, const float *d_output, float *d_token_embeddings, float *d_pos_embeddings, int vocab_size, int embed_dim, int aligned_embed_dim, int context_window, int add_pos)</argsstring>
        <name>embedding_backward</name>
        <param>
          <type>const int32_t *</type>
          <declname>token_ids</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_count</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_token_embeddings</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_pos_embeddings</declname>
        </param>
        <param>
          <type>int</type>
          <declname>vocab_size</declname>
        </param>
        <param>
          <type>int</type>
          <declname>embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>context_window</declname>
        </param>
        <param>
          <type>int</type>
          <declname>add_pos</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="766" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/embedding_kernels.c" bodystart="59" bodyend="100" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="766" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a7c57b105fb88eb4165a0c649932be08d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void embedding_backward_bf16</definition>
        <argsstring>(const int32_t *token_ids, int token_count, const uint16_t *d_output, uint16_t *d_token_embeddings, uint16_t *d_pos_embeddings, int vocab_size, int embed_dim, int aligned_embed_dim, int context_window, int add_pos)</argsstring>
        <name>embedding_backward_bf16</name>
        <param>
          <type>const int32_t *</type>
          <declname>token_ids</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_count</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_token_embeddings</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_pos_embeddings</declname>
        </param>
        <param>
          <type>int</type>
          <declname>vocab_size</declname>
        </param>
        <param>
          <type>int</type>
          <declname>embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>context_window</declname>
        </param>
        <param>
          <type>int</type>
          <declname>add_pos</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="777" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/embedding_kernels_bf16.c" bodystart="58" bodyend="99" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="777" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1ad6f7e7937754e791a704562549e39f05" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void embedding_forward</definition>
        <argsstring>(const int32_t *token_ids, int token_count, int vocab_size, const float *token_embeddings, const float *pos_embeddings, float *output, int embed_dim, int aligned_embed_dim, int context_window, int add_pos)</argsstring>
        <name>embedding_forward</name>
        <param>
          <type>const int32_t *</type>
          <declname>token_ids</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_count</declname>
        </param>
        <param>
          <type>int</type>
          <declname>vocab_size</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>token_embeddings</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>pos_embeddings</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>context_window</declname>
        </param>
        <param>
          <type>int</type>
          <declname>add_pos</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="740" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/embedding_kernels.c" bodystart="5" bodyend="57" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="740" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a6d58689c662e670a5423eedd0291d6b5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void embedding_forward_bf16</definition>
        <argsstring>(const int32_t *token_ids, int token_count, int vocab_size, const uint16_t *token_embeddings, const uint16_t *pos_embeddings, uint16_t *output, int embed_dim, int aligned_embed_dim, int context_window, int add_pos)</argsstring>
        <name>embedding_forward_bf16</name>
        <param>
          <type>const int32_t *</type>
          <declname>token_ids</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_count</declname>
        </param>
        <param>
          <type>int</type>
          <declname>vocab_size</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>token_embeddings</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>pos_embeddings</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>context_window</declname>
        </param>
        <param>
          <type>int</type>
          <declname>add_pos</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="751" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/embedding_kernels_bf16.c" bodystart="7" bodyend="56" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="751" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a73e088d0e2388c78920e8fc99b0c3846" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void fc1_backward_kernel</definition>
        <argsstring>(const float *d_output, const float *fc1_input, const float *W_fc1, float *d_input, float *d_W_fc1, float *d_b_fc1, int T, int aligned_in, int aligned_out, int num_threads)</argsstring>
        <name>fc1_backward_kernel</name>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>fc1_input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>W_fc1</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_W_fc1</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_b_fc1</declname>
        </param>
        <param>
          <type>int</type>
          <declname>T</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_in</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_out</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_threads</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="519" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/mlp_kernels.c" bodystart="113" bodyend="149" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="519" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1a91c10e18555ecb27791d5405c8dc3ae4" compoundref="gemm__kernels_8c" startline="257" endline="318">gemm_nn_avx512</references>
        <references refid="ckernel__engine_8h_1afe5bf17f909def227c3e25b0c4338f93" compoundref="gemm__kernels_8c" startline="439" endline="497">gemm_tn_avx512</references>
        <referencedby refid="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" compoundref="ckernel__orchestration_8c" startline="816" endline="956">ck_layer_backward_rmsnorm_swiglu</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a89a29fc853aae0baf9f6094fee52562a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void fc2_backward_kernel</definition>
        <argsstring>(const float *d_output, const float *fc2_input, const float *W_fc2, float *d_input, float *d_W_fc2, float *d_b_fc2, int T, int aligned_in, int aligned_out, int num_threads)</argsstring>
        <name>fc2_backward_kernel</name>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>fc2_input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>W_fc2</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_W_fc2</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_b_fc2</declname>
        </param>
        <param>
          <type>int</type>
          <declname>T</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_in</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_out</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_threads</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="508" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/mlp_kernels.c" bodystart="64" bodyend="102" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="508" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1a91c10e18555ecb27791d5405c8dc3ae4" compoundref="gemm__kernels_8c" startline="257" endline="318">gemm_nn_avx512</references>
        <references refid="ckernel__engine_8h_1afe5bf17f909def227c3e25b0c4338f93" compoundref="gemm__kernels_8c" startline="439" endline="497">gemm_tn_avx512</references>
        <referencedby refid="ckernel__orchestration_8h_1add4c3ac196a25f481496bf69f32a9ac6" compoundref="ckernel__orchestration_8c" startline="207" endline="261">ck_attention_project_head_major_backward</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" compoundref="ckernel__orchestration_8c" startline="816" endline="956">ck_layer_backward_rmsnorm_swiglu</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1aae6b6e1796c190320ef20f0476dc2e9d" compoundref="ckernel__orchestration_8c" startline="263" endline="357">ck_qkv_project_head_major_backward</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a3075b77764b4b408e3c1c9b89a2822ad" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gelu_backward_exact</definition>
        <argsstring>(const float *input, const float *d_output, float *d_input, size_t n)</argsstring>
        <name>gelu_backward_exact</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="333" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gelu_kernels.c" bodystart="22" bodyend="46" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="333" declcolumn="6"/>
        <referencedby refid="ckernel__engine_8h_1ac8572265a21098caf2060797cb18a978" compoundref="gelu__kernels__bf16_8c" startline="35" endline="60">gelu_backward_exact_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1ac8572265a21098caf2060797cb18a978" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gelu_backward_exact_bf16</definition>
        <argsstring>(const uint16_t *input, const uint16_t *d_output, uint16_t *d_input, size_t n)</argsstring>
        <name>gelu_backward_exact_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="345" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gelu_kernels_bf16.c" bodystart="35" bodyend="60" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="345" declcolumn="6"/>
        <references refid="gelu__kernels__bf16_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="gelu__kernels__bf16_8c" startline="11" endline="14">alloc_float_buffer</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="gelu__kernels__bf16_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="gelu__kernels__bf16_8c" startline="16" endline="19">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1a3075b77764b4b408e3c1c9b89a2822ad" compoundref="gelu__kernels_8c" startline="22" endline="46">gelu_backward_exact</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aeaf518a5239f4588f8c28b05b96d5478" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gelu_backward_fast</definition>
        <argsstring>(const float *input, const float *d_output, float *d_input, size_t n)</argsstring>
        <name>gelu_backward_fast</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="338" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gelu_kernels.c" bodystart="49" bodyend="60" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="338" declcolumn="6"/>
        <referencedby refid="ckernel__engine_8h_1a27adb4761d436aeea3317ce0595dc67a" compoundref="gelu__kernels__bf16_8c" startline="62" endline="87">gelu_backward_fast_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a27adb4761d436aeea3317ce0595dc67a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gelu_backward_fast_bf16</definition>
        <argsstring>(const uint16_t *input, const uint16_t *d_output, uint16_t *d_input, size_t n)</argsstring>
        <name>gelu_backward_fast_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="349" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gelu_kernels_bf16.c" bodystart="62" bodyend="87" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="349" declcolumn="6"/>
        <references refid="gelu__kernels__bf16_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="gelu__kernels__bf16_8c" startline="11" endline="14">alloc_float_buffer</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="gelu__kernels__bf16_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="gelu__kernels__bf16_8c" startline="16" endline="19">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1aeaf518a5239f4588f8c28b05b96d5478" compoundref="gelu__kernels_8c" startline="49" endline="60">gelu_backward_fast</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1abc5977fca1e95c2406a779657c4d2365" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gelu_fast_inplace</definition>
        <argsstring>(float *data, size_t n)</argsstring>
        <name>gelu_fast_inplace</name>
        <param>
          <type>float *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="331" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gelu_kernels.c" bodystart="6" bodyend="17" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="331" declcolumn="6"/>
        <referencedby refid="ckernel__engine_8h_1aa64dae6724ac5d649be339cad62126cb" compoundref="gelu__kernels__bf16_8c" startline="21" endline="33">gelu_fast_inplace_bf16</referencedby>
        <referencedby refid="ckernel__engine_8h_1a5b4ac7df82788956de18c6e1b4f37609" compoundref="mlp__kernels_8c" startline="22" endline="53">mlp_token_parallel</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aa64dae6724ac5d649be339cad62126cb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gelu_fast_inplace_bf16</definition>
        <argsstring>(uint16_t *data, size_t n)</argsstring>
        <name>gelu_fast_inplace_bf16</name>
        <param>
          <type>uint16_t *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="344" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gelu_kernels_bf16.c" bodystart="21" bodyend="33" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="344" declcolumn="6"/>
        <references refid="gelu__kernels__bf16_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="gelu__kernels__bf16_8c" startline="11" endline="14">alloc_float_buffer</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="gelu__kernels__bf16_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="gelu__kernels__bf16_8c" startline="16" endline="19">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1abc5977fca1e95c2406a779657c4d2365" compoundref="gelu__kernels_8c" startline="6" endline="17">gelu_fast_inplace</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a9af477f77eb64b2cdd2ccddae9c84e72" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_avx512_parallel</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_avx512_parallel</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="47" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels.c" bodystart="67" bodyend="120" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="47" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" compoundref="ckernel__strict_8c" startline="20" endline="23">ck_strict_parity_enabled</references>
        <references refid="gemm__kernels_8c_1a1cd1848bd75a4fb5874fe0feaa8716e4" compoundref="gemm__kernels_8c" startline="43" endline="64">gemm_naive_parallel</references>
        <references refid="gemm__kernels_8c_1a155ee359c94e8d25746f5a2828c6c448" compoundref="gemm__kernels_8c" startline="25" endline="40">gemm_naive_serial_double</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1ad9b7d9471502870fc90e12a2416e5f49" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_bias_gelu_fused</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_bias_gelu_fused</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="121" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_fused_kernels.c" bodystart="121" bodyend="160" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="121" declcolumn="6"/>
        <references refid="gemm__fused__kernels_8c_1aa3c6303c8ab2632fbd29c489de4968f2" compoundref="gemm__fused__kernels_8c" startline="64" endline="68">fast_gelu_scalar</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a3b3b32e0000c63586cddb9be0eda5daf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_bias_relu_fused</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_bias_relu_fused</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="115" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_fused_kernels.c" bodystart="74" bodyend="114" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="115" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a26763168556236dee899fe08699cc826" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_bias_silu_fused</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_bias_silu_fused</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="127" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_fused_kernels.c" bodystart="167" bodyend="209" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="127" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1af4f0e756d3ac00b45ce2c7a296b61ae3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_blocked_serial</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_blocked_serial</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="59" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels.c" bodystart="578" bodyend="646" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="59" declcolumn="6"/>
        <references refid="gemm__kernels_8c_1a19bd64cbde3f643580eb69b050c8e61d" compoundref="gemm__kernels_8c" startline="7" endline="7">ck_min</references>
        <references refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" compoundref="ckernel__strict_8c" startline="20" endline="23">ck_strict_parity_enabled</references>
        <references refid="gemm__kernels_8c_1a155ee359c94e8d25746f5a2828c6c448" compoundref="gemm__kernels_8c" startline="25" endline="40">gemm_naive_serial_double</references>
        <referencedby refid="ckernel__orchestration_8h_1a2afc01d06448f40b94c48a51a6951dc5" compoundref="ckernel__orchestration_8c" startline="137" endline="170">ck_attention_project_head_major</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1a2e894b79792aaf694427446c1d89fab8" compoundref="ckernel__orchestration_8c" startline="359" endline="379">ck_mlp_swiglu_forward</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1ae1c428e05f8ea7795136ae8b160b8a0a" compoundref="ckernel__orchestration_8c" startline="38" endline="80">ck_qkv_project_head_major</referencedby>
        <referencedby refid="ckernel__orchestration_8c_1ae7e167cf7de25dabc3616efae8bc91a7" compoundref="ckernel__orchestration_8c" startline="617" endline="651">ck_qkv_project_head_major_token</referencedby>
        <referencedby refid="ckernel__engine_8h_1a5b4ac7df82788956de18c6e1b4f37609" compoundref="mlp__kernels_8c" startline="22" endline="53">mlp_token_parallel</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a9020b3311acc4db83cc7243b3d13d439" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_blocked_serial_bf16</definition>
        <argsstring>(const uint16_t *A, const uint16_t *B, const uint16_t *bias, uint16_t *C, int M, int N, int K)</argsstring>
        <name>gemm_blocked_serial_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="66" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels_bf16.c" bodystart="281" bodyend="305" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="66" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1abab2d2aaed47f4c682c019bd77fab1ed" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_fine_grained_parallel</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_fine_grained_parallel</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="53" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels.c" bodystart="123" bodyend="210" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="53" declcolumn="6"/>
        <references refid="gemm__kernels_8c_1a19bd64cbde3f643580eb69b050c8e61d" compoundref="gemm__kernels_8c" startline="7" endline="7">ck_min</references>
        <references refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" compoundref="ckernel__strict_8c" startline="20" endline="23">ck_strict_parity_enabled</references>
        <references refid="gemm__kernels_8c_1a1cd1848bd75a4fb5874fe0feaa8716e4" compoundref="gemm__kernels_8c" startline="43" endline="64">gemm_naive_parallel</references>
        <references refid="gemm__kernels_8c_1a155ee359c94e8d25746f5a2828c6c448" compoundref="gemm__kernels_8c" startline="25" endline="40">gemm_naive_serial_double</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a594a440cd88e67b89068125123f52c9e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_microkernel</definition>
        <argsstring>(const float *A, const float *B, float *C, int M, int N, int K, int B_transposed)</argsstring>
        <name>gemm_microkernel</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <param>
          <type>int</type>
          <declname>B_transposed</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="148" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_microkernel.c" bodystart="844" bodyend="862" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="148" declcolumn="6"/>
        <references refid="gemm__microkernel_8c_1ac779265214c020d37db4915eee9937c8" compoundref="gemm__microkernel_8c" startline="596" endline="658">gemm_microkernel_blocked</references>
        <references refid="gemm__microkernel_8c_1add90afcf3ff08dff14e0c824ad1075f6" compoundref="gemm__microkernel_8c" startline="769" endline="835">gemm_microkernel_blocked_bt</references>
        <references refid="gemm__microkernel_8c_1af4c2881c7acb7acd3e792dcce0469e27" compoundref="gemm__microkernel_8c" startline="489" endline="582">gemm_microkernel_packed</references>
        <references refid="gemm__microkernel_8c_1a757a5b148b758bc38cbc87a99d33de9f" compoundref="gemm__microkernel_8c" startline="842">PACK_THRESHOLD</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1ac779265214c020d37db4915eee9937c8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_microkernel_blocked</definition>
        <argsstring>(const float *A, const float *B, float *C, int M, int N, int K)</argsstring>
        <name>gemm_microkernel_blocked</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="155" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_microkernel.c" bodystart="596" bodyend="658" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="155" declcolumn="6"/>
        <references refid="gemm__microkernel_8c_1a18bfcedb9d45538774be02d4b68f0b67" compoundref="gemm__microkernel_8c" startline="259" endline="277">gemm_microkernel_edge</references>
        <references refid="gemm__microkernel_8c_1a73764abcca0b8bbf6bf355d9f1bab0b9" compoundref="gemm__microkernel_8c" startline="44">KC</references>
        <references refid="gemm__microkernel_8c_1a71d9e511e7e302cd831e83581219e70d" compoundref="gemm__microkernel_8c" startline="42">MC</references>
        <references refid="gemm__microkernel_8c_1a9ecbd9f86f95534f1bcf71015d5ae81a" compoundref="gemm__microkernel_8c" startline="38">MR</references>
        <references refid="gemm__microkernel_8c_1a1fa2460e32327ade49189c95740bc1b5" compoundref="gemm__microkernel_8c" startline="43">NC</references>
        <references refid="gemm__microkernel_8c_1af146485306ae74a2edf18636300fd107" compoundref="gemm__microkernel_8c" startline="39">NR</references>
        <referencedby refid="ckernel__engine_8h_1a594a440cd88e67b89068125123f52c9e" compoundref="gemm__microkernel_8c" startline="844" endline="862">gemm_microkernel</referencedby>
        <referencedby refid="ckernel__engine_8h_1af4c2881c7acb7acd3e792dcce0469e27" compoundref="gemm__microkernel_8c" startline="489" endline="582">gemm_microkernel_packed</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1add90afcf3ff08dff14e0c824ad1075f6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_microkernel_blocked_bt</definition>
        <argsstring>(const float *A, const float *B, float *C, int M, int N, int K)</argsstring>
        <name>gemm_microkernel_blocked_bt</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="161" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_microkernel.c" bodystart="769" bodyend="835" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="161" declcolumn="6"/>
        <references refid="gemm__microkernel_8c_1a73764abcca0b8bbf6bf355d9f1bab0b9" compoundref="gemm__microkernel_8c" startline="44">KC</references>
        <references refid="gemm__microkernel_8c_1a71d9e511e7e302cd831e83581219e70d" compoundref="gemm__microkernel_8c" startline="42">MC</references>
        <references refid="gemm__microkernel_8c_1a9ecbd9f86f95534f1bcf71015d5ae81a" compoundref="gemm__microkernel_8c" startline="38">MR</references>
        <references refid="gemm__microkernel_8c_1a1fa2460e32327ade49189c95740bc1b5" compoundref="gemm__microkernel_8c" startline="43">NC</references>
        <references refid="gemm__microkernel_8c_1af146485306ae74a2edf18636300fd107" compoundref="gemm__microkernel_8c" startline="39">NR</references>
        <referencedby refid="ckernel__engine_8h_1a594a440cd88e67b89068125123f52c9e" compoundref="gemm__microkernel_8c" startline="844" endline="862">gemm_microkernel</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1af4c2881c7acb7acd3e792dcce0469e27" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_microkernel_packed</definition>
        <argsstring>(const float *A, const float *B, float *C, int M, int N, int K)</argsstring>
        <name>gemm_microkernel_packed</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="168" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_microkernel.c" bodystart="489" bodyend="582" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="168" declcolumn="6"/>
        <references refid="gemm__microkernel_8c_1ac779265214c020d37db4915eee9937c8" compoundref="gemm__microkernel_8c" startline="596" endline="658">gemm_microkernel_blocked</references>
        <references refid="gemm__microkernel_8c_1a18bfcedb9d45538774be02d4b68f0b67" compoundref="gemm__microkernel_8c" startline="259" endline="277">gemm_microkernel_edge</references>
        <references refid="gemm__microkernel_8c_1a73764abcca0b8bbf6bf355d9f1bab0b9" compoundref="gemm__microkernel_8c" startline="44">KC</references>
        <references refid="gemm__microkernel_8c_1a71d9e511e7e302cd831e83581219e70d" compoundref="gemm__microkernel_8c" startline="42">MC</references>
        <references refid="gemm__microkernel_8c_1a9ecbd9f86f95534f1bcf71015d5ae81a" compoundref="gemm__microkernel_8c" startline="38">MR</references>
        <references refid="gemm__microkernel_8c_1a1fa2460e32327ade49189c95740bc1b5" compoundref="gemm__microkernel_8c" startline="43">NC</references>
        <references refid="gemm__microkernel_8c_1af146485306ae74a2edf18636300fd107" compoundref="gemm__microkernel_8c" startline="39">NR</references>
        <references refid="gemm__microkernel_8c_1a901f57b4416f1abe2f441bfdfe444e74" compoundref="gemm__microkernel_8c" startline="288" endline="308">pack_a_panel</references>
        <references refid="gemm__microkernel_8c_1a5e9ddc655a21cd03b71493f6e819f85c" compoundref="gemm__microkernel_8c" startline="312" endline="330">pack_b_panel</references>
        <referencedby refid="ckernel__engine_8h_1a594a440cd88e67b89068125123f52c9e" compoundref="gemm__microkernel_8c" startline="844" endline="862">gemm_microkernel</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a1cd1848bd75a4fb5874fe0feaa8716e4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_naive_parallel</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_naive_parallel</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="41" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels.c" bodystart="43" bodyend="64" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="41" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" compoundref="ckernel__strict_8c" startline="20" endline="23">ck_strict_parity_enabled</references>
        <references refid="gemm__kernels_8c_1a155ee359c94e8d25746f5a2828c6c448" compoundref="gemm__kernels_8c" startline="25" endline="40">gemm_naive_serial_double</references>
        <referencedby refid="ckernel__orchestration_8c_1a34e3e4ce864cbfd383097bcf417124ad" compoundref="ckernel__orchestration_8c" startline="172" endline="205">ck_attention_project_head_major_ref</referencedby>
        <referencedby refid="ckernel__orchestration_8c_1ac841f4e0a273b07808cc036a715b742e" compoundref="ckernel__orchestration_8c" startline="381" endline="401">ck_mlp_swiglu_forward_ref</referencedby>
        <referencedby refid="ckernel__orchestration_8c_1a3678c4745f6b4d3f39e3c07cdff6db12" compoundref="ckernel__orchestration_8c" startline="82" endline="124">ck_qkv_project_head_major_ref</referencedby>
        <referencedby refid="ckernel__engine_8h_1a9af477f77eb64b2cdd2ccddae9c84e72" compoundref="gemm__kernels_8c" startline="67" endline="120">gemm_avx512_parallel</referencedby>
        <referencedby refid="ckernel__engine_8h_1abab2d2aaed47f4c682c019bd77fab1ed" compoundref="gemm__kernels_8c" startline="123" endline="210">gemm_fine_grained_parallel</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a91c10e18555ecb27791d5405c8dc3ae4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_nn_avx512</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_nn_avx512</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="81" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels.c" bodystart="257" bodyend="318" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="81" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" compoundref="ckernel__strict_8c" startline="20" endline="23">ck_strict_parity_enabled</references>
        <references refid="gemm__kernels_8c_1a3549b849a914ea46c5d51c7d485fecec" compoundref="gemm__kernels_8c" startline="235" endline="255">gemm_nn_parallel</references>
        <references refid="gemm__kernels_8c_1a2731fd00008f7e887e94ec03af77325d" compoundref="gemm__kernels_8c" startline="218" endline="233">gemm_nn_serial_double</references>
        <referencedby refid="ckernel__engine_8h_1a73e088d0e2388c78920e8fc99b0c3846" compoundref="mlp__kernels_8c" startline="113" endline="149">fc1_backward_kernel</referencedby>
        <referencedby refid="ckernel__engine_8h_1a89a29fc853aae0baf9f6094fee52562a" compoundref="mlp__kernels_8c" startline="64" endline="102">fc2_backward_kernel</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1afd447dc190bd77241a42d8972f9c5fba" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_nn_blocked</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_nn_blocked</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="87" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels.c" bodystart="320" bodyend="391" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="87" declcolumn="6"/>
        <references refid="gemm__kernels_8c_1a19bd64cbde3f643580eb69b050c8e61d" compoundref="gemm__kernels_8c" startline="7" endline="7">ck_min</references>
        <references refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" compoundref="ckernel__strict_8c" startline="20" endline="23">ck_strict_parity_enabled</references>
        <references refid="gemm__kernels_8c_1a2731fd00008f7e887e94ec03af77325d" compoundref="gemm__kernels_8c" startline="218" endline="233">gemm_nn_serial_double</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a3549b849a914ea46c5d51c7d485fecec" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_nn_parallel</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_nn_parallel</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="75" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels.c" bodystart="235" bodyend="255" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="75" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" compoundref="ckernel__strict_8c" startline="20" endline="23">ck_strict_parity_enabled</references>
        <references refid="gemm__kernels_8c_1a2731fd00008f7e887e94ec03af77325d" compoundref="gemm__kernels_8c" startline="218" endline="233">gemm_nn_serial_double</references>
        <referencedby refid="ckernel__engine_8h_1a91c10e18555ecb27791d5405c8dc3ae4" compoundref="gemm__kernels_8c" startline="257" endline="318">gemm_nn_avx512</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a2ae3bbf03cebc529c1e7962a7dba2568" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_swiglu_fused</definition>
        <argsstring>(const float *x, const float *W_gate, const float *W_up, const float *b_gate, const float *b_up, float *output, int M, int N, int K)</argsstring>
        <name>gemm_swiglu_fused</name>
        <param>
          <type>const float *</type>
          <declname>x</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>W_gate</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>W_up</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b_gate</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b_up</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="136" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_fused_kernels.c" bodystart="231" bodyend="306" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="136" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1afe5bf17f909def227c3e25b0c4338f93" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_tn_avx512</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_tn_avx512</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="102" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels.c" bodystart="439" bodyend="497" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="102" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" compoundref="ckernel__strict_8c" startline="20" endline="23">ck_strict_parity_enabled</references>
        <references refid="gemm__kernels_8c_1a84ce00fad7103b550ea75b52a21a98f7" compoundref="gemm__kernels_8c" startline="417" endline="437">gemm_tn_parallel</references>
        <references refid="gemm__kernels_8c_1a991079eceb2424fbabb6bb9e23a7c86e" compoundref="gemm__kernels_8c" startline="399" endline="415">gemm_tn_serial_double</references>
        <referencedby refid="ckernel__engine_8h_1a73e088d0e2388c78920e8fc99b0c3846" compoundref="mlp__kernels_8c" startline="113" endline="149">fc1_backward_kernel</referencedby>
        <referencedby refid="ckernel__engine_8h_1a89a29fc853aae0baf9f6094fee52562a" compoundref="mlp__kernels_8c" startline="64" endline="102">fc2_backward_kernel</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1ae3bc36ea7b8562f9121e527f0f408b43" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_tn_blocked</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_tn_blocked</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="108" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels.c" bodystart="499" bodyend="570" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="108" declcolumn="6"/>
        <references refid="gemm__kernels_8c_1a19bd64cbde3f643580eb69b050c8e61d" compoundref="gemm__kernels_8c" startline="7" endline="7">ck_min</references>
        <references refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" compoundref="ckernel__strict_8c" startline="20" endline="23">ck_strict_parity_enabled</references>
        <references refid="gemm__kernels_8c_1a991079eceb2424fbabb6bb9e23a7c86e" compoundref="gemm__kernels_8c" startline="399" endline="415">gemm_tn_serial_double</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a84ce00fad7103b550ea75b52a21a98f7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gemm_tn_parallel</definition>
        <argsstring>(const float *A, const float *B, const float *bias, float *C, int M, int N, int K)</argsstring>
        <name>gemm_tn_parallel</name>
        <param>
          <type>const float *</type>
          <declname>A</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>B</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>bias</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>M</declname>
        </param>
        <param>
          <type>int</type>
          <declname>N</declname>
        </param>
        <param>
          <type>int</type>
          <declname>K</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="96" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/gemm_kernels.c" bodystart="417" bodyend="437" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="96" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" compoundref="ckernel__strict_8c" startline="20" endline="23">ck_strict_parity_enabled</references>
        <references refid="gemm__kernels_8c_1a991079eceb2424fbabb6bb9e23a7c86e" compoundref="gemm__kernels_8c" startline="399" endline="415">gemm_tn_serial_double</references>
        <referencedby refid="ckernel__engine_8h_1afe5bf17f909def227c3e25b0c4338f93" compoundref="gemm__kernels_8c" startline="439" endline="497">gemm_tn_avx512</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a86aec042bcceb0bd8955f0daf0d986c4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void im2patch</definition>
        <argsstring>(const float *image, float *patches, int C, int H, int W, int P)</argsstring>
        <name>im2patch</name>
        <param>
          <type>const float *</type>
          <declname>image</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>patches</declname>
        </param>
        <param>
          <type>int</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>H</declname>
        </param>
        <param>
          <type>int</type>
          <declname>W</declname>
        </param>
        <param>
          <type>int</type>
          <declname>P</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>im2patch: Transforms an image into a sequence of flattened patches.</para>
<para>Image Layout: [C, H, W] (Row-major: W is fastest moving) Output Layout: [num_patches, C * P * P]</para>
<para>num_patches = (H/P) * (W/P) P = patch_size </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="805" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/vision_kernels.c" bodystart="14" bodyend="47" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="805" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a57139580e075be2d5a65cfffc8e84898" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void im2patch_bf16</definition>
        <argsstring>(const uint16_t *image, uint16_t *patches, int C, int H, int W, int P)</argsstring>
        <name>im2patch_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>image</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>patches</declname>
        </param>
        <param>
          <type>int</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>H</declname>
        </param>
        <param>
          <type>int</type>
          <declname>W</declname>
        </param>
        <param>
          <type>int</type>
          <declname>P</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="812" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/vision_kernels_bf16.c" bodystart="8" bodyend="41" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="812" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a377bab84fd3d4ba79cf92024615c240a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void kv_cache_repack_head_major_inplace</definition>
        <argsstring>(float *buf, int num_heads, int tokens, int cache_capacity, int aligned_head_dim)</argsstring>
        <name>kv_cache_repack_head_major_inplace</name>
        <param>
          <type>float *</type>
          <declname>buf</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cache_capacity</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="478" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/kv_cache_kernels.c" bodystart="16" bodyend="46" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="478" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a1b1c905b9d69fc8aadca4c714147ce45" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void kv_cache_write_head_major</definition>
        <argsstring>(const float *k_token, const float *v_token, float *k_cache, float *v_cache, int num_kv_heads, int token_index, int cache_capacity, int head_dim, int aligned_head_dim)</argsstring>
        <name>kv_cache_write_head_major</name>
        <param>
          <type>const float *</type>
          <declname>k_token</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>v_token</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>k_cache</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>v_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>token_index</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cache_capacity</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="463" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/kv_cache_kernels.c" bodystart="48" bodyend="92" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="463" declcolumn="6"/>
        <referencedby refid="ckernel__orchestration_8h_1a745d032ebb518826e284b4a3680a8cb5" compoundref="ckernel__orchestration_8c" startline="653" endline="814">ck_layer_forward_rmsnorm_swiglu_decode</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a8d349f047d6654b3a351fb62e0b20e87" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void layernorm_backward_kernel</definition>
        <argsstring>(const float *d_output, const float *input, const float *gamma, const float *mean, const float *rstd, float *d_input, float *d_gamma, float *d_beta, int tokens, int d_model, int aligned_embed_dim)</argsstring>
        <name>layernorm_backward_kernel</name>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>mean</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>rstd</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_gamma</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_beta</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="233" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/layernorm_kernels.c" bodystart="652" bodyend="719" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="233" declcolumn="6"/>
        <referencedby refid="ckernel__engine_8h_1ab4fae76462b8dfdda429b265c41ec9f0" compoundref="layernorm__kernels__bf16_8c" startline="83" endline="116">layernorm_backward_kernel_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1ab4fae76462b8dfdda429b265c41ec9f0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void layernorm_backward_kernel_bf16</definition>
        <argsstring>(const uint16_t *d_output, const uint16_t *input, const float *gamma, const float *mean, const float *rstd, uint16_t *d_input, float *d_gamma, float *d_beta, int tokens, int d_model, int aligned_embed_dim)</argsstring>
        <name>layernorm_backward_kernel_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>mean</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>rstd</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_gamma</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_beta</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="243" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/layernorm_kernels_bf16.c" bodystart="83" bodyend="116" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="243" declcolumn="6"/>
        <references refid="layernorm__kernels__bf16_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="layernorm__kernels__bf16_8c" startline="12" endline="15">alloc_float_buffer</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="layernorm__kernels__bf16_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="layernorm__kernels__bf16_8c" startline="17" endline="20">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1a8d349f047d6654b3a351fb62e0b20e87" compoundref="layernorm__kernels_8c" startline="652" endline="719">layernorm_backward_kernel</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1ace47573bf5278260d2652f4fb069bb9e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void layernorm_forward_rolled_slice</definition>
        <argsstring>(const float *__restrict input_slice_base, const float *__restrict gamma, const float *__restrict beta, float *__restrict output_slice_base, float *__restrict mean_cache_slice, float *__restrict rstd_cache_slice, int num_tokens_in_slice, int d_model, int aligned_embed_dim, float eps)</argsstring>
        <name>layernorm_forward_rolled_slice</name>
        <param>
          <type>const float *__restrict</type>
          <declname>input_slice_base</declname>
        </param>
        <param>
          <type>const float *__restrict</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *__restrict</type>
          <declname>beta</declname>
        </param>
        <param>
          <type>float *__restrict</type>
          <declname>output_slice_base</declname>
        </param>
        <param>
          <type>float *__restrict</type>
          <declname>mean_cache_slice</declname>
        </param>
        <param>
          <type>float *__restrict</type>
          <declname>rstd_cache_slice</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens_in_slice</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>float</type>
          <declname>eps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="183" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/layernorm_kernels.c" bodystart="258" bodyend="282" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="183" declcolumn="6"/>
        <references refid="layernorm__kernels_8c_1a72f2038f01b5790f7235b5371d1f4d72" compoundref="layernorm__kernels_8c" startline="35" endline="83">layernorm_naive_serial</references>
        <referencedby refid="ckernel__engine_8h_1aed96ddab9e3b51974364c6a5dd5852a6" compoundref="layernorm__kernels__bf16_8c" startline="22" endline="51">layernorm_forward_rolled_slice_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aed96ddab9e3b51974364c6a5dd5852a6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void layernorm_forward_rolled_slice_bf16</definition>
        <argsstring>(const uint16_t *__restrict input_slice_base, const float *__restrict gamma, const float *__restrict beta, uint16_t *__restrict output_slice_base, float *__restrict mean_cache_slice, float *__restrict rstd_cache_slice, int num_tokens_in_slice, int d_model, int aligned_embed_dim, float eps)</argsstring>
        <name>layernorm_forward_rolled_slice_bf16</name>
        <param>
          <type>const uint16_t *__restrict</type>
          <declname>input_slice_base</declname>
        </param>
        <param>
          <type>const float *__restrict</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *__restrict</type>
          <declname>beta</declname>
        </param>
        <param>
          <type>uint16_t *__restrict</type>
          <declname>output_slice_base</declname>
        </param>
        <param>
          <type>float *__restrict</type>
          <declname>mean_cache_slice</declname>
        </param>
        <param>
          <type>float *__restrict</type>
          <declname>rstd_cache_slice</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens_in_slice</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>float</type>
          <declname>eps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="194" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/layernorm_kernels_bf16.c" bodystart="22" bodyend="51" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="194" declcolumn="6"/>
        <references refid="layernorm__kernels__bf16_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="layernorm__kernels__bf16_8c" startline="12" endline="15">alloc_float_buffer</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="layernorm__kernels__bf16_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="layernorm__kernels__bf16_8c" startline="17" endline="20">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1ace47573bf5278260d2652f4fb069bb9e" compoundref="layernorm__kernels_8c" startline="258" endline="282">layernorm_forward_rolled_slice</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1afd2e784d7b2b3ac7eb93e6f87c091fae" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void layernorm_forward_unrolled_slice</definition>
        <argsstring>(const float *__restrict input_slice_base, const float *__restrict gamma, const float *__restrict beta, float *__restrict output_slice_base, float *__restrict mean_cache_slice, float *__restrict rstd_cache_slice, int num_tokens_in_slice, int d_model, float eps)</argsstring>
        <name>layernorm_forward_unrolled_slice</name>
        <param>
          <type>const float *__restrict</type>
          <declname>input_slice_base</declname>
        </param>
        <param>
          <type>const float *__restrict</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *__restrict</type>
          <declname>beta</declname>
        </param>
        <param>
          <type>float *__restrict</type>
          <declname>output_slice_base</declname>
        </param>
        <param>
          <type>float *__restrict</type>
          <declname>mean_cache_slice</declname>
        </param>
        <param>
          <type>float *__restrict</type>
          <declname>rstd_cache_slice</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens_in_slice</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>float</type>
          <declname>eps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="205" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/layernorm_kernels.c" bodystart="582" bodyend="605" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="205" declcolumn="6"/>
        <references refid="layernorm__kernels_8c_1aabe13737d121479113ffd94b43e58087" compoundref="layernorm__kernels_8c" startline="566" endline="579">layernorm_forward_unrolled_slice_scalar</references>
        <referencedby refid="ckernel__engine_8h_1a4b36f606ec3110c6da3844b3633b1aaf" compoundref="layernorm__kernels__bf16_8c" startline="53" endline="81">layernorm_forward_unrolled_slice_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a4b36f606ec3110c6da3844b3633b1aaf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void layernorm_forward_unrolled_slice_bf16</definition>
        <argsstring>(const uint16_t *__restrict input_slice_base, const float *__restrict gamma, const float *__restrict beta, uint16_t *__restrict output_slice_base, float *__restrict mean_cache_slice, float *__restrict rstd_cache_slice, int num_tokens_in_slice, int d_model, float eps)</argsstring>
        <name>layernorm_forward_unrolled_slice_bf16</name>
        <param>
          <type>const uint16_t *__restrict</type>
          <declname>input_slice_base</declname>
        </param>
        <param>
          <type>const float *__restrict</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *__restrict</type>
          <declname>beta</declname>
        </param>
        <param>
          <type>uint16_t *__restrict</type>
          <declname>output_slice_base</declname>
        </param>
        <param>
          <type>float *__restrict</type>
          <declname>mean_cache_slice</declname>
        </param>
        <param>
          <type>float *__restrict</type>
          <declname>rstd_cache_slice</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens_in_slice</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>float</type>
          <declname>eps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="215" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/layernorm_kernels_bf16.c" bodystart="53" bodyend="81" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="215" declcolumn="6"/>
        <references refid="layernorm__kernels__bf16_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="layernorm__kernels__bf16_8c" startline="12" endline="15">alloc_float_buffer</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="layernorm__kernels__bf16_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="layernorm__kernels__bf16_8c" startline="17" endline="20">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1afd2e784d7b2b3ac7eb93e6f87c091fae" compoundref="layernorm__kernels_8c" startline="582" endline="605">layernorm_forward_unrolled_slice</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a72f2038f01b5790f7235b5371d1f4d72" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void layernorm_naive_serial</definition>
        <argsstring>(const float *input, const float *gamma, const float *beta, float *output, float *mean_cache, float *rstd_cache, int tokens, int d_model, int aligned_embed_dim, float eps)</argsstring>
        <name>layernorm_naive_serial</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>beta</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>mean_cache</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>rstd_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>float</type>
          <declname>eps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="174" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/layernorm_kernels.c" bodystart="35" bodyend="83" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="174" declcolumn="6"/>
        <referencedby refid="ckernel__engine_8h_1ace47573bf5278260d2652f4fb069bb9e" compoundref="layernorm__kernels_8c" startline="258" endline="282">layernorm_forward_rolled_slice</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a3c0c758ac557839bfc06d1037d15b91e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void layernorm_naive_serial_matched_precision</definition>
        <argsstring>(const float *input, const float *gamma, const float *beta, float *output, float *mean_cache, float *rstd_cache, int tokens, int d_model, float eps)</argsstring>
        <name>layernorm_naive_serial_matched_precision</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>beta</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>mean_cache</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>rstd_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>float</type>
          <declname>eps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="225" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/layernorm_kernels.c" bodystart="608" bodyend="648" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="225" declcolumn="6"/>
        <referencedby refid="layernorm__kernels_8c_1aabe13737d121479113ffd94b43e58087" compoundref="layernorm__kernels_8c" startline="566" endline="579">layernorm_forward_unrolled_slice_scalar</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a5b4ac7df82788956de18c6e1b4f37609" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void mlp_token_parallel</definition>
        <argsstring>(const float *input, const float *W_fc1, const float *b_fc1, const float *W_fc2, const float *b_fc2, float *fc1_output, float *output, int T, int aligned_dim, int num_threads)</argsstring>
        <name>mlp_token_parallel</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>W_fc1</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b_fc1</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>W_fc2</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>b_fc2</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>fc1_output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>T</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_threads</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="485" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/mlp_kernels.c" bodystart="22" bodyend="53" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="485" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1abc5977fca1e95c2406a779657c4d2365" compoundref="gelu__kernels_8c" startline="6" endline="17">gelu_fast_inplace</references>
        <references refid="ckernel__engine_8h_1af4f0e756d3ac00b45ce2c7a296b61ae3" compoundref="gemm__kernels_8c" startline="578" endline="646">gemm_blocked_serial</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a488697bbc4656ba8037ab3eb79314e5e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void mlp_token_parallel_bf16</definition>
        <argsstring>(const uint16_t *input, const uint16_t *W_fc1, const uint16_t *b_fc1, const uint16_t *W_fc2, const uint16_t *b_fc2, float *fc1_output, float *output, int T, int aligned_dim, int num_threads)</argsstring>
        <name>mlp_token_parallel_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>W_fc1</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>b_fc1</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>W_fc2</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>b_fc2</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>fc1_output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>T</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_threads</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Optimized MLP Forward (BF16 weights, FP32 activations)</para>
<para>This version:<orderedlist>
<listitem><para>Uses optimized BF16 GEMM directly (no bulk conversion)</para>
</listitem><listitem><para>Keeps activations in FP32 for GELU accuracy</para>
</listitem><listitem><para>Vectorized GELU with AVX-512 </para>
</listitem></orderedlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="496" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/mlp_kernels_bf16.c" bodystart="85" bodyend="191" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="496" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
        <references refid="mlp__kernels__bf16_8c_1a27c361a6bca1a4eb302dcecfc2d4b53c" compoundref="mlp__kernels__bf16_8c" startline="34" endline="40">gelu_scalar</references>
        <references refid="mlp__kernels__bf16_8c_1a8647bb8c6a9a965a92e1c98330f237af" compoundref="gemm__kernels__bf16_8c" startline="310" endline="362">gemm_bf16_fp32out</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a3ffa58aab7da5c6e77096ad19385329a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void patch2im</definition>
        <argsstring>(const float *d_patches, float *d_image, int C, int H, int W, int P)</argsstring>
        <name>patch2im</name>
        <param>
          <type>const float *</type>
          <declname>d_patches</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_image</declname>
        </param>
        <param>
          <type>int</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>H</declname>
        </param>
        <param>
          <type>int</type>
          <declname>W</declname>
        </param>
        <param>
          <type>int</type>
          <declname>P</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>patch2im: Accumulates gradients from patches back into the image. (Backward pass)</para>
<para>d_patches: [num_patches, C * P * P] d_image: [C, H, W] (Accumulated) </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="808" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/vision_kernels.c" bodystart="55" bodyend="88" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="808" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aee95c2d2b45191471be617739a41ac0d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void patch2im_bf16</definition>
        <argsstring>(const uint16_t *d_patches, uint16_t *d_image, int C, int H, int W, int P)</argsstring>
        <name>patch2im_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>d_patches</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_image</declname>
        </param>
        <param>
          <type>int</type>
          <declname>C</declname>
        </param>
        <param>
          <type>int</type>
          <declname>H</declname>
        </param>
        <param>
          <type>int</type>
          <declname>W</declname>
        </param>
        <param>
          <type>int</type>
          <declname>P</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="815" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/vision_kernels_bf16.c" bodystart="43" bodyend="81" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="815" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a434da7f0647cdada09cd6ad435560467" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void relu_backward</definition>
        <argsstring>(const float *input, const float *d_output, float *d_input, size_t n)</argsstring>
        <name>relu_backward</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="357" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/relu_kernels.c" bodystart="68" bodyend="100" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="357" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1af64829ad63a9c81784d64d4f447ee39a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void relu_backward_bf16</definition>
        <argsstring>(const uint16_t *input, const uint16_t *d_output, uint16_t *d_input, size_t n)</argsstring>
        <name>relu_backward_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="364" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/relu_kernels_bf16.c" bodystart="29" bodyend="42" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="364" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a856216dca72f3534c079f429d1d58d48" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void relu_forward</definition>
        <argsstring>(const float *input, float *output, size_t n)</argsstring>
        <name>relu_forward</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="355" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/relu_kernels.c" bodystart="10" bodyend="35" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="355" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a842c2002210a04d9dc4d9bdabed4fcc2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void relu_forward_bf16</definition>
        <argsstring>(const uint16_t *input, uint16_t *output, size_t n)</argsstring>
        <name>relu_forward_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="362" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/relu_kernels_bf16.c" bodystart="7" bodyend="16" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="362" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1abbc4f192b13bed9ed1614c99cee2db91" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void relu_forward_inplace</definition>
        <argsstring>(float *data, size_t n)</argsstring>
        <name>relu_forward_inplace</name>
        <param>
          <type>float *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="356" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/relu_kernels.c" bodystart="38" bodyend="65" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="356" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a55d24741c224580192c6104c2eb4525a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void relu_forward_inplace_bf16</definition>
        <argsstring>(uint16_t *data, size_t n)</argsstring>
        <name>relu_forward_inplace_bf16</name>
        <param>
          <type>uint16_t *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="363" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/relu_kernels_bf16.c" bodystart="18" bodyend="27" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="363" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aca68d7dda1a7de9ff926920804751db0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rmsnorm_backward</definition>
        <argsstring>(const float *d_output, const float *input, const float *gamma, const float *rstd_cache, float *d_input, float *d_gamma, int tokens, int d_model, int aligned_embed_dim)</argsstring>
        <name>rmsnorm_backward</name>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>rstd_cache</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_gamma</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="263" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rmsnorm_kernels.c" bodystart="64" bodyend="111" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="263" declcolumn="6"/>
        <referencedby refid="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" compoundref="ckernel__orchestration_8c" startline="816" endline="956">ck_layer_backward_rmsnorm_swiglu</referencedby>
        <referencedby refid="ckernel__engine_8h_1ab35eb653240c86b2b1a41b88233c90be" compoundref="rmsnorm__kernels__int4_8c" startline="102" endline="149">rmsnorm_backward_int4</referencedby>
        <referencedby refid="ckernel__engine_8h_1afebfbf40a74543cc5cb371c6ff5f4711" compoundref="rmsnorm__kernels__int8_8c" startline="82" endline="130">rmsnorm_backward_int8</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a14d80153de303766038a231e4932e357" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rmsnorm_backward_bf16</definition>
        <argsstring>(const uint16_t *d_output, const uint16_t *input, const float *gamma, const float *rstd_cache, uint16_t *d_input, float *d_gamma, int tokens, int d_model, int aligned_embed_dim)</argsstring>
        <name>rmsnorm_backward_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>rstd_cache</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_gamma</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="282" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rmsnorm_kernels_bf16.c" bodystart="52" bodyend="102" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="282" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1ab35eb653240c86b2b1a41b88233c90be" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rmsnorm_backward_int4</definition>
        <argsstring>(const uint8_t *d_output, const uint8_t *input, const float *gamma, const float *rstd_cache, uint8_t *d_input, float *d_gamma, int tokens, int d_model, int aligned_embed_dim)</argsstring>
        <name>rmsnorm_backward_int4</name>
        <param>
          <type>const uint8_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>const uint8_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>rstd_cache</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_gamma</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="320" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rmsnorm_kernels_int4.c" bodystart="102" bodyend="149" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="320" declcolumn="6"/>
        <references refid="rmsnorm__kernels__int4_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="rmsnorm__kernels__int4_8c" startline="8" endline="11">alloc_float_buffer</references>
        <references refid="rmsnorm__kernels__int4_8c_1a9c0e4a1798e2ff7fd3450cdb541783ea" compoundref="rmsnorm__kernels__int4_8c" startline="52" endline="69">convert_float_to_int4</references>
        <references refid="rmsnorm__kernels__int4_8c_1a59a34ee64765705aafa4472344e32e5e" compoundref="rmsnorm__kernels__int4_8c" startline="42" endline="50">convert_int4_to_float</references>
        <references refid="rmsnorm__kernels__int4_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="rmsnorm__kernels__int4_8c" startline="13" endline="16">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1aca68d7dda1a7de9ff926920804751db0" compoundref="rmsnorm__kernels_8c" startline="64" endline="111">rmsnorm_backward</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1afebfbf40a74543cc5cb371c6ff5f4711" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rmsnorm_backward_int8</definition>
        <argsstring>(const int8_t *d_output, const int8_t *input, const float *gamma, const float *rstd_cache, int8_t *d_input, float *d_gamma, int tokens, int d_model, int aligned_embed_dim)</argsstring>
        <name>rmsnorm_backward_int8</name>
        <param>
          <type>const int8_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>const int8_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>rstd_cache</declname>
        </param>
        <param>
          <type>int8_t *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_gamma</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="301" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rmsnorm_kernels_int8.c" bodystart="82" bodyend="130" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="301" declcolumn="6"/>
        <references refid="rmsnorm__kernels__int8_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="rmsnorm__kernels__int8_8c" startline="41" endline="44">alloc_float_buffer</references>
        <references refid="rmsnorm__kernels__int8_8c_1aa0f94daa3cbcf5611313ea3211874b55" compoundref="rmsnorm__kernels__int8_8c" startline="32" endline="39">convert_float_to_int8</references>
        <references refid="rmsnorm__kernels__int8_8c_1a45fe3ed3025a14b8ff912b887963cf4b" compoundref="rmsnorm__kernels__int8_8c" startline="12" endline="19">convert_int8_to_float</references>
        <references refid="rmsnorm__kernels__int8_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="rmsnorm__kernels__int8_8c" startline="46" endline="49">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1aca68d7dda1a7de9ff926920804751db0" compoundref="rmsnorm__kernels_8c" startline="64" endline="111">rmsnorm_backward</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rmsnorm_forward</definition>
        <argsstring>(const float *input, const float *gamma, float *output, float *rstd_cache, int tokens, int d_model, int aligned_embed_dim, float eps)</argsstring>
        <name>rmsnorm_forward</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>rstd_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>float</type>
          <declname>eps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="254" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rmsnorm_kernels.c" bodystart="12" bodyend="51" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="254" declcolumn="6"/>
        <referencedby refid="ckernel__orchestration_8h_1ab7dfa86e5bb0d80f0e346f85e870cb1d" compoundref="ckernel__orchestration_8c" startline="403" endline="508">ck_layer_forward_rmsnorm_swiglu</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1a745d032ebb518826e284b4a3680a8cb5" compoundref="ckernel__orchestration_8c" startline="653" endline="814">ck_layer_forward_rmsnorm_swiglu_decode</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1acc9d893cdd6cf7bf0dbf35d42c5f0e99" compoundref="ckernel__orchestration_8c" startline="510" endline="615">ck_layer_forward_rmsnorm_swiglu_ref</referencedby>
        <referencedby refid="ckernel__engine_8h_1abb168afab2b3523fbdf26569ab0afa66" compoundref="rmsnorm__kernels__int4_8c" startline="71" endline="100">rmsnorm_forward_int4</referencedby>
        <referencedby refid="ckernel__engine_8h_1a49c1ca0d6c659c9d5623fa64dde4ecc3" compoundref="rmsnorm__kernels__int8_8c" startline="51" endline="80">rmsnorm_forward_int8</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a4f024774420774821f805d0742694d02" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rmsnorm_forward_bf16</definition>
        <argsstring>(const uint16_t *input, const float *gamma, uint16_t *output, float *rstd_cache, int tokens, int d_model, int aligned_embed_dim, float eps)</argsstring>
        <name>rmsnorm_forward_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>rstd_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>float</type>
          <declname>eps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="273" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rmsnorm_kernels_bf16.c" bodystart="8" bodyend="49" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="273" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1abb168afab2b3523fbdf26569ab0afa66" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rmsnorm_forward_int4</definition>
        <argsstring>(const uint8_t *input, const float *gamma, uint8_t *output, float *rstd_cache, int tokens, int d_model, int aligned_embed_dim, float eps)</argsstring>
        <name>rmsnorm_forward_int4</name>
        <param>
          <type>const uint8_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>rstd_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>float</type>
          <declname>eps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="311" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rmsnorm_kernels_int4.c" bodystart="71" bodyend="100" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="311" declcolumn="6"/>
        <references refid="rmsnorm__kernels__int4_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="rmsnorm__kernels__int4_8c" startline="8" endline="11">alloc_float_buffer</references>
        <references refid="rmsnorm__kernels__int4_8c_1a9c0e4a1798e2ff7fd3450cdb541783ea" compoundref="rmsnorm__kernels__int4_8c" startline="52" endline="69">convert_float_to_int4</references>
        <references refid="rmsnorm__kernels__int4_8c_1a59a34ee64765705aafa4472344e32e5e" compoundref="rmsnorm__kernels__int4_8c" startline="42" endline="50">convert_int4_to_float</references>
        <references refid="rmsnorm__kernels__int4_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="rmsnorm__kernels__int4_8c" startline="13" endline="16">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" compoundref="rmsnorm__kernels_8c" startline="12" endline="51">rmsnorm_forward</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a49c1ca0d6c659c9d5623fa64dde4ecc3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rmsnorm_forward_int8</definition>
        <argsstring>(const int8_t *input, const float *gamma, int8_t *output, float *rstd_cache, int tokens, int d_model, int aligned_embed_dim, float eps)</argsstring>
        <name>rmsnorm_forward_int8</name>
        <param>
          <type>const int8_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>gamma</declname>
        </param>
        <param>
          <type>int8_t *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>rstd_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>d_model</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_embed_dim</declname>
        </param>
        <param>
          <type>float</type>
          <declname>eps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="292" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rmsnorm_kernels_int8.c" bodystart="51" bodyend="80" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="292" declcolumn="6"/>
        <references refid="rmsnorm__kernels__int8_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="rmsnorm__kernels__int8_8c" startline="41" endline="44">alloc_float_buffer</references>
        <references refid="rmsnorm__kernels__int8_8c_1aa0f94daa3cbcf5611313ea3211874b55" compoundref="rmsnorm__kernels__int8_8c" startline="32" endline="39">convert_float_to_int8</references>
        <references refid="rmsnorm__kernels__int8_8c_1a45fe3ed3025a14b8ff912b887963cf4b" compoundref="rmsnorm__kernels__int8_8c" startline="12" endline="19">convert_int8_to_float</references>
        <references refid="rmsnorm__kernels__int8_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="rmsnorm__kernels__int8_8c" startline="46" endline="49">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" compoundref="rmsnorm__kernels_8c" startline="12" endline="51">rmsnorm_forward</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1af248ca325f0a6837ed9bfd3d34552c00" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rope_backward</definition>
        <argsstring>(const float *d_out, float *d_x, const float *cos_cache, const float *sin_cache, int num_heads, int num_tokens, int head_dim, int aligned_head_dim, int pos_offset)</argsstring>
        <name>rope_backward</name>
        <param>
          <type>const float *</type>
          <declname>d_out</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_x</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>cos_cache</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>sin_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>pos_offset</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="648" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rope_kernels.c" bodystart="115" bodyend="154" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="648" declcolumn="6"/>
        <referencedby refid="ckernel__engine_8h_1ad3c7e02c4d88c86823c845ccbf72be6c" compoundref="rope__kernels__bf16_8c" startline="44" endline="70">rope_backward_bf16</referencedby>
        <referencedby refid="ckernel__engine_8h_1a42fa03f293de94c5422681ada891a24f" compoundref="rope__kernels_8c" startline="215" endline="230">rope_backward_qk</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1ad3c7e02c4d88c86823c845ccbf72be6c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rope_backward_bf16</definition>
        <argsstring>(const uint16_t *d_out, uint16_t *d_x, const float *cos_cache, const float *sin_cache, int num_heads, int num_tokens, int head_dim, int aligned_head_dim, int pos_offset)</argsstring>
        <name>rope_backward_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>d_out</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_x</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>cos_cache</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>sin_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>pos_offset</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="667" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rope_kernels_bf16.c" bodystart="44" bodyend="70" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="667" declcolumn="6"/>
        <references refid="rope__kernels__bf16_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="rope__kernels__bf16_8c" startline="11" endline="14">alloc_float_buffer</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="rope__kernels__bf16_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="rope__kernels__bf16_8c" startline="16" endline="19">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1af248ca325f0a6837ed9bfd3d34552c00" compoundref="rope__kernels_8c" startline="115" endline="154">rope_backward</references>
        <referencedby refid="ckernel__engine_8h_1a76d3e6e058074c51a76a252ab61eb5fa" compoundref="rope__kernels__bf16_8c" startline="93" endline="114">rope_backward_qk_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a71f922f5016760db12457ed82924ded3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rope_backward_inplace</definition>
        <argsstring>(float *d_x, const float *cos_cache, const float *sin_cache, int num_heads, int num_tokens, int head_dim, int aligned_head_dim, int pos_offset)</argsstring>
        <name>rope_backward_inplace</name>
        <param>
          <type>float *</type>
          <declname>d_x</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>cos_cache</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>sin_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>pos_offset</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="678" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rope_kernels.c" bodystart="158" bodyend="194" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="678" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a42fa03f293de94c5422681ada891a24f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rope_backward_qk</definition>
        <argsstring>(const float *d_q_out, const float *d_k_out, float *d_q, float *d_k, const float *cos_cache, const float *sin_cache, int num_heads, int num_kv_heads, int num_tokens, int head_dim, int aligned_head_dim, int pos_offset)</argsstring>
        <name>rope_backward_qk</name>
        <param>
          <type>const float *</type>
          <declname>d_q_out</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>d_k_out</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_q</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_k</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>cos_cache</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>sin_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>pos_offset</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="699" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rope_kernels.c" bodystart="215" bodyend="230" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="699" declcolumn="6"/>
        <references refid="rope__kernels_8c_1af248ca325f0a6837ed9bfd3d34552c00" compoundref="rope__kernels_8c" startline="115" endline="154">rope_backward</references>
        <referencedby refid="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" compoundref="ckernel__orchestration_8c" startline="816" endline="956">ck_layer_backward_rmsnorm_swiglu</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a76d3e6e058074c51a76a252ab61eb5fa" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rope_backward_qk_bf16</definition>
        <argsstring>(const uint16_t *d_q_out, const uint16_t *d_k_out, uint16_t *d_q, uint16_t *d_k, const float *cos_cache, const float *sin_cache, int num_heads, int num_kv_heads, int num_tokens, int head_dim, int aligned_head_dim, int pos_offset)</argsstring>
        <name>rope_backward_qk_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>d_q_out</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>d_k_out</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_q</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_k</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>cos_cache</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>sin_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>pos_offset</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="723" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rope_kernels_bf16.c" bodystart="93" bodyend="114" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="723" declcolumn="6"/>
        <references refid="rope__kernels__bf16_8c_1ad3c7e02c4d88c86823c845ccbf72be6c" compoundref="rope__kernels__bf16_8c" startline="44" endline="70">rope_backward_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a371dd522b2b7ce9064f35215f1551c28" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rope_forward</definition>
        <argsstring>(float *x, const float *cos_cache, const float *sin_cache, int num_heads, int num_tokens, int head_dim, int aligned_head_dim, int pos_offset)</argsstring>
        <name>rope_forward</name>
        <param>
          <type>float *</type>
          <declname>x</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>cos_cache</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>sin_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>pos_offset</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="638" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rope_kernels.c" bodystart="89" bodyend="105" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="638" declcolumn="6"/>
        <references refid="rope__kernels_8c_1a5f7496d28aeee7bb1b5256f00f538d8a" compoundref="rope__kernels_8c" startline="57" endline="83">rope_apply_head</references>
        <referencedby refid="ckernel__engine_8h_1a241f0f417dcac38a99613c909e6f3a5d" compoundref="rope__kernels__bf16_8c" startline="21" endline="42">rope_forward_bf16</referencedby>
        <referencedby refid="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" compoundref="rope__kernels_8c" startline="199" endline="212">rope_forward_qk</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a241f0f417dcac38a99613c909e6f3a5d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rope_forward_bf16</definition>
        <argsstring>(uint16_t *x, const float *cos_cache, const float *sin_cache, int num_heads, int num_tokens, int head_dim, int aligned_head_dim, int pos_offset)</argsstring>
        <name>rope_forward_bf16</name>
        <param>
          <type>uint16_t *</type>
          <declname>x</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>cos_cache</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>sin_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>pos_offset</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="658" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rope_kernels_bf16.c" bodystart="21" bodyend="42" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="658" declcolumn="6"/>
        <references refid="rope__kernels__bf16_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="rope__kernels__bf16_8c" startline="11" endline="14">alloc_float_buffer</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="rope__kernels__bf16_8c_1ab9b5d2e5ae35502dbd6249d4aa0187d2" compoundref="rope__kernels__bf16_8c" startline="16" endline="19">free_float_buffer</references>
        <references refid="ckernel__engine_8h_1a371dd522b2b7ce9064f35215f1551c28" compoundref="rope__kernels_8c" startline="89" endline="105">rope_forward</references>
        <referencedby refid="ckernel__engine_8h_1aac704c77b897a1fbef2f63f7e7de9ef1" compoundref="rope__kernels__bf16_8c" startline="72" endline="91">rope_forward_qk_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rope_forward_qk</definition>
        <argsstring>(float *q, float *k, const float *cos_cache, const float *sin_cache, int num_heads, int num_kv_heads, int num_tokens, int head_dim, int aligned_head_dim, int pos_offset)</argsstring>
        <name>rope_forward_qk</name>
        <param>
          <type>float *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>k</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>cos_cache</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>sin_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>pos_offset</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="688" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rope_kernels.c" bodystart="199" bodyend="212" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="688" declcolumn="6"/>
        <references refid="rope__kernels_8c_1a371dd522b2b7ce9064f35215f1551c28" compoundref="rope__kernels_8c" startline="89" endline="105">rope_forward</references>
        <referencedby refid="ckernel__orchestration_8h_1ab7dfa86e5bb0d80f0e346f85e870cb1d" compoundref="ckernel__orchestration_8c" startline="403" endline="508">ck_layer_forward_rmsnorm_swiglu</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1a745d032ebb518826e284b4a3680a8cb5" compoundref="ckernel__orchestration_8c" startline="653" endline="814">ck_layer_forward_rmsnorm_swiglu_decode</referencedby>
        <referencedby refid="ckernel__orchestration_8h_1acc9d893cdd6cf7bf0dbf35d42c5f0e99" compoundref="ckernel__orchestration_8c" startline="510" endline="615">ck_layer_forward_rmsnorm_swiglu_ref</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aac704c77b897a1fbef2f63f7e7de9ef1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rope_forward_qk_bf16</definition>
        <argsstring>(uint16_t *q, uint16_t *k, const float *cos_cache, const float *sin_cache, int num_heads, int num_kv_heads, int num_tokens, int head_dim, int aligned_head_dim, int pos_offset)</argsstring>
        <name>rope_forward_qk_bf16</name>
        <param>
          <type>uint16_t *</type>
          <declname>q</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>k</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>cos_cache</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>sin_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_kv_heads</declname>
        </param>
        <param>
          <type>int</type>
          <declname>num_tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>aligned_head_dim</declname>
        </param>
        <param>
          <type>int</type>
          <declname>pos_offset</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="712" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rope_kernels_bf16.c" bodystart="72" bodyend="91" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="712" declcolumn="6"/>
        <references refid="rope__kernels__bf16_8c_1a241f0f417dcac38a99613c909e6f3a5d" compoundref="rope__kernels__bf16_8c" startline="21" endline="42">rope_forward_bf16</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a3c55e1a13ca92346f9cf41bc4453f3df" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void rope_precompute_cache</definition>
        <argsstring>(float *cos_cache, float *sin_cache, int max_seq_len, int head_dim, float base)</argsstring>
        <name>rope_precompute_cache</name>
        <param>
          <type>float *</type>
          <declname>cos_cache</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>sin_cache</declname>
        </param>
        <param>
          <type>int</type>
          <declname>max_seq_len</declname>
        </param>
        <param>
          <type>int</type>
          <declname>head_dim</declname>
        </param>
        <param>
          <type>float</type>
          <declname>base</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="631" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/rope_kernels.c" bodystart="30" bodyend="51" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="631" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aad3b3666d63fcbaa243ad4a988e187d8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void sigmoid_backward</definition>
        <argsstring>(const float *input, const float *d_output, float *d_input, size_t n)</argsstring>
        <name>sigmoid_backward</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="537" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/sigmoid_kernels.c" bodystart="123" bodyend="138" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="537" declcolumn="6"/>
        <references refid="sigmoid__kernels_8c_1aaa76ef661048368434b452a237bc3669" compoundref="sigmoid__kernels_8c" startline="11" endline="14">sigmoid_scalar</references>
        <referencedby refid="ckernel__engine_8h_1a9d34029d73d757f5283f9adcfa219705" compoundref="sigmoid__kernels__bf16_8c" startline="37" endline="64">sigmoid_backward_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a9d34029d73d757f5283f9adcfa219705" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void sigmoid_backward_bf16</definition>
        <argsstring>(const uint16_t *input, const uint16_t *d_output, uint16_t *d_input, size_t n)</argsstring>
        <name>sigmoid_backward_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="546" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/sigmoid_kernels_bf16.c" bodystart="37" bodyend="64" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="546" declcolumn="6"/>
        <references refid="sigmoid__kernels__bf16_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="sigmoid__kernels__bf16_8c" startline="8" endline="11">alloc_float_buffer</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="ckernel__engine_8h_1aad3b3666d63fcbaa243ad4a988e187d8" compoundref="sigmoid__kernels_8c" startline="123" endline="138">sigmoid_backward</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1af621782be75fb6a9acf541f7935b87d5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void sigmoid_forward</definition>
        <argsstring>(const float *input, float *output, size_t n)</argsstring>
        <name>sigmoid_forward</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="533" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/sigmoid_kernels.c" bodystart="107" bodyend="118" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="533" declcolumn="6"/>
        <references refid="sigmoid__kernels_8c_1aaa76ef661048368434b452a237bc3669" compoundref="sigmoid__kernels_8c" startline="11" endline="14">sigmoid_scalar</references>
        <referencedby refid="ckernel__engine_8h_1a2e1b89ec838297259bbde96bc2bee0c6" compoundref="sigmoid__kernels__bf16_8c" startline="13" endline="35">sigmoid_forward_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a2e1b89ec838297259bbde96bc2bee0c6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void sigmoid_forward_bf16</definition>
        <argsstring>(const uint16_t *input, uint16_t *output, size_t n)</argsstring>
        <name>sigmoid_forward_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="542" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/sigmoid_kernels_bf16.c" bodystart="13" bodyend="35" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="542" declcolumn="6"/>
        <references refid="sigmoid__kernels__bf16_8c_1aa7946eb3033d476c9c89e3dd89f23bb4" compoundref="sigmoid__kernels__bf16_8c" startline="8" endline="11">alloc_float_buffer</references>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="ckernel__engine_8h_1af621782be75fb6a9acf541f7935b87d5" compoundref="sigmoid__kernels_8c" startline="107" endline="118">sigmoid_forward</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aaa76ef661048368434b452a237bc3669" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>float sigmoid_scalar</definition>
        <argsstring>(float x)</argsstring>
        <name>sigmoid_scalar</name>
        <param>
          <type>float</type>
          <declname>x</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="531" column="7" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/sigmoid_kernels.c" bodystart="11" bodyend="14" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="531" declcolumn="7"/>
        <referencedby refid="ckernel__engine_8h_1aad3b3666d63fcbaa243ad4a988e187d8" compoundref="sigmoid__kernels_8c" startline="123" endline="138">sigmoid_backward</referencedby>
        <referencedby refid="ckernel__engine_8h_1af621782be75fb6a9acf541f7935b87d5" compoundref="sigmoid__kernels_8c" startline="107" endline="118">sigmoid_forward</referencedby>
        <referencedby refid="ckernel__engine_8h_1a2d1ada314dda9d7788371a08067917d6" compoundref="swiglu__kernels_8c" startline="45" endline="76">swiglu_backward</referencedby>
        <referencedby refid="ckernel__engine_8h_1a77fb89fc5fa2dcc73d9d37ccf9c50322" compoundref="swiglu__kernels__bf16_8c" startline="32" endline="67">swiglu_backward_bf16</referencedby>
        <referencedby refid="ckernel__engine_8h_1a26369aa07808fb6aae4502d54a1ba650" compoundref="swiglu__kernels_8c" startline="13" endline="35">swiglu_forward</referencedby>
        <referencedby refid="ckernel__engine_8h_1a41a1dfc5976b7c2e2539a2811dc0b07f" compoundref="swiglu__kernels__bf16_8c" startline="6" endline="30">swiglu_forward_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1aed0168fe0364ab17b0d9dd02b1ac3ffa" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void softmax_cross_entropy_loss</definition>
        <argsstring>(const float *logits, const int32_t *targets, int tokens, int vocab_size, float *d_logits, float *loss_out)</argsstring>
        <name>softmax_cross_entropy_loss</name>
        <param>
          <type>const float *</type>
          <declname>logits</declname>
        </param>
        <param>
          <type>const int32_t *</type>
          <declname>targets</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>vocab_size</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_logits</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>loss_out</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="790" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/loss_kernels.c" bodystart="5" bodyend="59" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="790" declcolumn="6"/>
        <referencedby refid="ckernel__engine_8h_1a5e87177162b6dd565515e53e56dcd0f5" compoundref="loss__kernels__bf16_8c" startline="8" endline="40">softmax_cross_entropy_loss_bf16</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a5e87177162b6dd565515e53e56dcd0f5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void softmax_cross_entropy_loss_bf16</definition>
        <argsstring>(const uint16_t *logits, const int32_t *targets, int tokens, int vocab_size, uint16_t *d_logits, float *loss_out)</argsstring>
        <name>softmax_cross_entropy_loss_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>logits</declname>
        </param>
        <param>
          <type>const int32_t *</type>
          <declname>targets</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>vocab_size</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_logits</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>loss_out</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="797" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/loss_kernels_bf16.c" bodystart="8" bodyend="40" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="797" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a94c0b1e3b43eb46dcce37900ed5c1333" compoundref="bf16__utils_8h" startline="30" endline="35">bf16_tensor_to_float</references>
        <references refid="bf16__utils_8h_1a027b5c4dd4c6ce7f656e922fc694e52a" compoundref="bf16__utils_8h" startline="37" endline="42">float_tensor_to_bf16</references>
        <references refid="ckernel__engine_8h_1aed0168fe0364ab17b0d9dd02b1ac3ffa" compoundref="loss__kernels_8c" startline="5" endline="59">softmax_cross_entropy_loss</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a2d1ada314dda9d7788371a08067917d6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void swiglu_backward</definition>
        <argsstring>(const float *input, const float *d_output, float *d_input, int tokens, int dim)</argsstring>
        <name>swiglu_backward</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="559" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/swiglu_kernels.c" bodystart="45" bodyend="76" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="559" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1aaa76ef661048368434b452a237bc3669" compoundref="sigmoid__kernels_8c" startline="11" endline="14">sigmoid_scalar</references>
        <referencedby refid="ckernel__orchestration_8h_1a1b75acba52e39a2063646dc1dff62ef4" compoundref="ckernel__orchestration_8c" startline="816" endline="956">ck_layer_backward_rmsnorm_swiglu</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a77fb89fc5fa2dcc73d9d37ccf9c50322" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void swiglu_backward_bf16</definition>
        <argsstring>(const uint16_t *input, const uint16_t *d_output, uint16_t *d_input, int tokens, int dim)</argsstring>
        <name>swiglu_backward_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>const uint16_t *</type>
          <declname>d_output</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>d_input</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="570" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/swiglu_kernels_bf16.c" bodystart="32" bodyend="67" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="570" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
        <references refid="ckernel__engine_8h_1aaa76ef661048368434b452a237bc3669" compoundref="sigmoid__kernels_8c" startline="11" endline="14">sigmoid_scalar</references>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a26369aa07808fb6aae4502d54a1ba650" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void swiglu_forward</definition>
        <argsstring>(const float *input, float *output, int tokens, int dim)</argsstring>
        <name>swiglu_forward</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="554" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/swiglu_kernels.c" bodystart="13" bodyend="35" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="554" declcolumn="6"/>
        <references refid="ckernel__engine_8h_1aaa76ef661048368434b452a237bc3669" compoundref="sigmoid__kernels_8c" startline="11" endline="14">sigmoid_scalar</references>
        <referencedby refid="ckernel__orchestration_8h_1a2e894b79792aaf694427446c1d89fab8" compoundref="ckernel__orchestration_8c" startline="359" endline="379">ck_mlp_swiglu_forward</referencedby>
        <referencedby refid="ckernel__orchestration_8c_1ac841f4e0a273b07808cc036a715b742e" compoundref="ckernel__orchestration_8c" startline="381" endline="401">ck_mlp_swiglu_forward_ref</referencedby>
      </memberdef>
      <memberdef kind="function" id="ckernel__engine_8h_1a41a1dfc5976b7c2e2539a2811dc0b07f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void swiglu_forward_bf16</definition>
        <argsstring>(const uint16_t *input, uint16_t *output, int tokens, int dim)</argsstring>
        <name>swiglu_forward_bf16</name>
        <param>
          <type>const uint16_t *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>uint16_t *</type>
          <declname>output</declname>
        </param>
        <param>
          <type>int</type>
          <declname>tokens</declname>
        </param>
        <param>
          <type>int</type>
          <declname>dim</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" line="565" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/kernels/swiglu_kernels_bf16.c" bodystart="6" bodyend="30" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h" declline="565" declcolumn="6"/>
        <references refid="bf16__utils_8h_1a314c3970fd5e2770d19b1bb49aefcf94" compoundref="bf16__utils_8h" startline="7" endline="15">bf16_to_float</references>
        <references refid="bf16__utils_8h_1a174b16a92b3a5972230d7519fc0c5aa3" compoundref="bf16__utils_8h" startline="17" endline="28">float_to_bf16</references>
        <references refid="ckernel__engine_8h_1aaa76ef661048368434b452a237bc3669" compoundref="sigmoid__kernels_8c" startline="11" endline="14">sigmoid_scalar</references>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#ifndef<sp/>CKERNEL_ENGINE_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CKERNEL_ENGINE_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="11"><highlight class="comment">/**</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Core<sp/>math<sp/>backend<sp/>interface<sp/>for<sp/>C-Kernel-Engine.</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>This<sp/>is<sp/>intentionally<sp/>minimal<sp/>and<sp/>matches<sp/>the<sp/>conventions<sp/>already<sp/>used</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>in<sp/>C-Transformer<sp/>for<sp/>GEMM<sp/>kernels.</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>Layout<sp/>assumptions<sp/>(LLM-style<sp/>shapes):</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/><sp/>-<sp/>A:<sp/>[M<sp/>x<sp/>K],<sp/>row-major,<sp/><sp/><sp/><sp/><sp/><sp/><sp/>A(i,k)<sp/>=<sp/>A[i*K<sp/>+<sp/>k]</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/><sp/>-<sp/>B:<sp/>[N<sp/>x<sp/>K],<sp/>row-major,<sp/><sp/><sp/><sp/><sp/><sp/><sp/>B(j,k)<sp/>=<sp/>B[j*K<sp/>+<sp/>k]</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/><sp/>-<sp/>C:<sp/>[M<sp/>x<sp/>N],<sp/>row-major,<sp/><sp/><sp/><sp/><sp/><sp/><sp/>C(i,j)<sp/>=<sp/>C[i*N<sp/>+<sp/>j]</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/><sp/>-<sp/>bias:<sp/>optional<sp/>[N],<sp/>added<sp/>per<sp/>output<sp/>column<sp/>j</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23" refid="structCKMathBackend" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="24" refid="structCKMathBackend_1a7e59ba4baa9c776241287338a219d9c4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>void<sp/>(*sgemm)(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K,</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lda,</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ldb,</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ldc);</highlight></codeline>
<codeline lineno="29"><highlight class="normal">}<sp/><ref refid="structCKMathBackend" kindref="compound">CKMathBackend</ref>;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="comment"></highlight></codeline>
<codeline lineno="31"><highlight class="comment">/**</highlight></codeline>
<codeline lineno="32"><highlight class="comment"><sp/>*<sp/>Obtain<sp/>the<sp/>built-in<sp/>native<sp/>backend<sp/>(single-node<sp/>CPU,<sp/>C<sp/>+<sp/>intrinsics).</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"><ref refid="structCKMathBackend" kindref="compound">CKMathBackend</ref><sp/><ref refid="ckernel__engine_8h_1a6c6a2e37aa74b6f118d94eb08debcff3" kindref="member">ckernel_backend_native</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Enable<sp/>stricter<sp/>numeric<sp/>parity<sp/>(single-thread<sp/>+<sp/>double-accumulation<sp/>GEMM).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a8bcb6fa03c4861c8f45d59fa424d1146" kindref="member">ck_set_strict_parity</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>enabled);</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aef8c9a331116ff9c2d77b03152aa8004" kindref="member">ck_strict_parity_enabled</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Expose<sp/>the<sp/>individual<sp/>GEMM<sp/>kernels<sp/>copied<sp/>from<sp/>C-Transformer.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a1cd1848bd75a4fb5874fe0feaa8716e4" kindref="member">gemm_naive_parallel</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a9af477f77eb64b2cdd2ccddae9c84e72" kindref="member">gemm_avx512_parallel</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1abab2d2aaed47f4c682c019bd77fab1ed" kindref="member">gemm_fine_grained_parallel</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1af4f0e756d3ac00b45ce2c7a296b61ae3" kindref="member">gemm_blocked_serial</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Reference<sp/>BF16<sp/>GEMM<sp/>(A/B/bias<sp/>in<sp/>BF16,<sp/>output<sp/>BF16).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a9020b3311acc4db83cc7243b3d13d439" kindref="member">gemm_blocked_serial_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*A,</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*B,</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*bias,</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*C,</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="comment">//<sp/>GEMM_NN:<sp/>C[M,N]<sp/>=<sp/>A[M,K]<sp/>@<sp/>B[K,N]<sp/>+<sp/>bias[N]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="comment">//<sp/>B<sp/>is<sp/>stored<sp/>row-major<sp/>as<sp/>[K,N]<sp/>(no<sp/>transpose<sp/>on<sp/>B)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Used<sp/>for<sp/>backward<sp/>d_input<sp/>=<sp/>d_output<sp/>@<sp/>W</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a3549b849a914ea46c5d51c7d485fecec" kindref="member">gemm_nn_parallel</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a91c10e18555ecb27791d5405c8dc3ae4" kindref="member">gemm_nn_avx512</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1afd447dc190bd77241a42d8972f9c5fba" kindref="member">gemm_nn_blocked</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="comment">//<sp/>GEMM_TN:<sp/>C[M,N]<sp/>=<sp/>A[K,M].T<sp/>@<sp/>B[K,N]<sp/>+<sp/>bias[N]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight><highlight class="comment">//<sp/>A<sp/>is<sp/>stored<sp/>row-major<sp/>as<sp/>[K,M],<sp/>B<sp/>is<sp/>stored<sp/>row-major<sp/>as<sp/>[K,N]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Used<sp/>for<sp/>backward<sp/>d_W<sp/>=<sp/>d_output.T<sp/>@<sp/>input</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a84ce00fad7103b550ea75b52a21a98f7" kindref="member">gemm_tn_parallel</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1afe5bf17f909def227c3e25b0c4338f93" kindref="member">gemm_tn_avx512</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ae3bc36ea7b8562f9121e527f0f408b43" kindref="member">gemm_tn_blocked</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Fused<sp/>GEMM<sp/>operations<sp/>(GEMM<sp/>+<sp/>bias<sp/>+<sp/>activation<sp/>in<sp/>one<sp/>pass)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a3b3b32e0000c63586cddb9be0eda5daf" kindref="member">gemm_bias_relu_fused</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ad9b7d9471502870fc90e12a2416e5f49" kindref="member">gemm_bias_gelu_fused</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a26763168556236dee899fe08699cc826" kindref="member">gemm_bias_silu_fused</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*bias,</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Fused<sp/>GEMM<sp/>+<sp/>SwiGLU<sp/>(LLaMA/SmolLM<sp/>MLP<sp/>gate+up<sp/>projection)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Computes:<sp/>output<sp/>=<sp/>SiLU(x<sp/>@<sp/>W_gate<sp/>+<sp/>b_gate)<sp/>*<sp/>(x<sp/>@<sp/>W_up<sp/>+<sp/>b_up)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Two<sp/>GEMMs<sp/>+<sp/>SwiGLU<sp/>fused<sp/>into<sp/>one<sp/>pass<sp/>-<sp/>intermediates<sp/>stay<sp/>in<sp/>registers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a2ae3bbf03cebc529c1e7962a7dba2568" kindref="member">gemm_swiglu_fused</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*x,</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*W_gate,</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*W_up,</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b_gate,<sp/><sp/></highlight><highlight class="comment">//<sp/>can<sp/>be<sp/>NULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b_up,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>can<sp/>be<sp/>NULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight><highlight class="comment">//<sp/>High-performance<sp/>GEMM<sp/>microkernel<sp/>with<sp/>8x8<sp/>register<sp/>blocking</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Inspired<sp/>by<sp/>oneDNN/BLIS<sp/>-<sp/>keeps<sp/>all<sp/>64<sp/>accumulator<sp/>values<sp/>in<sp/>registers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight><highlight class="comment">//<sp/>C[M,N]<sp/>=<sp/>A[M,K]<sp/>@<sp/>B[K,N]<sp/>or<sp/>C[M,N]<sp/>=<sp/>A[M,K]<sp/>@<sp/>B[N,K].T</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight><highlight class="comment">//<sp/>B_transposed:<sp/>0<sp/>=<sp/>B<sp/>is<sp/>[K,N],<sp/>1<sp/>=<sp/>B<sp/>is<sp/>[N,K]<sp/>(transposed,<sp/>common<sp/>in<sp/>NN<sp/>weights)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a594a440cd88e67b89068125123f52c9e" kindref="member">gemm_microkernel</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K,</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>B_transposed);</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Cache-blocked<sp/>GEMM<sp/>using<sp/>8x8<sp/>microkernels<sp/>(B<sp/>not<sp/>transposed)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ac779265214c020d37db4915eee9937c8" kindref="member">gemm_microkernel_blocked</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Cache-blocked<sp/>GEMM<sp/>for<sp/>B<sp/>transposed<sp/>(common<sp/>in<sp/>NN)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1add90afcf3ff08dff14e0c824ad1075f6" kindref="member">gemm_microkernel_blocked_bt</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Optimized<sp/>GEMM<sp/>with<sp/>matrix<sp/>packing<sp/>(best<sp/>for<sp/>large<sp/>matrices)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Packs<sp/>A<sp/>and<sp/>B<sp/>into<sp/>contiguous<sp/>layouts<sp/>for<sp/>optimal<sp/>cache<sp/>access</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1af4c2881c7acb7acd3e792dcce0469e27" kindref="member">gemm_microkernel_packed</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*A,</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*B,</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*C,</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>M,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>K);</highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight><highlight class="comment">//<sp/>LayerNorm<sp/>forward<sp/>kernels,<sp/>copied<sp/>from<sp/>C-Transformer.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a72f2038f01b5790f7235b5371d1f4d72" kindref="member">layernorm_naive_serial</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*beta,</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*mean_cache,</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd_cache,</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>eps);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ace47573bf5278260d2652f4fb069bb9e" kindref="member">layernorm_forward_rolled_slice</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>input_slice_base,</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>gamma,</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>beta,</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>output_slice_base,</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>mean_cache_slice,</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>rstd_cache_slice,</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens_in_slice,</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>eps);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aed96ddab9e3b51974364c6a5dd5852a6" kindref="member">layernorm_forward_rolled_slice_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*__restrict<sp/>input_slice_base,</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>gamma,</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>beta,</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*__restrict<sp/>output_slice_base,</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>mean_cache_slice,</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>rstd_cache_slice,</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens_in_slice,</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>eps);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1afd2e784d7b2b3ac7eb93e6f87c091fae" kindref="member">layernorm_forward_unrolled_slice</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>input_slice_base,</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>gamma,</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>beta,</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>output_slice_base,</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>mean_cache_slice,</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>rstd_cache_slice,</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens_in_slice,</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>eps);</highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a4b36f606ec3110c6da3844b3633b1aaf" kindref="member">layernorm_forward_unrolled_slice_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*__restrict<sp/>input_slice_base,</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>gamma,</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>beta,</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*__restrict<sp/>output_slice_base,</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>mean_cache_slice,</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*__restrict<sp/>rstd_cache_slice,</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens_in_slice,</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>eps);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a3c0c758ac557839bfc06d1037d15b91e" kindref="member">layernorm_naive_serial_matched_precision</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*beta,</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*mean_cache,</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd_cache,</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>eps);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a8d349f047d6654b3a351fb62e0b20e87" kindref="member">layernorm_backward_kernel</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*mean,</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd,</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_input,</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_gamma,</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_beta,</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim);</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ab4fae76462b8dfdda429b265c41ec9f0" kindref="member">layernorm_backward_kernel_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*mean,</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd,</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_input,</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_gamma,</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_beta,</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim);</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight><highlight class="comment">//<sp/>RMSNorm<sp/>forward/backward<sp/>kernels.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a9a068ed02d809a81a23f09e61b820baf" kindref="member">rmsnorm_forward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd_cache,</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>eps);</highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aca68d7dda1a7de9ff926920804751db0" kindref="member">rmsnorm_backward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd_cache,</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_input,</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_gamma,</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim);</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a4f024774420774821f805d0742694d02" kindref="member">rmsnorm_forward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*output,</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd_cache,</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>eps);</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a14d80153de303766038a231e4932e357" kindref="member">rmsnorm_backward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd_cache,</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_input,</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_gamma,</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim);</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a49c1ca0d6c659c9d5623fa64dde4ecc3" kindref="member">rmsnorm_forward_int8</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int8_t<sp/>*input,</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int8_t<sp/>*output,</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd_cache,</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>eps);</highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1afebfbf40a74543cc5cb371c6ff5f4711" kindref="member">rmsnorm_backward_int8</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int8_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int8_t<sp/>*input,</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd_cache,</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int8_t<sp/>*d_input,</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_gamma,</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1abb168afab2b3523fbdf26569ab0afa66" kindref="member">rmsnorm_forward_int4</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*input,</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint8_t<sp/>*output,</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd_cache,</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>eps);</highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ab35eb653240c86b2b1a41b88233c90be" kindref="member">rmsnorm_backward_int4</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*input,</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gamma,</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*rstd_cache,</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint8_t<sp/>*d_input,</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_gamma,</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d_model,</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim);</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight><highlight class="comment">//<sp/>GELU<sp/>forward<sp/>kernel<sp/>(fast<sp/>approximation),<sp/>copied<sp/>from<sp/>C-Transformer.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1abc5977fca1e95c2406a779657c4d2365" kindref="member">gelu_fast_inplace</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*data,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a3075b77764b4b408e3c1c9b89a2822ad" kindref="member">gelu_backward_exact</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_input,</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="337"><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aeaf518a5239f4588f8c28b05b96d5478" kindref="member">gelu_backward_fast</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_input,</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight><highlight class="comment">//<sp/>BF16<sp/>variants<sp/>relying<sp/>on<sp/>the<sp/>same<sp/>floating-point<sp/>logic.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aa64dae6724ac5d649be339cad62126cb" kindref="member">gelu_fast_inplace_bf16</ref>(uint16_t<sp/>*data,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ac8572265a21098caf2060797cb18a978" kindref="member">gelu_backward_exact_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_input,</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="349"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a27adb4761d436aeea3317ce0595dc67a" kindref="member">gelu_backward_fast_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_input,</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="353"><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ReLU<sp/>kernels.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a856216dca72f3534c079f429d1d58d48" kindref="member">relu_forward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1abbc4f192b13bed9ed1614c99cee2db91" kindref="member">relu_forward_inplace</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*data,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a434da7f0647cdada09cd6ad435560467" kindref="member">relu_backward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_input,</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a842c2002210a04d9dc4d9bdabed4fcc2" kindref="member">relu_forward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,<sp/>uint16_t<sp/>*output,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a55d24741c224580192c6104c2eb4525a" kindref="member">relu_forward_inplace_bf16</ref>(uint16_t<sp/>*data,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1af64829ad63a9c81784d64d4f447ee39a" kindref="member">relu_backward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_input,</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Causal<sp/>softmax<sp/>kernel<sp/>on<sp/>head-major<sp/>attention<sp/>scores,<sp/>copied<sp/>from<sp/>C-Transformer.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a920868f80137fe3e0c9cd11acb7ba567" kindref="member">causal_softmax_head_major</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*scores,</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_context_window);</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a3d0ffc191c77d983b953984f8012589d" kindref="member">backward_causal_softmax_head_major</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_scores,</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*weights,</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_context_window);</highlight></codeline>
<codeline lineno="380"><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a1cc637a888846ddbcf1a58ac72b4aaf6" kindref="member">causal_softmax_head_major_bf16</ref>(uint16_t<sp/>*scores,</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_context_window);</highlight></codeline>
<codeline lineno="385"><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1afe83b7a562f3b21fef1993782ff3792b" kindref="member">backward_causal_softmax_head_major_bf16</ref>(uint16_t<sp/>*d_scores,</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*weights,</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_context_window);</highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Scaled<sp/>dot-product<sp/>attention<sp/>(causal)<sp/>in<sp/>head-major<sp/>layout.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Q/K/V<sp/>layout:<sp/>[head][token][head_dim]<sp/>with<sp/>stride<sp/>aligned_head_dim.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"></highlight><highlight class="comment">//<sp/>scores:<sp/>[head][query_token][key_token]<sp/>with<sp/>stride<sp/>aligned_context_window.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight><highlight class="comment">//<sp/>output:<sp/>same<sp/>layout<sp/>as<sp/>Q/V.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a3d8664b9e0808546484af9ec7d4ddfe1" kindref="member">attention_forward_causal_head_major</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*q,</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k,</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*v,</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*scores,</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_context_window);</highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"></highlight><highlight class="comment">//<sp/>GQA-aware<sp/>attention:<sp/>Q<sp/>has<sp/>num_heads,<sp/>K/V<sp/>have<sp/>num_kv_heads.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a3e1aa7c55e515fd996318da27c2c5ade" kindref="member">attention_forward_causal_head_major_gqa</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*q,</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k,</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*v,</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*scores,</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_context_window);</highlight></codeline>
<codeline lineno="419"><highlight class="normal"></highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1af749b0ec6a9cc8a63033fa2069759722" kindref="member">attention_forward_causal_head_major_gqa_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*q,</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*k,</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*v,</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*scores,</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_context_window);</highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Flash-style<sp/>causal<sp/>attention<sp/>forward<sp/>(no<sp/>score/weight<sp/>matrix<sp/>materialization).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Head-major<sp/>layout:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>Q:<sp/>[num_heads,<sp/>num_tokens,<sp/>aligned_head_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>K/V:<sp/>[num_kv_heads,<sp/>num_tokens,<sp/>aligned_head_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>out:<sp/>[num_heads,<sp/>num_tokens,<sp/>aligned_head_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aac305a28084fe73b2264ae57613ba3ea" kindref="member">attention_forward_causal_head_major_gqa_flash</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*q,</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k,</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*v,</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim);</highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Decode<sp/>attention<sp/>for<sp/>a<sp/>single<sp/>token<sp/>using<sp/>a<sp/>KV<sp/>cache.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>q_token:<sp/>[num_heads,<sp/>aligned_head_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>k_cache/v_cache:<sp/>[num_kv_heads,<sp/>cache_capacity,<sp/>aligned_head_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="450"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>out_token:<sp/>[num_heads,<sp/>aligned_head_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a84803f8c5509c325dd6b9feec50a0493" kindref="member">attention_forward_decode_head_major_gqa_flash</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*q_token,</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k_cache,</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*v_cache,</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*out_token,</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>kv_tokens,</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cache_capacity,</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim);</highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"></highlight><highlight class="comment">//<sp/>KV<sp/>cache<sp/>helper<sp/>(write<sp/>one<sp/>token<sp/>for<sp/>all<sp/>KV<sp/>heads).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a1b1c905b9d69fc8aadca4c714147ce45" kindref="member">kv_cache_write_head_major</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k_token,</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*v_token,</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k_cache,</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*v_cache,</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_index,</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cache_capacity,</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim);</highlight></codeline>
<codeline lineno="472"><highlight class="normal"></highlight></codeline>
<codeline lineno="473"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Repack<sp/>a<sp/>head-major<sp/>tensor<sp/>from<sp/>a<sp/>packed<sp/>`[head,<sp/>tokens,<sp/>aligned_head_dim]`</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"></highlight><highlight class="comment">//<sp/>layout<sp/>into<sp/>a<sp/>KV-cache-compatible<sp/>layout<sp/>`[head,<sp/>cache_capacity,<sp/>aligned_head_dim]`</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"></highlight><highlight class="comment">//<sp/>in-place.<sp/>This<sp/>is<sp/>used<sp/>after<sp/>prefill<sp/>when<sp/>forward<sp/>kernels<sp/>write<sp/>head<sp/>slices</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"></highlight><highlight class="comment">//<sp/>back-to-back<sp/>using<sp/>`tokens`<sp/>as<sp/>the<sp/>head<sp/>stride,<sp/>but<sp/>decode<sp/>expects<sp/>a<sp/>fixed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"></highlight><highlight class="comment">//<sp/>`cache_capacity`<sp/>stride.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a377bab84fd3d4ba79cf92024615c240a" kindref="member">kv_cache_repack_head_major_inplace</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*buf,</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cache_capacity,</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim);</highlight></codeline>
<codeline lineno="483"><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight><highlight class="comment">//<sp/>MLP<sp/>forward<sp/>kernel<sp/>(FC1<sp/>-&gt;<sp/>GELU<sp/>-&gt;<sp/>FC2),<sp/>generic<sp/>token-parallel<sp/>version.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a5b4ac7df82788956de18c6e1b4f37609" kindref="member">mlp_token_parallel</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*W_fc1,</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b_fc1,</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*W_fc2,</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*b_fc2,</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*fc1_output,</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>T,</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_dim,</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_threads);</highlight></codeline>
<codeline lineno="495"><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a488697bbc4656ba8037ab3eb79314e5e" kindref="member">mlp_token_parallel_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*W_fc1,</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*b_fc1,</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*W_fc2,</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*b_fc2,</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*fc1_output,</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>T,</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_dim,</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_threads);</highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"></highlight><highlight class="comment">//<sp/>MLP<sp/>FC1/FC2<sp/>backward<sp/>kernels<sp/>(generic),<sp/>adapted<sp/>from<sp/>C-Transformer.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="508"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a89a29fc853aae0baf9f6094fee52562a" kindref="member">fc2_backward_kernel</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*fc2_input,</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*W_fc2,</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_input,</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_W_fc2,</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_b_fc2,</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>T,</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_in,</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_out,</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_threads);</highlight></codeline>
<codeline lineno="518"><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a73e088d0e2388c78920e8fc99b0c3846" kindref="member">fc1_backward_kernel</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*fc1_input,</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*W_fc1,</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_input,</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_W_fc1,</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_b_fc1,</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>T,</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_in,</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_out,</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_threads);</highlight></codeline>
<codeline lineno="529"><highlight class="normal"></highlight></codeline>
<codeline lineno="530"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Sigmoid<sp/>kernels<sp/>(scalar<sp/>+<sp/>vector<sp/>forms).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aaa76ef661048368434b452a237bc3669" kindref="member">sigmoid_scalar</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>x);</highlight></codeline>
<codeline lineno="532"><highlight class="normal"></highlight></codeline>
<codeline lineno="533"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1af621782be75fb6a9acf541f7935b87d5" kindref="member">sigmoid_forward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aad3b3666d63fcbaa243ad4a988e187d8" kindref="member">sigmoid_backward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_input,</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="541"><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a2e1b89ec838297259bbde96bc2bee0c6" kindref="member">sigmoid_forward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*output,</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="545"><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a9d34029d73d757f5283f9adcfa219705" kindref="member">sigmoid_backward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_input,</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>n);</highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"></highlight><highlight class="comment">//<sp/>SwiGLU<sp/>activation<sp/>kernels<sp/>(forward<sp/>+<sp/>backward).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Input<sp/>layout<sp/>per<sp/>token:<sp/>[gate[0..D-1],<sp/>value[0..D-1]],<sp/>size<sp/>2*D.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Output:<sp/>[D].</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a26369aa07808fb6aae4502d54a1ba650" kindref="member">swiglu_forward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim);</highlight></codeline>
<codeline lineno="558"><highlight class="normal"></highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a2d1ada314dda9d7788371a08067917d6" kindref="member">swiglu_backward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*input,</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_input,</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a41a1dfc5976b7c2e2539a2811dc0b07f" kindref="member">swiglu_forward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*output,</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim);</highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a77fb89fc5fa2dcc73d9d37ccf9c50322" kindref="member">swiglu_backward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*input,</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_input,</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim);</highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Attention<sp/>backward<sp/>(GQA-aware):<sp/>computes<sp/>d_q,<sp/>d_k,<sp/>d_v.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1adbd2b55fbc53b6e288c98813b61cd6e3" kindref="member">attention_backward_causal_head_major_gqa</ref>(</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*q,</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k,</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*v,</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*attn_weights,</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_q,</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_k,</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_v,</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_scores,</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_context_window);</highlight></codeline>
<codeline lineno="593"><highlight class="normal"></highlight></codeline>
<codeline lineno="594"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Attention<sp/>backward<sp/>(non-GQA):<sp/>num_kv_heads<sp/>==<sp/>num_heads.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="595"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ad611fd5e8dba3e906482d6e68f919788" kindref="member">attention_backward_causal_head_major</ref>(</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*q,</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k,</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*v,</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*attn_weights,</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_q,</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_k,</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_v,</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_scores,</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_context_window);</highlight></codeline>
<codeline lineno="610"><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a1a95c2e93bfbe603df487d0c0eb5ea2b" kindref="member">attention_backward_causal_head_major_gqa_bf16</ref>(</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_x,</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*q,</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*k,</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*v,</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*attn_weights,</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_q,</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_k,</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_v,</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_scores,</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_context_window);</highlight></codeline>
<codeline lineno="628"><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"></highlight><highlight class="comment">//<sp/>RoPE<sp/>(Rotary<sp/>Position<sp/>Embedding)<sp/>kernels.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Precompute<sp/>cos/sin<sp/>cache:<sp/>[max_seq_len,<sp/>head_dim/2].</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a3c55e1a13ca92346f9cf41bc4453f3df" kindref="member">rope_precompute_cache</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*cos_cache,</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*sin_cache,</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>max_seq_len,</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>base);</highlight></codeline>
<codeline lineno="636"><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Apply<sp/>RoPE<sp/>forward<sp/>in-place:<sp/>x[num_heads,<sp/>num_tokens,<sp/>aligned_head_dim].</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="638"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a371dd522b2b7ce9064f35215f1551c28" kindref="member">rope_forward</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*x,</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*cos_cache,</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*sin_cache,</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pos_offset);</highlight></codeline>
<codeline lineno="646"><highlight class="normal"></highlight></codeline>
<codeline lineno="647"><highlight class="normal"></highlight><highlight class="comment">//<sp/>RoPE<sp/>backward:<sp/>inverse<sp/>rotation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1af248ca325f0a6837ed9bfd3d34552c00" kindref="member">rope_backward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_out,</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_x,</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*cos_cache,</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*sin_cache,</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pos_offset);</highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a241f0f417dcac38a99613c909e6f3a5d" kindref="member">rope_forward_bf16</ref>(uint16_t<sp/>*x,</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*cos_cache,</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*sin_cache,</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pos_offset);</highlight></codeline>
<codeline lineno="666"><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ad3c7e02c4d88c86823c845ccbf72be6c" kindref="member">rope_backward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_out,</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_x,</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*cos_cache,</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*sin_cache,</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pos_offset);</highlight></codeline>
<codeline lineno="676"><highlight class="normal"></highlight></codeline>
<codeline lineno="677"><highlight class="normal"></highlight><highlight class="comment">//<sp/>RoPE<sp/>backward<sp/>in-place.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a71f922f5016760db12457ed82924ded3" kindref="member">rope_backward_inplace</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_x,</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*cos_cache,</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*sin_cache,</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pos_offset);</highlight></codeline>
<codeline lineno="686"><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Combined<sp/>RoPE<sp/>for<sp/>Q<sp/>and<sp/>K.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ab18869516e9a6ab5998038716ac8a179" kindref="member">rope_forward_qk</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*q,</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*k,</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*cos_cache,</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*sin_cache,</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pos_offset);</highlight></codeline>
<codeline lineno="698"><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a42fa03f293de94c5422681ada891a24f" kindref="member">rope_backward_qk</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_q_out,</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_k_out,</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_q,</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_k,</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*cos_cache,</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*sin_cache,</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pos_offset);</highlight></codeline>
<codeline lineno="711"><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aac704c77b897a1fbef2f63f7e7de9ef1" kindref="member">rope_forward_qk_bf16</ref>(uint16_t<sp/>*q,</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*k,</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*cos_cache,</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*sin_cache,</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pos_offset);</highlight></codeline>
<codeline lineno="722"><highlight class="normal"></highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a76d3e6e058074c51a76a252ab61eb5fa" kindref="member">rope_backward_qk_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_q_out,</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_k_out,</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_q,</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_k,</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*cos_cache,</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*sin_cache,</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_heads,</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_kv_heads,</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_tokens,</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>head_dim,</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_head_dim,</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pos_offset);</highlight></codeline>
<codeline lineno="735"><highlight class="normal"></highlight></codeline>
<codeline lineno="736"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Token<sp/>embedding<sp/>lookup<sp/>(optionally<sp/>adds<sp/>positional<sp/>embeddings).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="737"><highlight class="normal"></highlight><highlight class="comment">//<sp/>token_embeddings:<sp/>[vocab_size<sp/>x<sp/>aligned_embed_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="738"><highlight class="normal"></highlight><highlight class="comment">//<sp/>pos_embeddings:<sp/>[context_window<sp/>x<sp/>aligned_embed_dim]<sp/>or<sp/>NULL<sp/>if<sp/>add_pos<sp/>==<sp/>0.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="739"><highlight class="normal"></highlight><highlight class="comment">//<sp/>output:<sp/>[context_window<sp/>x<sp/>aligned_embed_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1ad6f7e7937754e791a704562549e39f05" kindref="member">embedding_forward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int32_t<sp/>*token_ids,</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_count,</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vocab_size,</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*token_embeddings,</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*pos_embeddings,</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*output,</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>embed_dim,</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>context_window,</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>add_pos);</highlight></codeline>
<codeline lineno="750"><highlight class="normal"></highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a6d58689c662e670a5423eedd0291d6b5" kindref="member">embedding_forward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int32_t<sp/>*token_ids,</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_count,</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vocab_size,</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*token_embeddings,</highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*pos_embeddings,</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*output,</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>embed_dim,</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>context_window,</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>add_pos);</highlight></codeline>
<codeline lineno="761"><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Embedding<sp/>backward:<sp/>accumulates<sp/>into<sp/>d_token_embeddings<sp/>and<sp/>d_pos_embeddings.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="763"><highlight class="normal"></highlight><highlight class="comment">//<sp/>d_output:<sp/>[context_window<sp/>x<sp/>aligned_embed_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="764"><highlight class="normal"></highlight><highlight class="comment">//<sp/>d_token_embeddings:<sp/>[vocab_size<sp/>x<sp/>aligned_embed_dim]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="765"><highlight class="normal"></highlight><highlight class="comment">//<sp/>d_pos_embeddings:<sp/>[context_window<sp/>x<sp/>aligned_embed_dim]<sp/>(optional)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a7fb7087da26dca964798795062f5b0a5" kindref="member">embedding_backward</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int32_t<sp/>*token_ids,</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_count,</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_output,</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_token_embeddings,</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_pos_embeddings,</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vocab_size,</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>embed_dim,</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>context_window,</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>add_pos);</highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a7c57b105fb88eb4165a0c649932be08d" kindref="member">embedding_backward_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int32_t<sp/>*token_ids,</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>token_count,</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_output,</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_token_embeddings,</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_pos_embeddings,</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vocab_size,</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>embed_dim,</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>aligned_embed_dim,</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>context_window,</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>add_pos);</highlight></codeline>
<codeline lineno="787"><highlight class="normal"></highlight></codeline>
<codeline lineno="788"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Softmax<sp/>cross-entropy<sp/>loss<sp/>+<sp/>gradient<sp/>w.r.t<sp/>logits.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="789"><highlight class="normal"></highlight><highlight class="comment">//<sp/>logits:<sp/>[tokens<sp/>x<sp/>vocab_size],<sp/>targets:<sp/>[tokens],<sp/>d_logits:<sp/>[tokens<sp/>x<sp/>vocab_size]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aed0168fe0364ab17b0d9dd02b1ac3ffa" kindref="member">softmax_cross_entropy_loss</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*logits,</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int32_t<sp/>*targets,</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vocab_size,</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_logits,</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*loss_out);</highlight></codeline>
<codeline lineno="796"><highlight class="normal"></highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a5e87177162b6dd565515e53e56dcd0f5" kindref="member">softmax_cross_entropy_loss_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*logits,</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int32_t<sp/>*targets,</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tokens,</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>vocab_size,</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_logits,</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*loss_out);</highlight></codeline>
<codeline lineno="803"><highlight class="normal"></highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Vision<sp/>helpers<sp/>(patchify/unpatchify).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a86aec042bcceb0bd8955f0daf0d986c4" kindref="member">im2patch</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*image,</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*patches,</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>C,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>H,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>W,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>P);</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a3ffa58aab7da5c6e77096ad19385329a" kindref="member">patch2im</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_patches,</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*d_image,</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>C,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>H,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>W,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>P);</highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1a57139580e075be2d5a65cfffc8e84898" kindref="member">im2patch_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*image,</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*patches,</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>C,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>H,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>W,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>P);</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ckernel__engine_8h_1aee95c2d2b45191471be617739a41ac0d" kindref="member">patch2im_bf16</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint16_t<sp/>*d_patches,</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>*d_image,</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>C,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>H,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>W,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>P);</highlight></codeline>
<codeline lineno="818"><highlight class="normal"></highlight></codeline>
<codeline lineno="819"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="820"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>extern<sp/>&quot;C&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="821"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="822"><highlight class="normal"></highlight></codeline>
<codeline lineno="823"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">//<sp/>CKERNEL_ENGINE_H</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/ckernel_engine.h"/>
  </compounddef>
</doxygen>
