<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="cpu__features_8h" kind="file" language="C++">
    <compoundname>cpu_features.h</compoundname>
    <includes local="no">stdint.h</includes>
    <includes local="no">stddef.h</includes>
    <includedby refid="ckernel__engine_8h" local="yes">ckernel_engine.h</includedby>
    <includedby refid="cpu__features_8c" local="yes">cpu_features.c</includedby>
    <includedby refid="gemm__microkernel_8c" local="yes">gemm_microkernel.c</includedby>
    <incdepgraph>
      <node id="2">
        <label>stdint.h</label>
      </node>
      <node id="3">
        <label>stddef.h</label>
      </node>
      <node id="1">
        <label>cpu_features.h</label>
        <link refid="cpu__features_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="23">
        <label>rmsnorm_kernels_int8.c</label>
        <link refid="rmsnorm__kernels__int8_8c"/>
      </node>
      <node id="24">
        <label>rope_kernels_bf16.c</label>
        <link refid="rope__kernels__bf16_8c"/>
      </node>
      <node id="20">
        <label>relu_kernels_bf16.c</label>
        <link refid="relu__kernels__bf16_8c"/>
      </node>
      <node id="25">
        <label>sigmoid_kernels_bf16.c</label>
        <link refid="sigmoid__kernels__bf16_8c"/>
      </node>
      <node id="3">
        <label>backend_native.c</label>
        <link refid="backend__native_8c"/>
      </node>
      <node id="27">
        <label>swiglu_kernels.c</label>
        <link refid="swiglu__kernels_8c"/>
      </node>
      <node id="5">
        <label>ckernel_strict.c</label>
        <link refid="ckernel__strict_8c"/>
      </node>
      <node id="17">
        <label>loss_kernels_bf16.c</label>
        <link refid="loss__kernels__bf16_8c"/>
      </node>
      <node id="11">
        <label>gemm_kernels.c</label>
        <link refid="gemm__kernels_8c"/>
      </node>
      <node id="6">
        <label>attention_kernels.c</label>
        <link refid="attention__kernels_8c"/>
      </node>
      <node id="12">
        <label>gemm_kernels_bf16.c</label>
        <link refid="gemm__kernels__bf16_8c"/>
      </node>
      <node id="2">
        <label>ckernel_engine.h</label>
        <link refid="ckernel__engine_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>gemm_fused_kernels.c</label>
        <link refid="gemm__fused__kernels_8c"/>
      </node>
      <node id="18">
        <label>mlp_kernels.c</label>
        <link refid="mlp__kernels_8c"/>
      </node>
      <node id="28">
        <label>swiglu_kernels_bf16.c</label>
        <link refid="swiglu__kernels__bf16_8c"/>
      </node>
      <node id="4">
        <label>ckernel_orchestration.c</label>
        <link refid="ckernel__orchestration_8c"/>
      </node>
      <node id="15">
        <label>layernorm_kernels_bf16.c</label>
        <link refid="layernorm__kernels__bf16_8c"/>
      </node>
      <node id="8">
        <label>embedding_kernels_bf16.c</label>
        <link refid="embedding__kernels__bf16_8c"/>
      </node>
      <node id="13">
        <label>gemm_microkernel.c</label>
        <link refid="gemm__microkernel_8c"/>
      </node>
      <node id="19">
        <label>mlp_kernels_bf16.c</label>
        <link refid="mlp__kernels__bf16_8c"/>
      </node>
      <node id="26">
        <label>softmax_kernels_bf16.c</label>
        <link refid="softmax__kernels__bf16_8c"/>
      </node>
      <node id="16">
        <label>loss_kernels.c</label>
        <link refid="loss__kernels_8c"/>
      </node>
      <node id="9">
        <label>gelu_kernels_bf16.c</label>
        <link refid="gelu__kernels__bf16_8c"/>
      </node>
      <node id="30">
        <label>cpu_features.c</label>
        <link refid="cpu__features_8c"/>
      </node>
      <node id="14">
        <label>kv_cache_kernels.c</label>
        <link refid="kv__cache__kernels_8c"/>
      </node>
      <node id="21">
        <label>rmsnorm_kernels_bf16.c</label>
        <link refid="rmsnorm__kernels__bf16_8c"/>
      </node>
      <node id="29">
        <label>vision_kernels_bf16.c</label>
        <link refid="vision__kernels__bf16_8c"/>
      </node>
      <node id="7">
        <label>embedding_kernels.c</label>
        <link refid="embedding__kernels_8c"/>
      </node>
      <node id="1">
        <label>cpu_features.h</label>
        <link refid="cpu__features_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="22">
        <label>rmsnorm_kernels_int4.c</label>
        <link refid="rmsnorm__kernels__int4_8c"/>
      </node>
    </invincdepgraph>
    <innerclass refid="structCPUInfo" prot="public">CPUInfo</innerclass>
    <innerclass refid="structGEMMParams" prot="public">GEMMParams</innerclass>
      <sectiondef kind="var">
      <memberdef kind="variable" id="cpu__features_8h_1a87e02c44ce8117ceb227f928980a175a" prot="public" static="no" mutable="no">
        <type><ref refid="structCPUInfo" kindref="compound">CPUInfo</ref></type>
        <definition>CPUInfo g_cpu_info</definition>
        <argsstring></argsstring>
        <name>g_cpu_info</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>CPU Feature Detection and Cache-Aware Parameter Tuning</para>
<para>Detects CPU features, cache sizes, and core counts at runtime. Computes optimal GEMM blocking parameters based on actual hardware. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" line="42" column="16" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/cpu_features.c" bodystart="28" bodyend="-1" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" declline="42" declcolumn="16"/>
        <referencedby refid="cpu__features_8h_1ab051fa0f4c2fc0723066eab07401fed6" compoundref="cpu__features_8c" startline="344" endline="370">cpu_features_init</referencedby>
        <referencedby refid="cpu__features_8h_1a3c6e32bab9ac6dbe68fb4f17d6378e7d" compoundref="cpu__features_8c" startline="377" endline="380">get_cpu_info</referencedby>
        <referencedby refid="cpu__features_8h_1a538a4414821926cda2c9e989764c00fd" compoundref="cpu__features_8c" startline="382" endline="402">print_cpu_info</referencedby>
      </memberdef>
      <memberdef kind="variable" id="cpu__features_8h_1a9f67b8a4e1c74de8b6f0d8b535e44877" prot="public" static="no" mutable="no">
        <type>int</type>
        <definition>int g_cpu_initialized</definition>
        <argsstring></argsstring>
        <name>g_cpu_initialized</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" line="44" column="12" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/cpu_features.c" bodystart="30" bodyend="-1" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" declline="44" declcolumn="12"/>
        <referencedby refid="cpu__features_8h_1ab051fa0f4c2fc0723066eab07401fed6" compoundref="cpu__features_8c" startline="344" endline="370">cpu_features_init</referencedby>
        <referencedby refid="cpu__features_8h_1a3c6e32bab9ac6dbe68fb4f17d6378e7d" compoundref="cpu__features_8c" startline="377" endline="380">get_cpu_info</referencedby>
        <referencedby refid="cpu__features_8h_1ab1ad13308616a6d3d811b97eef9abfe6" compoundref="cpu__features_8c" startline="372" endline="375">get_gemm_params</referencedby>
        <referencedby refid="cpu__features_8h_1a538a4414821926cda2c9e989764c00fd" compoundref="cpu__features_8c" startline="382" endline="402">print_cpu_info</referencedby>
      </memberdef>
      <memberdef kind="variable" id="cpu__features_8h_1add9495a8b0827ace67807e0826a890d1" prot="public" static="no" mutable="no">
        <type><ref refid="structGEMMParams" kindref="compound">GEMMParams</ref></type>
        <definition>GEMMParams g_gemm_params</definition>
        <argsstring></argsstring>
        <name>g_gemm_params</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" line="43" column="19" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/cpu_features.c" bodystart="29" bodyend="-1" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" declline="43" declcolumn="19"/>
        <referencedby refid="cpu__features_8h_1ab051fa0f4c2fc0723066eab07401fed6" compoundref="cpu__features_8c" startline="344" endline="370">cpu_features_init</referencedby>
        <referencedby refid="cpu__features_8h_1ab1ad13308616a6d3d811b97eef9abfe6" compoundref="cpu__features_8c" startline="372" endline="375">get_gemm_params</referencedby>
        <referencedby refid="cpu__features_8h_1a538a4414821926cda2c9e989764c00fd" compoundref="cpu__features_8c" startline="382" endline="402">print_cpu_info</referencedby>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="cpu__features_8h_1ab051fa0f4c2fc0723066eab07401fed6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void cpu_features_init</definition>
        <argsstring>(void)</argsstring>
        <name>cpu_features_init</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" line="47" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/cpu_features.c" bodystart="344" bodyend="370" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" declline="47" declcolumn="6"/>
        <references refid="cpu__features_8c_1a6465c90ac7e832c18d8e5a21df58653b" compoundref="cpu__features_8c" startline="268" endline="338">compute_gemm_params</references>
        <references refid="cpu__features_8c_1a8f4a571a19e02f7714b53aa1e5d50f91" compoundref="cpu__features_8c" startline="246" endline="262">detect_physical_cores</references>
        <references refid="cpu__features_8c_1a87e02c44ce8117ceb227f928980a175a" compoundref="cpu__features_8c" startline="28">g_cpu_info</references>
        <references refid="cpu__features_8c_1a9f67b8a4e1c74de8b6f0d8b535e44877" compoundref="cpu__features_8c" startline="30">g_cpu_initialized</references>
        <references refid="cpu__features_8c_1add9495a8b0827ace67807e0826a890d1" compoundref="cpu__features_8c" startline="29">g_gemm_params</references>
        <references refid="structCPUInfo_1a2e9b76fe6d69b6a1b6c194cd4ca35d86" compoundref="cpu__features_8h" startline="21">CPUInfo::l1d_size</references>
        <references refid="structCPUInfo_1aa4bcdef1bf48fa3860742a28a7d57d6d" compoundref="cpu__features_8h" startline="25">CPUInfo::num_cores</references>
        <referencedby refid="cpu__features_8h_1a3c6e32bab9ac6dbe68fb4f17d6378e7d" compoundref="cpu__features_8c" startline="377" endline="380">get_cpu_info</referencedby>
        <referencedby refid="cpu__features_8h_1ab1ad13308616a6d3d811b97eef9abfe6" compoundref="cpu__features_8c" startline="372" endline="375">get_gemm_params</referencedby>
        <referencedby refid="cpu__features_8h_1a538a4414821926cda2c9e989764c00fd" compoundref="cpu__features_8c" startline="382" endline="402">print_cpu_info</referencedby>
      </memberdef>
      <memberdef kind="function" id="cpu__features_8h_1a3c6e32bab9ac6dbe68fb4f17d6378e7d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>const <ref refid="structCPUInfo" kindref="compound">CPUInfo</ref> *</type>
        <definition>const CPUInfo* get_cpu_info</definition>
        <argsstring>(void)</argsstring>
        <name>get_cpu_info</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" line="53" column="15" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/cpu_features.c" bodystart="377" bodyend="380" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" declline="53" declcolumn="15"/>
        <references refid="cpu__features_8c_1ab051fa0f4c2fc0723066eab07401fed6" compoundref="cpu__features_8c" startline="344" endline="370">cpu_features_init</references>
        <references refid="cpu__features_8c_1a87e02c44ce8117ceb227f928980a175a" compoundref="cpu__features_8c" startline="28">g_cpu_info</references>
        <references refid="cpu__features_8c_1a9f67b8a4e1c74de8b6f0d8b535e44877" compoundref="cpu__features_8c" startline="30">g_cpu_initialized</references>
        <referencedby refid="gemm__microkernel_8c_1a2ecba71250e316cfb6a7415be7346f1c" compoundref="gemm__microkernel_8c" startline="905" endline="922">gemm_init_threads</referencedby>
      </memberdef>
      <memberdef kind="function" id="cpu__features_8h_1ab1ad13308616a6d3d811b97eef9abfe6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>const <ref refid="structGEMMParams" kindref="compound">GEMMParams</ref> *</type>
        <definition>const GEMMParams* get_gemm_params</definition>
        <argsstring>(void)</argsstring>
        <name>get_gemm_params</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" line="50" column="18" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/cpu_features.c" bodystart="372" bodyend="375" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" declline="50" declcolumn="18"/>
        <references refid="cpu__features_8c_1ab051fa0f4c2fc0723066eab07401fed6" compoundref="cpu__features_8c" startline="344" endline="370">cpu_features_init</references>
        <references refid="cpu__features_8c_1a9f67b8a4e1c74de8b6f0d8b535e44877" compoundref="cpu__features_8c" startline="30">g_cpu_initialized</references>
        <references refid="cpu__features_8c_1add9495a8b0827ace67807e0826a890d1" compoundref="cpu__features_8c" startline="29">g_gemm_params</references>
      </memberdef>
      <memberdef kind="function" id="cpu__features_8h_1a538a4414821926cda2c9e989764c00fd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void print_cpu_info</definition>
        <argsstring>(void)</argsstring>
        <name>print_cpu_info</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" line="56" column="6" bodyfile="/home/antshiv/Workspace/C-Kernel-Engine/src/cpu_features.c" bodystart="382" bodyend="402" declfile="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h" declline="56" declcolumn="6"/>
        <references refid="cpu__features_8c_1ab051fa0f4c2fc0723066eab07401fed6" compoundref="cpu__features_8c" startline="344" endline="370">cpu_features_init</references>
        <references refid="cpu__features_8c_1a87e02c44ce8117ceb227f928980a175a" compoundref="cpu__features_8c" startline="28">g_cpu_info</references>
        <references refid="cpu__features_8c_1a9f67b8a4e1c74de8b6f0d8b535e44877" compoundref="cpu__features_8c" startline="30">g_cpu_initialized</references>
        <references refid="cpu__features_8c_1add9495a8b0827ace67807e0826a890d1" compoundref="cpu__features_8c" startline="29">g_gemm_params</references>
        <references refid="structCPUInfo_1a6981442ec8c03e3486d68e5011cbe02c" compoundref="cpu__features_8h" startline="26">CPUInfo::has_avx</references>
        <references refid="structCPUInfo_1a5392c3ca44cc97b171ee980e48408e03" compoundref="cpu__features_8h" startline="27">CPUInfo::has_avx2</references>
        <references refid="structCPUInfo_1a72c59fe4c03be35b475dd733bd17860c" compoundref="cpu__features_8h" startline="28">CPUInfo::has_avx512f</references>
        <references refid="structCPUInfo_1a675b39fcccd4eac9995984acbe5d3d15" compoundref="cpu__features_8h" startline="29">CPUInfo::has_fma</references>
        <references refid="structGEMMParams_1aa84a148f54c8ec49fec73e7b2354761c" compoundref="cpu__features_8h" startline="38">GEMMParams::KC</references>
        <references refid="structCPUInfo_1aec1d73dace532ccaa255243ad9222d44" compoundref="cpu__features_8h" startline="24">CPUInfo::l1_line_size</references>
        <references refid="structCPUInfo_1a2e9b76fe6d69b6a1b6c194cd4ca35d86" compoundref="cpu__features_8h" startline="21">CPUInfo::l1d_size</references>
        <references refid="structCPUInfo_1accaf39347e29f639b10e0d99825a0ca5" compoundref="cpu__features_8h" startline="22">CPUInfo::l2_size</references>
        <references refid="structCPUInfo_1a50cf2d09ca804dfbdbbc1759cb71943c" compoundref="cpu__features_8h" startline="23">CPUInfo::l3_size</references>
        <references refid="structGEMMParams_1a2956e1497d1e97174d5d17e872707769" compoundref="cpu__features_8h" startline="36">GEMMParams::MC</references>
        <references refid="structGEMMParams_1a6b0b003d129e3c027928ac6ad089e110" compoundref="cpu__features_8h" startline="34">GEMMParams::MR</references>
        <references refid="structGEMMParams_1a450121a9c76be4c90fe5326b1808eb1a" compoundref="cpu__features_8h" startline="37">GEMMParams::NC</references>
        <references refid="structGEMMParams_1adc0714de30284b4b62ecfac446979251" compoundref="cpu__features_8h" startline="35">GEMMParams::NR</references>
        <references refid="structCPUInfo_1aa4bcdef1bf48fa3860742a28a7d57d6d" compoundref="cpu__features_8h" startline="25">CPUInfo::num_cores</references>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/**</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>CPU<sp/>Feature<sp/>Detection<sp/>and<sp/>Cache-Aware<sp/>Parameter<sp/>Tuning</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>This<sp/>module<sp/>detects<sp/>CPU<sp/>cache<sp/>sizes<sp/>at<sp/>runtime<sp/>and<sp/>computes<sp/>optimal</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>GEMM<sp/>blocking<sp/>parameters<sp/>based<sp/>on<sp/>the<sp/>BLIS/oneDNN<sp/>methodology.</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>Key<sp/>formulas:</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>-<sp/>KC:<sp/>MR<sp/>*<sp/>KC<sp/>*<sp/>sizeof(float)<sp/>fits<sp/>in<sp/>L1<sp/>(with<sp/>room<sp/>for<sp/>B<sp/>streaming)</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>-<sp/>MC:<sp/>MC<sp/>*<sp/>KC<sp/>*<sp/>sizeof(float)<sp/>fits<sp/>in<sp/>L2</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>-<sp/>NC:<sp/>KC<sp/>*<sp/>NR<sp/>fits<sp/>in<sp/>L1<sp/>for<sp/>B<sp/>panel,<sp/>NC<sp/>scales<sp/>with<sp/>L3</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>CPU_FEATURES_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CPU_FEATURES_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="comment">//<sp/>CPU<sp/>cache<sp/>information</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20" refid="structCPUInfo" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="21" refid="structCPUInfo_1a2e9b76fe6d69b6a1b6c194cd4ca35d86" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo_1a2e9b76fe6d69b6a1b6c194cd4ca35d86" kindref="member">l1d_size</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>L1<sp/>data<sp/>cache<sp/>size<sp/>in<sp/>bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22" refid="structCPUInfo_1accaf39347e29f639b10e0d99825a0ca5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo_1accaf39347e29f639b10e0d99825a0ca5" kindref="member">l2_size</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>L2<sp/>cache<sp/>size<sp/>in<sp/>bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23" refid="structCPUInfo_1a50cf2d09ca804dfbdbbc1759cb71943c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo_1a50cf2d09ca804dfbdbbc1759cb71943c" kindref="member">l3_size</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>L3<sp/>cache<sp/>size<sp/>in<sp/>bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24" refid="structCPUInfo_1aec1d73dace532ccaa255243ad9222d44" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo_1aec1d73dace532ccaa255243ad9222d44" kindref="member">l1_line_size</ref>;<sp/><sp/></highlight><highlight class="comment">//<sp/>Cache<sp/>line<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25" refid="structCPUInfo_1aa4bcdef1bf48fa3860742a28a7d57d6d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo_1aa4bcdef1bf48fa3860742a28a7d57d6d" kindref="member">num_cores</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Number<sp/>of<sp/>physical<sp/>cores</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26" refid="structCPUInfo_1a6981442ec8c03e3486d68e5011cbe02c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo_1a6981442ec8c03e3486d68e5011cbe02c" kindref="member">has_avx</ref>;</highlight></codeline>
<codeline lineno="27" refid="structCPUInfo_1a5392c3ca44cc97b171ee980e48408e03" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo_1a5392c3ca44cc97b171ee980e48408e03" kindref="member">has_avx2</ref>;</highlight></codeline>
<codeline lineno="28" refid="structCPUInfo_1a72c59fe4c03be35b475dd733bd17860c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo_1a72c59fe4c03be35b475dd733bd17860c" kindref="member">has_avx512f</ref>;</highlight></codeline>
<codeline lineno="29" refid="structCPUInfo_1a675b39fcccd4eac9995984acbe5d3d15" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo_1a675b39fcccd4eac9995984acbe5d3d15" kindref="member">has_fma</ref>;</highlight></codeline>
<codeline lineno="30"><highlight class="normal">}<sp/><ref refid="structCPUInfo" kindref="compound">CPUInfo</ref>;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="comment">//<sp/>GEMM<sp/>blocking<sp/>parameters<sp/>(computed<sp/>based<sp/>on<sp/>cache<sp/>sizes)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33" refid="structGEMMParams" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="34" refid="structGEMMParams_1a6b0b003d129e3c027928ac6ad089e110" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structGEMMParams_1a6b0b003d129e3c027928ac6ad089e110" kindref="member">MR</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Microkernel<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="structGEMMParams_1adc0714de30284b4b62ecfac446979251" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structGEMMParams_1adc0714de30284b4b62ecfac446979251" kindref="member">NR</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Microkernel<sp/>cols</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36" refid="structGEMMParams_1a2956e1497d1e97174d5d17e872707769" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structGEMMParams_1a2956e1497d1e97174d5d17e872707769" kindref="member">MC</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>M<sp/>block<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37" refid="structGEMMParams_1a450121a9c76be4c90fe5326b1808eb1a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structGEMMParams_1a450121a9c76be4c90fe5326b1808eb1a" kindref="member">NC</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>N<sp/>block<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38" refid="structGEMMParams_1aa84a148f54c8ec49fec73e7b2354761c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structGEMMParams_1aa84a148f54c8ec49fec73e7b2354761c" kindref="member">KC</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>K<sp/>block<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal">}<sp/><ref refid="structGEMMParams" kindref="compound">GEMMParams</ref>;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Global<sp/>CPU<sp/>info<sp/>and<sp/>GEMM<sp/>params<sp/>(initialized<sp/>once<sp/>at<sp/>startup)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo" kindref="compound">CPUInfo</ref><sp/><ref refid="cpu__features_8h_1a87e02c44ce8117ceb227f928980a175a" kindref="member">g_cpu_info</ref>;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/><ref refid="structGEMMParams" kindref="compound">GEMMParams</ref><sp/><ref refid="cpu__features_8h_1add9495a8b0827ace67807e0826a890d1" kindref="member">g_gemm_params</ref>;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="cpu__features_8h_1a9f67b8a4e1c74de8b6f0d8b535e44877" kindref="member">g_cpu_initialized</ref>;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Initialize<sp/>CPU<sp/>detection<sp/>(call<sp/>once<sp/>at<sp/>startup)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cpu__features_8h_1ab051fa0f4c2fc0723066eab07401fed6" kindref="member">cpu_features_init</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Get<sp/>current<sp/>GEMM<sp/>parameters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structGEMMParams" kindref="compound">GEMMParams</ref>*<sp/><ref refid="cpu__features_8h_1ab1ad13308616a6d3d811b97eef9abfe6" kindref="member">get_gemm_params</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Get<sp/>CPU<sp/>info</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCPUInfo" kindref="compound">CPUInfo</ref>*<sp/><ref refid="cpu__features_8h_1a3c6e32bab9ac6dbe68fb4f17d6378e7d" kindref="member">get_cpu_info</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Debug:<sp/>print<sp/>CPU<sp/>info</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cpu__features_8h_1a538a4414821926cda2c9e989764c00fd" kindref="member">print_cpu_info</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">//<sp/>CPU_FEATURES_H</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/home/antshiv/Workspace/C-Kernel-Engine/include/cpu_features.h"/>
  </compounddef>
</doxygen>
