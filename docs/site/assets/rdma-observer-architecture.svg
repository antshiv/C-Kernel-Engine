<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 550">
  <defs>
    <linearGradient id="nodeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2a2a2a"/>
      <stop offset="100%" style="stop-color:#1a1a1a"/>
    </linearGradient>
    <linearGradient id="observerGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4f46e5"/>
      <stop offset="100%" style="stop-color:#3730a3"/>
    </linearGradient>
    <linearGradient id="rdmaGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#ffb400"/>
      <stop offset="50%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#ffb400"/>
    </linearGradient>
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="4" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ffb400"/>
    </marker>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4299e1"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="900" height="550" fill="#0f0f0f"/>

  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="22" font-weight="700">Zero-Overhead RDMA Monitoring</text>
  <text x="450" y="55" text-anchor="middle" fill="#808080" font-family="Inter, sans-serif" font-size="13">Observer reads memory without disturbing compute nodes</text>

  <!-- RDMA Fabric -->
  <rect x="50" y="250" width="800" height="50" rx="25" fill="url(#rdmaGrad)" opacity="0.15"/>
  <rect x="50" y="250" width="800" height="50" rx="25" fill="none" stroke="url(#rdmaGrad)" stroke-width="2" filter="url(#glow)"/>
  <text x="450" y="280" text-anchor="middle" fill="#ffb400" font-family="Inter, sans-serif" font-size="14" font-weight="600">RDMA Fabric (100-400 Gbps)</text>

  <!-- Compute Node 0 -->
  <g transform="translate(80, 85)">
    <rect width="200" height="150" rx="10" fill="url(#nodeGrad)" stroke="#454545" stroke-width="2" filter="url(#shadow)"/>
    <rect x="10" y="10" width="180" height="30" rx="5" fill="#48bb78" opacity="0.2"/>
    <text x="100" y="30" text-anchor="middle" fill="#48bb78" font-family="Inter, sans-serif" font-size="13" font-weight="600">Node 0 - Training</text>

    <!-- Memory blocks -->
    <rect x="15" y="50" width="75" height="35" rx="4" fill="#2d3748"/>
    <text x="52" y="72" text-anchor="middle" fill="#a0aec0" font-family="JetBrains Mono, monospace" font-size="9">Layers 0-11</text>

    <rect x="95" y="50" width="90" height="35" rx="4" fill="#2d3748"/>
    <text x="140" y="72" text-anchor="middle" fill="#a0aec0" font-family="JetBrains Mono, monospace" font-size="9">Weights</text>

    <rect x="15" y="90" width="75" height="35" rx="4" fill="#2d3748"/>
    <text x="52" y="112" text-anchor="middle" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="9">Activations</text>

    <rect x="95" y="90" width="90" height="35" rx="4" fill="#2d3748"/>
    <text x="140" y="112" text-anchor="middle" fill="#f87171" font-family="JetBrains Mono, monospace" font-size="9">Gradients</text>

    <text x="100" y="143" text-anchor="middle" fill="#606060" font-family="Inter, sans-serif" font-size="10">No logging overhead</text>
  </g>

  <!-- Compute Node 1 -->
  <g transform="translate(350, 85)">
    <rect width="200" height="150" rx="10" fill="url(#nodeGrad)" stroke="#454545" stroke-width="2" filter="url(#shadow)"/>
    <rect x="10" y="10" width="180" height="30" rx="5" fill="#48bb78" opacity="0.2"/>
    <text x="100" y="30" text-anchor="middle" fill="#48bb78" font-family="Inter, sans-serif" font-size="13" font-weight="600">Node 1 - Training</text>

    <!-- Memory blocks -->
    <rect x="15" y="50" width="75" height="35" rx="4" fill="#2d3748"/>
    <text x="52" y="72" text-anchor="middle" fill="#a0aec0" font-family="JetBrains Mono, monospace" font-size="9">Layers 12-23</text>

    <rect x="95" y="50" width="90" height="35" rx="4" fill="#2d3748"/>
    <text x="140" y="72" text-anchor="middle" fill="#a0aec0" font-family="JetBrains Mono, monospace" font-size="9">Weights</text>

    <rect x="15" y="90" width="75" height="35" rx="4" fill="#2d3748"/>
    <text x="52" y="112" text-anchor="middle" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="9">Activations</text>

    <rect x="95" y="90" width="90" height="35" rx="4" fill="#2d3748"/>
    <text x="140" y="112" text-anchor="middle" fill="#f87171" font-family="JetBrains Mono, monospace" font-size="9">Gradients</text>

    <text x="100" y="143" text-anchor="middle" fill="#606060" font-family="Inter, sans-serif" font-size="10">No logging overhead</text>
  </g>

  <!-- Observer Node -->
  <g transform="translate(620, 85)">
    <rect width="200" height="150" rx="10" fill="url(#observerGrad)" stroke="#7c3aed" stroke-width="2" filter="url(#shadow)"/>
    <rect x="10" y="10" width="180" height="30" rx="5" fill="#ffffff" opacity="0.15"/>
    <text x="100" y="30" text-anchor="middle" fill="#ffffff" font-family="Inter, sans-serif" font-size="13" font-weight="600">Observer Laptop</text>

    <!-- Dashboard mockup -->
    <rect x="15" y="50" width="170" height="75" rx="4" fill="#1e1b4b"/>
    <text x="25" y="68" fill="#a5b4fc" font-family="Inter, sans-serif" font-size="9">Live Dashboard</text>

    <!-- Mini charts -->
    <polyline points="25,100 45,90 65,95 85,80 105,85 125,75 145,78 165,72" fill="none" stroke="#4ade80" stroke-width="1.5"/>
    <text x="25" y="115" fill="#808080" font-family="JetBrains Mono, monospace" font-size="8">Loss: 2.341</text>
    <text x="100" y="115" fill="#808080" font-family="JetBrains Mono, monospace" font-size="8">Step: 12.8k</text>

    <text x="100" y="143" text-anchor="middle" fill="#c7d2fe" font-family="Inter, sans-serif" font-size="10">RDMA READ only</text>
  </g>

  <!-- Connection lines to RDMA fabric -->
  <line x1="180" y1="235" x2="180" y2="250" stroke="#454545" stroke-width="2"/>
  <line x1="450" y1="235" x2="450" y2="250" stroke="#454545" stroke-width="2"/>
  <line x1="720" y1="235" x2="720" y2="250" stroke="#7c3aed" stroke-width="2"/>

  <!-- RDMA Read arrows (from observer to nodes) -->
  <path d="M 700 250 Q 600 220 280 250" fill="none" stroke="#4299e1" stroke-width="2" stroke-dasharray="8,4" marker-end="url(#arrowhead-blue)"/>
  <path d="M 700 250 Q 620 220 550 250" fill="none" stroke="#4299e1" stroke-width="2" stroke-dasharray="8,4" marker-end="url(#arrowhead-blue)"/>

  <!-- Bottom section: How it works -->
  <g transform="translate(50, 320)">
    <rect width="800" height="200" rx="10" fill="#1a1a1a" stroke="#333" stroke-width="1"/>

    <!-- How it works title -->
    <text x="400" y="30" text-anchor="middle" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="16" font-weight="600">How RDMA One-Sided Read Works</text>

    <!-- Step 1 -->
    <g transform="translate(30, 50)">
      <circle cx="20" cy="20" r="20" fill="#ffb400"/>
      <text x="20" y="26" text-anchor="middle" fill="#1a1a1a" font-family="Inter, sans-serif" font-size="14" font-weight="700">1</text>
      <text x="55" y="18" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="13" font-weight="500">Observer knows offsets</text>
      <text x="55" y="35" fill="#808080" font-family="Inter, sans-serif" font-size="11">layout.json has all addresses</text>
    </g>

    <!-- Step 2 -->
    <g transform="translate(280, 50)">
      <circle cx="20" cy="20" r="20" fill="#ffb400"/>
      <text x="20" y="26" text-anchor="middle" fill="#1a1a1a" font-family="Inter, sans-serif" font-size="14" font-weight="700">2</text>
      <text x="55" y="18" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="13" font-weight="500">RDMA READ issued</text>
      <text x="55" y="35" fill="#808080" font-family="Inter, sans-serif" font-size="11">Direct memory access via NIC</text>
    </g>

    <!-- Step 3 -->
    <g transform="translate(530, 50)">
      <circle cx="20" cy="20" r="20" fill="#ffb400"/>
      <text x="20" y="26" text-anchor="middle" fill="#1a1a1a" font-family="Inter, sans-serif" font-size="14" font-weight="700">3</text>
      <text x="55" y="18" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="13" font-weight="500">Zero CPU involvement</text>
      <text x="55" y="35" fill="#808080" font-family="Inter, sans-serif" font-size="11">Target node doesn't even notice</text>
    </g>

    <!-- Key insight box -->
    <rect x="30" y="100" width="740" height="70" rx="8" fill="#2d3748" stroke="#4299e1" stroke-width="1"/>
    <text x="50" y="125" fill="#4299e1" font-family="Inter, sans-serif" font-size="12" font-weight="600">KEY INSIGHT</text>
    <text x="50" y="148" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="12">Traditional logging: Compute node must stop → serialize → send → resume (adds latency)</text>
    <text x="50" y="165" fill="#48bb78" font-family="Inter, sans-serif" font-size="12">RDMA observation: Observer pulls data independently → compute continues uninterrupted</text>
  </g>
</svg>
