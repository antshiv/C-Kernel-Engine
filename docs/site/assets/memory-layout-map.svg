<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#4f46e5"/>
      <stop offset="100%" style="stop-color:#7c3aed"/>
    </linearGradient>
    <linearGradient id="layerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#2a2a2a"/>
      <stop offset="100%" style="stop-color:#363636"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="800" height="600" fill="#1a1a1a"/>

  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="20" font-weight="700">Model Memory Layout</text>
  <text x="400" y="55" text-anchor="middle" fill="#808080" font-family="Inter, sans-serif" font-size="12">Every tensor has a fixed, known offset</text>

  <!-- Memory container -->
  <rect x="50" y="75" width="450" height="500" rx="8" fill="#232323" stroke="#454545" stroke-width="1" filter="url(#shadow)"/>

  <!-- Offset labels (left side) -->
  <text x="40" y="100" text-anchor="end" fill="#808080" font-family="JetBrains Mono, monospace" font-size="10">0x000000</text>
  <text x="40" y="160" text-anchor="end" fill="#808080" font-family="JetBrains Mono, monospace" font-size="10">0x200000</text>
  <text x="40" y="220" text-anchor="end" fill="#808080" font-family="JetBrains Mono, monospace" font-size="10">0x2C0000</text>
  <text x="40" y="280" text-anchor="end" fill="#808080" font-family="JetBrains Mono, monospace" font-size="10">0x380000</text>
  <text x="40" y="400" text-anchor="end" fill="#808080" font-family="JetBrains Mono, monospace" font-size="10">0x1A00000</text>
  <text x="40" y="460" text-anchor="end" fill="#808080" font-family="JetBrains Mono, monospace" font-size="10">0x1CC0000</text>
  <text x="40" y="560" text-anchor="end" fill="#808080" font-family="JetBrains Mono, monospace" font-size="10">0x5CC0000</text>

  <!-- Embeddings section -->
  <rect x="60" y="85" width="430" height="60" rx="4" fill="url(#headerGrad)"/>
  <text x="275" y="115" text-anchor="middle" fill="#ffffff" font-family="Inter, sans-serif" font-size="14" font-weight="600">Embeddings</text>
  <text x="275" y="132" text-anchor="middle" fill="#e0e7ff" font-family="Inter, sans-serif" font-size="11">32 MB | vocab_size × hidden_dim</text>

  <!-- Layer 0 -->
  <rect x="60" y="150" width="430" height="55" rx="4" fill="url(#layerGrad)" stroke="#ffb400" stroke-width="2"/>
  <text x="75" y="175" fill="#ffb400" font-family="Inter, sans-serif" font-size="12" font-weight="600">Layer 0</text>
  <g transform="translate(140, 160)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">Q</text>
  </g>
  <g transform="translate(200, 160)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">K</text>
  </g>
  <g transform="translate(260, 160)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">V</text>
  </g>
  <g transform="translate(320, 160)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">O</text>
  </g>
  <g transform="translate(380, 160)">
    <rect x="0" y="0" width="100" height="28" rx="3" fill="#3b3b3b"/>
    <text x="50" y="18" text-anchor="middle" fill="#f59e0b" font-family="JetBrains Mono, monospace" font-size="10">MLP</text>
  </g>

  <!-- Layer 1 -->
  <rect x="60" y="210" width="430" height="55" rx="4" fill="url(#layerGrad)" stroke="#454545" stroke-width="1"/>
  <text x="75" y="235" fill="#b0b0b0" font-family="Inter, sans-serif" font-size="12" font-weight="600">Layer 1</text>
  <g transform="translate(140, 220)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">Q</text>
  </g>
  <g transform="translate(200, 220)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">K</text>
  </g>
  <g transform="translate(260, 220)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">V</text>
  </g>
  <g transform="translate(320, 220)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">O</text>
  </g>
  <g transform="translate(380, 220)">
    <rect x="0" y="0" width="100" height="28" rx="3" fill="#3b3b3b"/>
    <text x="50" y="18" text-anchor="middle" fill="#f59e0b" font-family="JetBrains Mono, monospace" font-size="10">MLP</text>
  </g>

  <!-- Dots for more layers -->
  <text x="275" y="295" text-anchor="middle" fill="#808080" font-family="Inter, sans-serif" font-size="24">...</text>
  <text x="275" y="320" text-anchor="middle" fill="#808080" font-family="Inter, sans-serif" font-size="11">Layers 2-22</text>
  <text x="275" y="335" text-anchor="middle" fill="#606060" font-family="Inter, sans-serif" font-size="10">Same structure, sequential offsets</text>

  <!-- Layer 23 -->
  <rect x="60" y="355" width="430" height="55" rx="4" fill="url(#layerGrad)" stroke="#454545" stroke-width="1"/>
  <text x="75" y="380" fill="#b0b0b0" font-family="Inter, sans-serif" font-size="12" font-weight="600">Layer 23</text>
  <g transform="translate(140, 365)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">Q</text>
  </g>
  <g transform="translate(200, 365)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">K</text>
  </g>
  <g transform="translate(260, 365)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">V</text>
  </g>
  <g transform="translate(320, 365)">
    <rect x="0" y="0" width="55" height="28" rx="3" fill="#3b3b3b"/>
    <text x="27" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">O</text>
  </g>
  <g transform="translate(380, 365)">
    <rect x="0" y="0" width="100" height="28" rx="3" fill="#3b3b3b"/>
    <text x="50" y="18" text-anchor="middle" fill="#f59e0b" font-family="JetBrains Mono, monospace" font-size="10">MLP</text>
  </g>

  <!-- LM Head -->
  <rect x="60" y="415" width="430" height="50" rx="4" fill="url(#headerGrad)"/>
  <text x="275" y="440" text-anchor="middle" fill="#ffffff" font-family="Inter, sans-serif" font-size="14" font-weight="600">LM Head</text>
  <text x="275" y="455" text-anchor="middle" fill="#e0e7ff" font-family="Inter, sans-serif" font-size="11">64 MB | hidden_dim × vocab_size</text>

  <!-- Activations / KV Cache -->
  <rect x="60" y="470" width="430" height="95" rx="4" fill="#2d3748" stroke="#4299e1" stroke-width="1"/>
  <text x="275" y="495" text-anchor="middle" fill="#4299e1" font-family="Inter, sans-serif" font-size="14" font-weight="600">Activations &amp; KV Cache</text>
  <text x="275" y="515" text-anchor="middle" fill="#a0aec0" font-family="Inter, sans-serif" font-size="11">Runtime buffers at known offsets</text>
  <g transform="translate(80, 525)">
    <rect x="0" y="0" width="120" height="28" rx="3" fill="#3b3b3b"/>
    <text x="60" y="18" text-anchor="middle" fill="#4299e1" font-family="JetBrains Mono, monospace" font-size="10">KV Cache</text>
  </g>
  <g transform="translate(210, 525)">
    <rect x="0" y="0" width="120" height="28" rx="3" fill="#3b3b3b"/>
    <text x="60" y="18" text-anchor="middle" fill="#48bb78" font-family="JetBrains Mono, monospace" font-size="10">Activations</text>
  </g>
  <g transform="translate(340, 525)">
    <rect x="0" y="0" width="120" height="28" rx="3" fill="#3b3b3b"/>
    <text x="60" y="18" text-anchor="middle" fill="#f56565" font-family="JetBrains Mono, monospace" font-size="10">Gradients</text>
  </g>

  <!-- Right side: Key features -->
  <rect x="520" y="75" width="260" height="180" rx="8" fill="#232323" stroke="#ffb400" stroke-width="2" filter="url(#shadow)"/>
  <text x="650" y="100" text-anchor="middle" fill="#ffb400" font-family="Inter, sans-serif" font-size="14" font-weight="700">Key Benefits</text>

  <circle cx="540" cy="130" r="6" fill="#48bb78"/>
  <text x="555" y="135" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="12">Same offsets every run</text>

  <circle cx="540" cy="160" r="6" fill="#48bb78"/>
  <text x="555" y="165" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="12">Compile-time known</text>

  <circle cx="540" cy="190" r="6" fill="#48bb78"/>
  <text x="555" y="195" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="12">Direct RDMA access</text>

  <circle cx="540" cy="220" r="6" fill="#48bb78"/>
  <text x="555" y="225" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="12">Zero-copy observation</text>

  <!-- Right side: Layout JSON preview -->
  <rect x="520" y="270" width="260" height="200" rx="8" fill="#1a1a1a" stroke="#454545" stroke-width="1" filter="url(#shadow)"/>
  <text x="535" y="295" fill="#808080" font-family="JetBrains Mono, monospace" font-size="11">layout.json</text>
  <text x="535" y="320" fill="#f59e0b" font-family="JetBrains Mono, monospace" font-size="10">{</text>
  <text x="545" y="338" fill="#a78bfa" font-family="JetBrains Mono, monospace" font-size="10">"layer_0"</text><text x="620" y="338" fill="#f5f5f5" font-family="JetBrains Mono, monospace" font-size="10">: {</text>
  <text x="555" y="356" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="10">"attn_q"</text><text x="620" y="356" fill="#f5f5f5" font-family="JetBrains Mono, monospace" font-size="10">: 0x2C0000,</text>
  <text x="555" y="374" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="10">"attn_k"</text><text x="620" y="374" fill="#f5f5f5" font-family="JetBrains Mono, monospace" font-size="10">: 0x2E0000,</text>
  <text x="555" y="392" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="10">"attn_v"</text><text x="620" y="392" fill="#f5f5f5" font-family="JetBrains Mono, monospace" font-size="10">: 0x300000,</text>
  <text x="555" y="410" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="10">"mlp"</text><text x="600" y="410" fill="#f5f5f5" font-family="JetBrains Mono, monospace" font-size="10">: 0x320000</text>
  <text x="545" y="428" fill="#f5f5f5" font-family="JetBrains Mono, monospace" font-size="10">}</text>
  <text x="535" y="446" fill="#f59e0b" font-family="JetBrains Mono, monospace" font-size="10">}</text>

  <!-- Right side: Pointer example -->
  <rect x="520" y="485" width="260" height="85" rx="8" fill="#232323" stroke="#4299e1" stroke-width="1" filter="url(#shadow)"/>
  <text x="650" y="510" text-anchor="middle" fill="#4299e1" font-family="Inter, sans-serif" font-size="12" font-weight="600">Direct Access</text>
  <text x="535" y="535" fill="#808080" font-family="JetBrains Mono, monospace" font-size="10">// Read layer 0 Q weights</text>
  <text x="535" y="555" fill="#f5f5f5" font-family="JetBrains Mono, monospace" font-size="10">rdma_read(</text><text x="620" y="555" fill="#f59e0b" font-family="JetBrains Mono, monospace" font-size="10">0x2C0000</text><text x="700" y="555" fill="#f5f5f5" font-family="JetBrains Mono, monospace" font-size="10">)</text>
</svg>
