<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 480">
  <defs>
    <linearGradient id="pytorchGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ee4c2c"/>
      <stop offset="100%" style="stop-color:#c93a1e"/>
    </linearGradient>
    <linearGradient id="ckeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4f46e5"/>
      <stop offset="100%" style="stop-color:#3730a3"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="4" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="480" fill="#0f0f0f"/>

  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" fill="#f5f5f5" font-family="Inter, sans-serif" font-size="22" font-weight="700">Dynamic vs Deterministic Memory</text>
  <text x="450" y="55" text-anchor="middle" fill="#808080" font-family="Inter, sans-serif" font-size="13">Why compile-time known offsets matter</text>

  <!-- Left: PyTorch -->
  <g transform="translate(30, 80)">
    <rect width="400" height="370" rx="12" fill="#1a1a1a" stroke="#ee4c2c" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="400" height="50" rx="12" fill="url(#pytorchGrad)"/>
    <rect x="0" y="25" width="400" height="25" fill="url(#pytorchGrad)"/>
    <text x="200" y="32" text-anchor="middle" fill="#ffffff" font-family="Inter, sans-serif" font-size="16" font-weight="700">PyTorch / JAX</text>

    <!-- Run 1 -->
    <text x="20" y="80" fill="#a0aec0" font-family="Inter, sans-serif" font-size="12" font-weight="600">Run 1 - Memory Addresses</text>
    <g transform="translate(20, 90)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#f87171" font-family="JetBrains Mono, monospace" font-size="9">0x7f3a...</text>
    </g>
    <g transform="translate(110, 90)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#f87171" font-family="JetBrains Mono, monospace" font-size="9">0x7f4b...</text>
    </g>
    <g transform="translate(200, 90)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#f87171" font-family="JetBrains Mono, monospace" font-size="9">0x7f5c...</text>
    </g>
    <g transform="translate(290, 90)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#f87171" font-family="JetBrains Mono, monospace" font-size="9">0x7f6d...</text>
    </g>

    <!-- Run 2 (different addresses) -->
    <text x="20" y="155" fill="#a0aec0" font-family="Inter, sans-serif" font-size="12" font-weight="600">Run 2 - Memory Addresses (Different!)</text>
    <g transform="translate(20, 165)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#fbbf24" font-family="JetBrains Mono, monospace" font-size="9">0x7f2e...</text>
    </g>
    <g transform="translate(110, 165)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#fbbf24" font-family="JetBrains Mono, monospace" font-size="9">0x7f8a...</text>
    </g>
    <g transform="translate(200, 165)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#fbbf24" font-family="JetBrains Mono, monospace" font-size="9">0x7f1c...</text>
    </g>
    <g transform="translate(290, 165)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#fbbf24" font-family="JetBrains Mono, monospace" font-size="9">0x7f9f...</text>
    </g>

    <!-- Problems list -->
    <text x="20" y="235" fill="#f87171" font-family="Inter, sans-serif" font-size="13" font-weight="600">Problems:</text>

    <circle cx="30" cy="260" r="4" fill="#f87171"/>
    <text x="45" y="265" fill="#e2e8f0" font-family="Inter, sans-serif" font-size="11">Addresses change every run</text>

    <circle cx="30" cy="285" r="4" fill="#f87171"/>
    <text x="45" y="290" fill="#e2e8f0" font-family="Inter, sans-serif" font-size="11">Need hooks to observe (adds overhead)</text>

    <circle cx="30" cy="310" r="4" fill="#f87171"/>
    <text x="45" y="315" fill="#e2e8f0" font-family="Inter, sans-serif" font-size="11">Can't compare across runs</text>

    <circle cx="30" cy="335" r="4" fill="#f87171"/>
    <text x="45" y="340" fill="#e2e8f0" font-family="Inter, sans-serif" font-size="11">RDMA not possible (unknown offsets)</text>
  </g>

  <!-- Right: C-Kernel-Engine -->
  <g transform="translate(470, 80)">
    <rect width="400" height="370" rx="12" fill="#1a1a1a" stroke="#4f46e5" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="400" height="50" rx="12" fill="url(#ckeGrad)"/>
    <rect x="0" y="25" width="400" height="25" fill="url(#ckeGrad)"/>
    <text x="200" y="32" text-anchor="middle" fill="#ffffff" font-family="Inter, sans-serif" font-size="16" font-weight="700">C-Kernel-Engine</text>

    <!-- Run 1 -->
    <text x="20" y="80" fill="#a0aec0" font-family="Inter, sans-serif" font-size="12" font-weight="600">Run 1 - Memory Addresses</text>
    <g transform="translate(20, 90)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="9">0x200000</text>
    </g>
    <g transform="translate(110, 90)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="9">0x2C0000</text>
    </g>
    <g transform="translate(200, 90)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="9">0x380000</text>
    </g>
    <g transform="translate(290, 90)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="9">0x440000</text>
    </g>

    <!-- Run 2 (SAME addresses) -->
    <text x="20" y="155" fill="#a0aec0" font-family="Inter, sans-serif" font-size="12" font-weight="600">Run 2 - Memory Addresses (Same!)</text>
    <g transform="translate(20, 165)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="9">0x200000</text>
    </g>
    <g transform="translate(110, 165)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="9">0x2C0000</text>
    </g>
    <g transform="translate(200, 165)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="9">0x380000</text>
    </g>
    <g transform="translate(290, 165)">
      <rect width="80" height="35" rx="4" fill="#2d3748"/>
      <text x="40" y="22" text-anchor="middle" fill="#4ade80" font-family="JetBrains Mono, monospace" font-size="9">0x440000</text>
    </g>

    <!-- Benefits list -->
    <text x="20" y="235" fill="#4ade80" font-family="Inter, sans-serif" font-size="13" font-weight="600">Benefits:</text>

    <circle cx="30" cy="260" r="4" fill="#4ade80"/>
    <text x="45" y="265" fill="#e2e8f0" font-family="Inter, sans-serif" font-size="11">Compile-time known offsets</text>

    <circle cx="30" cy="285" r="4" fill="#4ade80"/>
    <text x="45" y="290" fill="#e2e8f0" font-family="Inter, sans-serif" font-size="11">Direct RDMA observation (zero overhead)</text>

    <circle cx="30" cy="310" r="4" fill="#4ade80"/>
    <text x="45" y="315" fill="#e2e8f0" font-family="Inter, sans-serif" font-size="11">Compare checkpoints byte-by-byte</text>

    <circle cx="30" cy="335" r="4" fill="#4ade80"/>
    <text x="45" y="340" fill="#e2e8f0" font-family="Inter, sans-serif" font-size="11">Reproducible debugging &amp; interpretability</text>
  </g>

  <!-- Arrow/VS indicator -->
  <circle cx="450" cy="265" r="25" fill="#232323" stroke="#454545" stroke-width="2"/>
  <text x="450" y="271" text-anchor="middle" fill="#808080" font-family="Inter, sans-serif" font-size="12" font-weight="700">VS</text>
</svg>
